(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PCrypto=(()=>{var af=Object.create;var $r=Object.defineProperty;var sf=Object.getOwnPropertyDescriptor;var ff=Object.getOwnPropertyNames;var cf=Object.getPrototypeOf,uf=Object.prototype.hasOwnProperty;var ft=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),gt=(t,e)=>{for(var r in e)$r(t,r,{get:e[r],enumerable:!0})},qo=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ff(e))!uf.call(t,i)&&i!==r&&$r(t,i,{get:()=>e[i],enumerable:!(n=sf(e,i))||n.enumerable});return t};var Nt=(t,e,r)=>(r=t!=null?af(cf(t)):{},qo(e||!t||!t.__esModule?$r(r,"default",{value:t,enumerable:!0}):r,t)),hf=t=>qo($r({},"__esModule",{value:!0}),t);var it=ft((Od,Wo)=>{Wo.exports={options:{usePureJavaScript:!1}}});var $o=ft((Md,Zo)=>{var Gn={};Zo.exports=Gn;var Yo={};Gn.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=lf(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<a.length;++f)c+=a[f]<<8,a[f]=c%o,c=c/o|0;for(;c>0;)a.push(c%o),c=c/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Gn.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Yo[e];if(!r){r=Yo[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var f=0,c=a;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===o&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function lf(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=o.length-1;r>=0;--r)f+=e[o[r]];return f}});var bt=ft((Vd,jo)=>{var Qo=it(),Xo=$o(),g=jo.exports=Qo.util=Qo.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(a){return setImmediate(a)};return}if(g.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=a,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var o=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),o(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Sr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=Wn;function Wn(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Wn||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=Wn;var pf=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>pf&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){Sr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){Sr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function df(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),n=g.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=df;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){Sr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return Sr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){Sr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Te=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Jo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=Ie.charAt(i>>2),r+=Ie.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Ie.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Ie.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=Te[t.charCodeAt(s++)-43],n=Te[t.charCodeAt(s++)-43],i=Te[t.charCodeAt(s++)-43],o=Te[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Xo.encode,decode:Xo.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};g.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=Ie.charAt(i>>2),r+=Ie.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Ie.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Ie.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,f=0,c=r;f<t.length;)i=Te[t.charCodeAt(f++)-43],o=Te[t.charCodeAt(f++)-43],s=Te[t.charCodeAt(f++)-43],a=Te[t.charCodeAt(f++)-43],n[c++]=i<<2|o>>4,s!==64&&(n[c++]=(o&15)<<4|s>>2,a!==64&&(n[c++]=(s&3)<<6|a));return e?c-r:n.subarray(0,c)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,Jo,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,Jo,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};g.inflate=function(t,e,r){var n=t.inflate(g.encode64(e)).rval;return n===null?null:g.decode64(n)};var Yn=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Zn=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},yf=function(t,e,r,n){var i=Zn(t,e);i===null&&(i={}),i[r]=n,Yn(t,e,i)},xf=function(t,e,r){var n=Zn(t,e);return n!==null&&(n=r in n?n[r]:null),n},gf=function(t,e,r){var n=Zn(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),Yn(t,e,n)}},mf=function(t,e){Yn(t,e,null)},Qr=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(f){s=f}if(o)break}if(!o)throw s;return n};g.setItem=function(t,e,r,n,i){Qr(yf,arguments,i)};g.getItem=function(t,e,r,n){return Qr(xf,arguments,n)};g.removeItem=function(t,e,r,n){Qr(gf,arguments,n)};g.clearItems=function(t,e,r){Qr(mf,arguments,r)};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};g.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+a:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-c).toFixed(o).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=g.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=g.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=g.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker>"u")return g.cores=1,e(null,g.cores);if(typeof Blob>"u")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,f){if(a===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,g.cores)}i(f,function(u,h){s.push(o(f,h)),n(s,a-1,f)})}function i(s,a){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(p){if(c.push(p.data),c.length===s){for(var x=0;x<s;++x)f[x].terminate();a(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function o(s,a){for(var f=[],c=0;c<s;++c)for(var u=a[c],h=f[c]=[],p=0;p<s;++p)if(c!==p){var x=a[p];(u.st>x.st&&u.st<x.et||x.st>u.st&&x.st<u.et)&&h.push(p)}return f.reduce(function(l,d){return Math.max(l,d.length)},0)}}});var Qn=ft((qd,ta)=>{var Ct=it();bt();ta.exports=Ct.cipher=Ct.cipher||{};Ct.cipher.algorithms=Ct.cipher.algorithms||{};Ct.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ct.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ct.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ct.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ct.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ct.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ct.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ct.cipher.algorithms[t]=e};Ct.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ct.cipher.algorithms?Ct.cipher.algorithms[t]:null};var $n=Ct.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};$n.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ct.util.createBuffer(),this.output=t.output||Ct.util.createBuffer(),this.mode.start(e)};$n.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};$n.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Jn=ft((Fd,ea)=>{var It=it();bt();It.cipher=It.cipher||{};var $=ea.exports=It.cipher.modes=It.cipher.modes||{};$.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.ecb.prototype.start=function(t){};$.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};$.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};$.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};$.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};$.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Xr(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};$.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};$.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};$.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};$.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};$.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Xr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Xr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb.prototype.decrypt=$.ofb.prototype.encrypt;$.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Xr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Jr(this._inBlock)};$.ctr.prototype.decrypt=$.ctr.prototype.encrypt;$.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0,this._R=3774873600};$.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=It.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=It.util.createBuffer(t.additionalData):r=It.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=It.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Xn(n*8)))}this._inBlock=this._j0.slice(0),Jr(this._inBlock),this._partialBytes=0,r=It.util.createBuffer(r),this._aDataLength=Xn(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};$.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Jr(this._inBlock)};$.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Jr(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};$.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=It.util.createBuffer();var n=this._aDataLength.concat(Xn(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};$.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};$.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};$.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};$.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};$.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;a[f]=1<<e-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};$.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],f=i[s];i[o+s]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var c=i[o^n];i[o]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function Xr(t,e){if(typeof t=="string"&&(t=It.util.createBuffer(t)),It.util.isArray(t)&&t.length>4){var r=t;t=It.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!It.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function Jr(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Xn(t){return[t/4294967296|0,t&4294967295]}});var tn=ft((Hd,oa)=>{var st=it();Qn();Jn();bt();oa.exports=st.aes=st.aes||{};st.aes.startEncrypting=function(t,e,r,n){var i=jr({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};st.aes.createEncryptionCipher=function(t,e){return jr({key:t,output:null,decrypt:!1,mode:e})};st.aes.startDecrypting=function(t,e,r,n){var i=jr({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};st.aes.createDecryptionCipher=function(t,e){return jr({key:t,output:null,decrypt:!0,mode:e})};st.aes.Algorithm=function(t,e){ei||na();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return ti(r._w,n,i,!1)},decrypt:function(n,i){return ti(r._w,n,i,!0)}}}),r._init=!1};st.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=st.util.createBuffer(e);else if(st.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=st.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!st.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!st.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=ia(e,t.decrypt&&!s),this._init=!0}};st.aes._expandKey=function(t,e){return ei||na(),ia(t,e)};st.aes._updateBlock=ti;nr("AES-ECB",st.cipher.modes.ecb);nr("AES-CBC",st.cipher.modes.cbc);nr("AES-CFB",st.cipher.modes.cfb);nr("AES-OFB",st.cipher.modes.ofb);nr("AES-CTR",st.cipher.modes.ctr);nr("AES-GCM",st.cipher.modes.gcm);function nr(t,e){var r=function(){return new st.aes.Algorithm(t,e)};st.cipher.registerAlgorithm(t,r)}var ei=!1,rr=4,Pt,jn,ra,Ve,Yt;function na(){ei=!0,ra=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Pt=new Array(256),jn=new Array(256),Ve=new Array(4),Yt=new Array(4);for(var e=0;e<4;++e)Ve[e]=new Array(256),Yt[e]=new Array(256);for(var r=0,n=0,i,o,s,a,f,c,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Pt[r]=a,jn[a]=r,f=t[a],i=t[r],o=t[i],s=t[o],c=f<<24^a<<16^a<<8^(a^f),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var h=0;h<4;++h)Ve[h][r]=c,Yt[h][a]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function ia(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=rr*s,f=o;f<a;++f)n=r[f-1],f%o===0?(n=Pt[n>>>16&255]<<24^Pt[n>>>8&255]<<16^Pt[n&255]<<8^Pt[n>>>24]^ra[i]<<24,i++):o>6&&f%o===4&&(n=Pt[n>>>24]<<24^Pt[n>>>16&255]<<16^Pt[n>>>8&255]<<8^Pt[n&255]),r[f]=r[f-o]^n;if(e){var c,u=Yt[0],h=Yt[1],p=Yt[2],x=Yt[3],l=r.slice(0);a=r.length;for(var f=0,d=a-rr;f<a;f+=rr,d-=rr)if(f===0||f===a-rr)l[f]=r[d],l[f+1]=r[d+3],l[f+2]=r[d+2],l[f+3]=r[d+1];else for(var y=0;y<rr;++y)c=r[d+y],l[f+(3&-y)]=u[Pt[c>>>24]]^h[Pt[c>>>16&255]]^p[Pt[c>>>8&255]]^x[Pt[c&255]];r=l}return r}function ti(t,e,r,n){var i=t.length/4-1,o,s,a,f,c;n?(o=Yt[0],s=Yt[1],a=Yt[2],f=Yt[3],c=jn):(o=Ve[0],s=Ve[1],a=Ve[2],f=Ve[3],c=Pt);var u,h,p,x,l,d,y;u=e[0]^t[0],h=e[n?3:1]^t[1],p=e[2]^t[2],x=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)l=o[u>>>24]^s[h>>>16&255]^a[p>>>8&255]^f[x&255]^t[++m],d=o[h>>>24]^s[p>>>16&255]^a[x>>>8&255]^f[u&255]^t[++m],y=o[p>>>24]^s[x>>>16&255]^a[u>>>8&255]^f[h&255]^t[++m],x=o[x>>>24]^s[u>>>16&255]^a[h>>>8&255]^f[p&255]^t[++m],u=l,h=d,p=y;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[p>>>8&255]<<8^c[x&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[p>>>16&255]<<16^c[x>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[p>>>24]<<24^c[x>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[x>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[p&255]^t[++m]}function jr(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=st.cipher.createDecipher(r,t.key):n=st.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof st.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var an=ft(($1,Ra)=>{var Lr=it();Lr.pki=Lr.pki||{};var Ii=Ra.exports=Lr.pki.oids=Lr.oids=Lr.oids||{};function T(t,e){Ii[t]=e,Ii[e]=t}function rt(t,e){Ii[t]=e}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");rt("2.5.29.1","authorityKeyIdentifier");rt("2.5.29.2","keyAttributes");rt("2.5.29.3","certificatePolicies");rt("2.5.29.4","keyUsageRestriction");rt("2.5.29.5","policyMapping");rt("2.5.29.6","subtreesConstraint");rt("2.5.29.7","subjectAltName");rt("2.5.29.8","issuerAltName");rt("2.5.29.9","subjectDirectoryAttributes");rt("2.5.29.10","basicConstraints");rt("2.5.29.11","nameConstraints");rt("2.5.29.12","policyConstraints");rt("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");rt("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");rt("2.5.29.20","cRLNumber");rt("2.5.29.21","cRLReason");rt("2.5.29.22","expirationDate");rt("2.5.29.23","instructionCode");rt("2.5.29.24","invalidityDate");rt("2.5.29.25","cRLDistributionPoints");rt("2.5.29.26","issuingDistributionPoint");rt("2.5.29.27","deltaCRLIndicator");rt("2.5.29.28","issuingDistributionPoint");rt("2.5.29.29","certificateIssuer");rt("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");rt("2.5.29.33","policyMappings");rt("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");rt("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");rt("2.5.29.46","freshestCRL");rt("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Dr=ft((Q1,Na)=>{var ct=it();bt();an();var P=Na.exports=ct.asn1=ct.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(ct.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||ct.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=P.copy(a)),a};P.copy=function(t,e){var r;if(ct.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(ct.util.isArray(t)){if(!ct.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Nr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Tc=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;Nr(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ct.util.createBuffer(t));var r=t.length(),n=sn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function sn(t,e,r,n){var i;Nr(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var f=Tc(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,p=(o&32)===32;if(p)if(u=[],f===void 0)for(;;){if(Nr(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}i=t.length(),u.push(sn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(sn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&f>1){var x=t.read,l=e,d=0;if(a===P.Type.BITSTRING&&(Nr(t,e,1),d=t.getByte(),e--),d===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=sn(t,e,r+1,y),E=i-t.length();e-=E,a==P.Type.BITSTRING&&E++;var b=m.tagClass;E===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=x,e=l)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(a===P.Type.BMPSTRING)for(u="";f>0;f-=2)Nr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var R=h===void 0?null:{bitStringContents:h};return P.create(s,a,p,u,R)}P.toDer=function(t){var e=ct.util.createBuffer(),r=t.tagClass|t.type,n=ct.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(P.toDer(t.value[o]))}else if(t.type===P.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=ct.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=ct.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(a=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),p=u*60+h;p*=6e4,f==="+"?e.setTime(+e-p):e.setTime(+e+p)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,p=t.charAt(h);if(p==="+"||p==="-"){var x=parseInt(t.substr(h+1,2),10),l=parseInt(t.substr(h+4,2),10);c=x*60+l,c*=6e4,p==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(o,s,a,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=ct.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=ct.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&ct.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=P.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var La=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=P.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,ct.pki&&ct.pki.oids&&f in ct.pki.oids&&(n+=" ("+ct.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+ct.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+ct.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)La.test(t.value)||(n+="("+t.value+") "),n+="0x"+ct.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=ct.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+ct.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:La.test(t.value)?n+="0x"+ct.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Pa=ft((X1,ka)=>{var lt=it();Qn();Jn();bt();ka.exports=lt.des=lt.des||{};lt.des.startEncrypting=function(t,e,r,n){var i=fn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};lt.des.createEncryptionCipher=function(t,e){return fn({key:t,output:null,decrypt:!1,mode:e})};lt.des.startDecrypting=function(t,e,r,n){var i=fn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};lt.des.createDecryptionCipher=function(t,e){return fn({key:t,output:null,decrypt:!0,mode:e})};lt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Da(r._keys,n,i,!1)},decrypt:function(n,i){return Da(r._keys,n,i,!0)}}}),r._init=!1};lt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=lt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Kc(e),this._init=!0}};ie("DES-ECB",lt.cipher.modes.ecb);ie("DES-CBC",lt.cipher.modes.cbc);ie("DES-CFB",lt.cipher.modes.cfb);ie("DES-OFB",lt.cipher.modes.ofb);ie("DES-CTR",lt.cipher.modes.ctr);ie("3DES-ECB",lt.cipher.modes.ecb);ie("3DES-CBC",lt.cipher.modes.cbc);ie("3DES-CFB",lt.cipher.modes.cfb);ie("3DES-OFB",lt.cipher.modes.ofb);ie("3DES-CTR",lt.cipher.modes.ctr);function ie(t,e){var r=function(){return new lt.des.Algorithm(t,e)};lt.cipher.registerAlgorithm(t,r)}var _c=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Rc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Lc=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Nc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Dc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],kc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Pc=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Uc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Kc(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],l=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,R=0;R<d;R++){var w=t.getInt32(),B=t.getInt32();b=(w>>>4^B)&252645135,B^=b,w^=b<<4,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>2^B)&858993459,B^=b,w^=b<<2,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=(B>>>8^w)&16711935,w^=b,B^=b<<8,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=w<<8|B>>>20&240,w=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,B=B<<2|B>>>26):(w=w<<1|w>>>27,B=B<<1|B>>>27),w&=-15,B&=-15;var N=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|o[w>>>12&15]|s[w>>>8&15]|a[w>>>4&15],z=f[B>>>28]|c[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|p[B>>>12&15]|x[B>>>8&15]|l[B>>>4&15];b=(z>>>16^N)&65535,y[E++]=N^b,y[E++]=z^b<<16}}return y}function Da(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],f=e[1];s=(a>>>4^f)&252645135,f^=s,a^=s<<4,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=o[c+1],h=o[c+2],p=o[c];p!=u;p+=h){var x=f^t[p],l=(f>>>4|f<<28)^t[p+1];s=a,a=f,f=s^(Rc[x>>>24&63]|Nc[x>>>16&63]|kc[x>>>8&63]|Uc[x&63]|_c[l>>>24&63]|Lc[l>>>16&63]|Dc[l>>>8&63]|Pc[l&63])}s=a,a=f,f=s}a=a>>>1|a<<31,f=f>>>1|f<<31,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(a>>>4^f)&252645135,f^=s,a^=s<<4,r[0]=a,r[1]=f}function fn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=lt.cipher.createDecipher(r,t.key):n=lt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof lt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var He=ft((J1,Ua)=>{var cn=it();Ua.exports=cn.md=cn.md||{};cn.md.algorithms=cn.md.algorithms||{}});var Oa=ft((j1,Ka)=>{var xe=it();He();bt();var Oc=Ka.exports=xe.hmac=xe.hmac||{};Oc.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in xe.md.algorithms)e=xe.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=xe.util.createBuffer(s);else if(xe.util.isArray(s)){var a=s;s=xe.util.createBuffer();for(var f=0;f<a.length;++f)s.putByte(a[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=xe.util.createBuffer(),n=xe.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var a=s.at(f);r.putByte(54^a),n.putByte(92^a)}if(c<e.blockLength)for(var a=e.blockLength-c,f=0;f<a;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var un=ft(()=>{});var Ti=ft((ry,Ma)=>{var Ut=it();Oa();He();bt();var Mc=Ut.pkcs5=Ut.pkcs5||{},ge;Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&(ge=un());Ma.exports=Ut.pbkdf2=Mc.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&ge.pbkdf2&&(i===null||typeof i!="object")&&(ge.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?ge.pbkdf2Sync.length===4?ge.pbkdf2(t,e,r,n,function(b,R){if(b)return o(b);o(null,R.toString("binary"))}):ge.pbkdf2(t,e,r,n,i,function(b,R){if(b)return o(b);o(null,R.toString("binary"))}):ge.pbkdf2Sync.length===4?ge.pbkdf2Sync(t,e,r,n).toString("binary"):ge.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ut.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ut.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var f=Math.ceil(n/s),c=n-(f-1)*s,u=Ut.hmac.create();u.start(i,t);var h="",p,x,l;if(!o){for(var d=1;d<=f;++d){u.start(null,null),u.update(e),u.update(Ut.util.int32ToBytes(d)),p=l=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(l),x=u.digest().getBytes(),p=Ut.util.xorBytes(p,x,s),l=x;h+=d<f?p:p.substr(0,c)}return h}var d=1,y;function m(){if(d>f)return o(null,h);u.start(null,null),u.update(e),u.update(Ut.util.int32ToBytes(d)),p=l=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(l),x=u.digest().getBytes(),p=Ut.util.xorBytes(p,x,s),l=x,++y,Ut.util.setImmediate(E);h+=d<f?p:p.substr(0,c),++d,m()}m()}});var Fa=ft((ny,qa)=>{var ln=it();bt();var Va=qa.exports=ln.pem=ln.pem||{};Va.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=hn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=hn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=hn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=hn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=ln.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Va.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:ln.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var f=o[2].split(i),c=0;o&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var p=f[h];if(!/\s/.test(p[0]))break;u+=p,c=h}if(o=u.match(n),o){for(var x={name:o[1],values:[]},l=o[2].split(","),d=0;d<l.length;++d)x.values.push(Vc(l[d]));if(a.procType)if(!a.contentDomain&&x.name==="Content-Domain")a.contentDomain=l[0]||"";else if(!a.dekInfo&&x.name==="DEK-Info"){if(x.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:l[0],parameters:l[1]||null}}else a.headers.push(x);else{if(x.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(x.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:l[0],type:l[1]}}}++c}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function hn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Vc(t){return t.replace(/^\s+/,"")}});var Za=ft((iy,Ya)=>{var oe=it();He();bt();var za=Ya.exports=oe.sha256=oe.sha256||{};oe.md.sha256=oe.md.algorithms.sha256=za;za.create=function(){Ga||qc();var t=null,e=oe.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=oe.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=oe.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Ha(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=oe.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(_i.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Ha(h,r,i);var p=oe.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p.putInt32(h.h5),p.putInt32(h.h6),p.putInt32(h.h7),p},n};var _i=null,Ga=!1,Wa=null;function qc(){_i="\x80",_i+=oe.util.fillString("\0",64),Wa=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ga=!0}function Ha(t,e,r){for(var n,i,o,s,a,f,c,u,h,p,x,l,d,y,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,p=t.h2,x=t.h3,l=t.h4,d=t.h5,y=t.h6,m=t.h7,c=0;c<64;++c)s=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7),a=y^l&(d^y),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|p&(u^h),n=m+s+a+Wa[c]+e[c],i=o+f,m=y,y=d,d=l,l=x+n>>>0,x=p,p=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+p|0,t.h3=t.h3+x|0,t.h4=t.h4+l|0,t.h5=t.h5+d|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var Qa=ft((oy,$a)=>{var ae=it();bt();var pn=null;ae.util.isNodejs&&!ae.options.usePureJavaScript&&!process.versions["node-webkit"]&&(pn=un());var Fc=$a.exports=ae.prng=ae.prng||{};Fc.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,p=e.plugin.increment,x=e.plugin.formatKey,l=e.plugin.formatSeed,d=ae.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(d.length()>=c)return u(null,d.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return ae.util.nextTick(function(){o(y)});var E=h(e.key,e.seed);e.generated+=E.length,d.putBytes(E),e.key=x(h(e.key,p(e.seed))),e.seed=l(h(e.key,e.seed)),ae.util.setImmediate(y)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,x=e.plugin.formatSeed;e.key=null;for(var l=ae.util.createBuffer();l.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var d=u(e.key,e.seed);e.generated+=d.length,l.putBytes(d),e.key=p(u(e.key,h(e.seed))),e.seed=x(u(e.key,e.seed))}return l.getBytes(c)};function o(c){if(e.pools[0].messageLength>=32)return a(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,p){if(h)return c(h);e.collect(p),a(),c()})}function s(){if(e.pools[0].messageLength>=32)return a();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var p=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(p),e.generated=0}function f(c){var u=null,h=ae.util.globalScope,p=h.crypto||h.msCrypto;p&&p.getRandomValues&&(u=function(w){return p.getRandomValues(w)});var x=ae.util.createBuffer();if(u)for(;x.length()<c;){var l=Math.max(1,Math.min(c-x.length(),65536)/4),d=new Uint32Array(Math.floor(l));try{u(d);for(var y=0;y<d.length;++y)x.putInt32(d[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(x.length()<c)for(var m,E,b,R=Math.floor(Math.random()*65536);x.length()<c;){E=16807*(R&65535),m=16807*(R>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),R=E&4294967295;for(var y=0;y<3;++y)b=R>>>(y<<3),b^=Math.floor(Math.random()*256),x.putByte(b&255)}return x.getBytes(c)}return pn?(e.seedFile=function(c,u){pn.randomBytes(c,function(h,p){if(h)return u(h);u(null,p.toString())})},e.seedFileSync=function(c){return pn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",p=0;p<u;p+=8)h+=String.fromCharCode(c>>p&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,p){function x(l){var d=l.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",x),p(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var p=h.data;p.forge&&p.forge.prng&&e.seedFile(p.forge.prng.needed,function(x,l){c.postMessage({forge:{prng:{err:x,bytes:l}}})})};c.addEventListener("message",u)}},e}});var kr=ft((ay,Ri)=>{var Tt=it();tn();Za();Qa();bt();(function(){if(Tt.random&&Tt.random.getBytes){Ri.exports=Tt.random;return}(function(t){var e={},r=new Array(4),n=Tt.util.createBuffer();e.formatKey=function(h){var p=Tt.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),Tt.aes._expandKey(h,!1)},e.formatSeed=function(h){var p=Tt.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),h},e.cipher=function(h,p){return Tt.aes._updateBlock(h,p,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Tt.md.sha256;function i(){var h=Tt.prng.create(e);return h.getBytes=function(p,x){return h.generate(p,x)},h.getBytesSync=function(p){return h.generate(p)},h}var o=i(),s=null,a=Tt.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),Tt.options.usePureJavaScript||!Tt.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}o.collect(c),c=null}t&&(t().mousemove(function(h){o.collectInt(h.clientX,16),o.collectInt(h.clientY,16)}),t().keypress(function(h){o.collectInt(h.charCode,8)}))}if(!Tt.random)Tt.random=o;else for(var u in o)Tt.random[u]=o[u];Tt.random.createInstance=i,Ri.exports=Tt.random})(typeof jQuery<"u"?jQuery:null)})()});var ts=ft((sy,ja)=>{var Kt=it();bt();var Li=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Xa=[1,2,3,5],Hc=function(t,e){return t<<e&65535|(t&65535)>>16-e},zc=function(t,e){return(t&65535)>>e|t<<16-e&65535};ja.exports=Kt.rc2=Kt.rc2||{};Kt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Kt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Li[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,Li[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,Li[r.at(a+1)^r.at(a+o)]);return r};var Ja=function(t,e,r){var n=!1,i=null,o=null,s=null,a,f,c,u,h=[];for(t=Kt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(a=function(l){for(c=0;c<4;c++)l[c]+=h[u]+(l[(c+3)%4]&l[(c+2)%4])+(~l[(c+3)%4]&l[(c+1)%4]),l[c]=Hc(l[c],Xa[c]),u++},f=function(l){for(c=0;c<4;c++)l[c]+=h[l[(c+3)%4]&63]}):(a=function(l){for(c=3;c>=0;c--)l[c]=zc(l[c],Xa[c]),l[c]-=h[u]+(l[(c+3)%4]&l[(c+2)%4])+(~l[(c+3)%4]&l[(c+1)%4]),u--},f=function(l){for(c=3;c>=0;c--)l[c]-=h[l[(c+3)%4]&63]});var p=function(l){var d=[];for(c=0;c<4;c++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),d.push(y&65535)}u=r?0:63;for(var m=0;m<l.length;m++)for(var E=0;E<l[m][0];E++)l[m][1](d);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(d[c]):d[c]^=s.getInt16Le()),o.putInt16Le(d[c])},x=null;return x={start:function(l,d){l&&typeof l=="string"&&(l=Kt.util.createBuffer(l)),n=!1,i=Kt.util.createBuffer(),o=d||new Kt.util.createBuffer,s=l,x.output=o},update:function(l){for(n||i.putBuffer(l);i.length()>=8;)p([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(l){var d=!0;if(r)if(l)d=l(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(d&&(n=!0,x.update()),!r&&(d=i.length()===0,d))if(l)d=l(8,o,!r);else{var m=o.length(),E=o.at(m-1);E>m?d=!1:o.truncate(E)}return d}},x};Kt.rc2.startEncrypting=function(t,e,r){var n=Kt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createEncryptionCipher=function(t,e){return Ja(t,e,!0)};Kt.rc2.startDecrypting=function(t,e,r){var n=Kt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createDecryptionCipher=function(t,e){return Ja(t,e,!1)}});var xn=ft((fy,fs)=>{var Ni=it();fs.exports=Ni.jsbn=Ni.jsbn||{};var me,Gc=0xdeadbeefcafe,es=(Gc&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Ni.jsbn.BigInteger=C;function tt(){return new C(null)}function Wc(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Yc(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=a*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+a*c+(i>>>30),r.data[n++]=f&1073741823}return i}function rs(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=a*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+a*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=rs,me=28):es&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Yc,me=30):es&&navigator.appName!="Netscape"?(C.prototype.am=Wc,me=26):(C.prototype.am=rs,me=28);C.prototype.DB=me;C.prototype.DM=(1<<me)-1;C.prototype.DV=1<<me;var Di=52;C.prototype.FV=Math.pow(2,Di);C.prototype.F1=Di-me;C.prototype.F2=2*me-Di;var Zc="0123456789abcdefghijklmnopqrstuvwxyz",dn=new Array,cr,Ht;cr=48;for(Ht=0;Ht<=9;++Ht)dn[cr++]=Ht;cr=97;for(Ht=10;Ht<36;++Ht)dn[cr++]=Ht;cr=65;for(Ht=10;Ht<36;++Ht)dn[cr++]=Ht;function ns(t){return Zc.charAt(t)}function is(t,e){var r=dn[t.charCodeAt(e)];return r??-1}function $c(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Qc(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Re(t){var e=tt();return e.fromInt(t),e}function Xc(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:is(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&t[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Jc(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function jc(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=ns(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=ns(n));return i?o:"0"}function tu(){var t=tt();return C.ZERO.subTo(this,t),t}function eu(){return this.s<0?this.negate():this}function ru(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function yn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function nu(){return this.t<=0?0:this.DB*(this.t-1)+yn(this.data[this.t-1]^this.s&this.DM)}function iu(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function ou(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function au(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function su(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function fu(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function cu(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function uu(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function hu(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=tt());var o=tt(),s=this.s,a=t.s,f=this.DB-yn(n.data[n.t-1]);f>0?(n.lShiftTo(f,o),i.lShiftTo(f,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,u=o.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?o.data[c-2]>>this.F2:0),p=this.FV/h,x=(1<<this.F1)/h,l=1<<this.F2,d=r.t,y=d-c,m=e??tt();for(o.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(o,o);o.t<c;)o.data[o.t++]=0;for(;--y>=0;){var E=r.data[--d]==u?this.DM:Math.floor(r.data[d]*p+(r.data[d-1]+l)*x);if((r.data[d]+=o.am(0,E,r,y,0,c))<E)for(o.dlShiftTo(y,m),r.subTo(m,r);r.data[d]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=a&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&C.ZERO.subTo(r,r)}}}function lu(t){var e=tt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function ze(t){this.m=t}function pu(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function du(t){return t}function yu(t){t.divRemTo(this.m,null,t)}function xu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function gu(t,e){t.squareTo(e),this.reduce(e)}ze.prototype.convert=pu;ze.prototype.revert=du;ze.prototype.reduce=yu;ze.prototype.mulTo=xu;ze.prototype.sqrTo=gu;function mu(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Ge(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function vu(t){var e=tt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function bu(t){var e=tt();return t.copyTo(e),this.reduce(e),e}function Eu(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function wu(t,e){t.squareTo(e),this.reduce(e)}function Bu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ge.prototype.convert=vu;Ge.prototype.revert=bu;Ge.prototype.reduce=Eu;Ge.prototype.mulTo=Bu;Ge.prototype.sqrTo=wu;function Su(){return(this.t>0?this.data[0]&1:this.s)==0}function Au(t,e){if(t>4294967295||t<1)return C.ONE;var r=tt(),n=tt(),i=e.convert(this),o=yn(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Cu(t,e){var r;return t<256||e.isEven()?r=new ze(e):r=new Ge(e),this.exp(t,r)}C.prototype.copyTo=$c;C.prototype.fromInt=Qc;C.prototype.fromString=Xc;C.prototype.clamp=Jc;C.prototype.dlShiftTo=iu;C.prototype.drShiftTo=ou;C.prototype.lShiftTo=au;C.prototype.rShiftTo=su;C.prototype.subTo=fu;C.prototype.multiplyTo=cu;C.prototype.squareTo=uu;C.prototype.divRemTo=hu;C.prototype.invDigit=mu;C.prototype.isEven=Su;C.prototype.exp=Au;C.prototype.toString=jc;C.prototype.negate=tu;C.prototype.abs=eu;C.prototype.compareTo=ru;C.prototype.bitLength=nu;C.prototype.mod=lu;C.prototype.modPowInt=Cu;C.ZERO=Re(0);C.ONE=Re(1);function Iu(){var t=tt();return this.copyTo(t),t}function Tu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function _u(){return this.t==0?this.s:this.data[0]<<24>>24}function Ru(){return this.t==0?this.s:this.data[0]<<16>>16}function Lu(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Nu(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Du(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Re(r),i=tt(),o=tt(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function ku(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var f=is(t,a);if(f<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&C.ZERO.subTo(this,this)}function Pu(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),ki,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Uu(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Ku(t){return this.compareTo(t)==0}function Ou(t){return this.compareTo(t)<0?this:t}function Mu(t){return this.compareTo(t)>0?this:t}function Vu(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function qu(t,e){return t&e}function Fu(t){var e=tt();return this.bitwiseTo(t,qu,e),e}function ki(t,e){return t|e}function Hu(t){var e=tt();return this.bitwiseTo(t,ki,e),e}function os(t,e){return t^e}function zu(t){var e=tt();return this.bitwiseTo(t,os,e),e}function as(t,e){return t&~e}function Gu(t){var e=tt();return this.bitwiseTo(t,as,e),e}function Wu(){for(var t=tt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Yu(t){var e=tt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Zu(t){var e=tt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function $u(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Qu(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+$u(this.data[t]);return this.s<0?this.t*this.DB:-1}function Xu(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Ju(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Xu(this.data[r]^e);return t}function ju(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function th(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function eh(t){return this.changeBit(t,ki)}function rh(t){return this.changeBit(t,as)}function nh(t){return this.changeBit(t,os)}function ih(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function oh(t){var e=tt();return this.addTo(t,e),e}function ah(t){var e=tt();return this.subTo(t,e),e}function sh(t){var e=tt();return this.multiplyTo(t,e),e}function fh(t){var e=tt();return this.divRemTo(t,e,null),e}function ch(t){var e=tt();return this.divRemTo(t,null,e),e}function uh(t){var e=tt(),r=tt();return this.divRemTo(t,e,r),new Array(e,r)}function hh(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function lh(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Pr(){}function ss(t){return t}function ph(t,e,r){t.multiplyTo(e,r)}function dh(t,e){t.squareTo(e)}Pr.prototype.convert=ss;Pr.prototype.revert=ss;Pr.prototype.mulTo=ph;Pr.prototype.sqrTo=dh;function yh(t){return this.exp(t,new Pr)}function xh(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function gh(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function ur(t){this.r2=tt(),this.q3=tt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function mh(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=tt();return t.copyTo(e),this.reduce(e),e}function vh(t){return t}function bh(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Eh(t,e){t.squareTo(e),this.reduce(e)}function wh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ur.prototype.convert=mh;ur.prototype.revert=vh;ur.prototype.reduce=bh;ur.prototype.mulTo=wh;ur.prototype.sqrTo=Eh;function Bh(t,e){var r=t.bitLength(),n,i=Re(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new ze(e):e.isEven()?o=new ur(e):o=new Ge(e);var s=new Array,a=3,f=n-1,c=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=tt();for(o.sqrTo(s[1],u);a<=c;)s[a]=tt(),o.mulTo(u,s[a-2],s[a]),a+=2}var h=t.t-1,p,x=!0,l=tt(),d;for(r=yn(t.data[h])-1;h>=0;){for(r>=f?p=t.data[h]>>r-f&c:(p=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(p|=t.data[h-1]>>this.DB+r-f)),a=n;!(p&1);)p>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),x)s[p].copyTo(i),x=!1;else{for(;a>1;)o.sqrTo(i,l),o.sqrTo(l,i),a-=2;a>0?o.sqrTo(i,l):(d=i,i=l,l=d),o.mulTo(l,s[p],i)}for(;h>=0&&!(t.data[h]&1<<r);)o.sqrTo(i,l),d=i,i=l,l=d,--r<0&&(r=this.DB-1,--h)}return o.revert(i)}function Sh(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function Ah(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Ch(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=Re(1),o=Re(0),s=Re(0),a=Re(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Zt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ih=(1<<26)/Zt[Zt.length-1];function Th(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Zt[Zt.length-1]){for(e=0;e<Zt.length;++e)if(r.data[0]==Zt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Zt.length;){for(var n=Zt[e],i=e+1;i<Zt.length&&n<Ih;)n*=Zt[i++];for(n=r.modInt(n);e<i;)if(n%Zt[e++]==0)return!1}return r.millerRabin(t)}function _h(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Rh(),o,s=0;s<t;++s){do o=new C(this.bitLength(),i);while(o.compareTo(C.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(C.ONE)!=0&&a.compareTo(e)!=0){for(var f=1;f++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(C.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function Rh(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=Lu;C.prototype.toRadix=Du;C.prototype.fromRadix=ku;C.prototype.fromNumber=Pu;C.prototype.bitwiseTo=Vu;C.prototype.changeBit=th;C.prototype.addTo=ih;C.prototype.dMultiply=hh;C.prototype.dAddOffset=lh;C.prototype.multiplyLowerTo=xh;C.prototype.multiplyUpperTo=gh;C.prototype.modInt=Ah;C.prototype.millerRabin=_h;C.prototype.clone=Iu;C.prototype.intValue=Tu;C.prototype.byteValue=_u;C.prototype.shortValue=Ru;C.prototype.signum=Nu;C.prototype.toByteArray=Uu;C.prototype.equals=Ku;C.prototype.min=Ou;C.prototype.max=Mu;C.prototype.and=Fu;C.prototype.or=Hu;C.prototype.xor=zu;C.prototype.andNot=Gu;C.prototype.not=Wu;C.prototype.shiftLeft=Yu;C.prototype.shiftRight=Zu;C.prototype.getLowestSetBit=Qu;C.prototype.bitCount=Ju;C.prototype.testBit=ju;C.prototype.setBit=eh;C.prototype.clearBit=rh;C.prototype.flipBit=nh;C.prototype.add=oh;C.prototype.subtract=ah;C.prototype.multiply=sh;C.prototype.divide=fh;C.prototype.remainder=ch;C.prototype.divideAndRemainder=uh;C.prototype.modPow=Bh;C.prototype.modInverse=Ch;C.prototype.pow=yh;C.prototype.gcd=Sh;C.prototype.isProbablePrime=Th});var ps=ft((cy,ls)=>{var se=it();He();bt();var us=ls.exports=se.sha1=se.sha1||{};se.md.sha1=se.md.algorithms.sha1=us;us.create=function(){hs||Lh();var t=null,e=se.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=se.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=se.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),cs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=se.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Pi.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};cs(h,r,i);var p=se.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p},n};var Pi=null,hs=!1;function Lh(){Pi="\x80",Pi+=se.util.fillString("\0",64),hs=!0}function cs(t,e,r){for(var n,i,o,s,a,f,c,u,h=r.length();h>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o&s|a&(o^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+3395469782+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+f|0,h-=64}}});var xs=ft((uy,ys)=>{var fe=it();bt();kr();ps();var ds=ys.exports=fe.pkcs1=fe.pkcs1||{};ds.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=fe.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),f=a-2*o.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),o.update(n,"raw");for(var u=o.digest(),h="",p=f-e.length,x=0;x<p;x++)h+="\0";var l=u.getBytes()+h+""+e;if(!i)i=fe.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=o.digestLength,c}var d=gn(i,a-o.digestLength-1,s),y=fe.util.xorBytes(l,d,l.length),m=gn(y,o.digestLength,s),E=fe.util.xorBytes(i,m,i.length);return"\0"+E+y};ds.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=fe.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=gn(u,i.digestLength,o),p=fe.util.xorBytes(c,h,c.length),x=gn(p,s-i.digestLength-1,o),l=fe.util.xorBytes(u,x,u.length),d=l.substring(0,i.digestLength),y=f!=="\0",m=0;m<i.digestLength;++m)y|=a.charAt(m)!==d.charAt(m);for(var E=1,b=i.digestLength,R=i.digestLength;R<l.length;R++){var w=l.charCodeAt(R),B=w&1^1,L=E?65534:0;y|=w&L,E=E&B,b+=E}if(y||l.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return l.substring(b+1)};function gn(t,e,r){r||(r=fe.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var gs=ft((hy,Ui)=>{var Le=it();bt();xn();kr();(function(){if(Le.prime){Ui.exports=Le.prime;return}var t=Ui.exports=Le.prime=Le.prime||{},e=Le.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,p){return h|p};t.generateProbablePrime=function(h,p,x){typeof p=="function"&&(x=p,p={}),p=p||{};var l=p.algorithm||"PRIMEINC";typeof l=="string"&&(l={name:l}),l.options=l.options||{};var d=p.prng||Le.random,y={nextBytes:function(m){for(var E=d.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(l.name==="PRIMEINC")return o(h,y,l.options,x);throw new Error("Invalid prime generation algorithm: "+l.name)};function o(h,p,x,l){return"workers"in x?f(h,p,x,l):s(h,p,x,l)}function s(h,p,x,l){var d=c(h,p),y=0,m=u(d.bitLength());"millerRabinTests"in x&&(m=x.millerRabinTests);var E=10;"maxBlockTime"in x&&(E=x.maxBlockTime),a(d,h,p,y,m,E,l)}function a(h,p,x,l,d,y,m){var E=+new Date;do{if(h.bitLength()>p&&(h=c(p,x)),h.isProbablePrime(d))return m(null,h);h.dAddOffset(r[l++%8],0)}while(y<0||+new Date-E<y);Le.util.setImmediate(function(){a(h,p,x,l,d,y,m)})}function f(h,p,x,l){if(typeof Worker>"u")return s(h,p,x,l);var d=c(h,p),y=x.workers,m=x.workLoad||100,E=m*30/8,b=x.workerScript||"forge/prime.worker.js";if(y===-1)return Le.util.estimateCores(function(w,B){w&&(B=2),y=B-1,R()});R();function R(){y=Math.max(1,y);for(var w=[],B=0;B<y;++B)w[B]=new Worker(b);for(var L=y,B=0;B<y;++B)w[B].addEventListener("message",z);var N=!1;function z(H){if(!N){--L;var V=H.data;if(V.found){for(var Q=0;Q<w.length;++Q)w[Q].terminate();return N=!0,l(null,new e(V.prime,16))}d.bitLength()>h&&(d=c(h,p));var ot=d.toString(16);H.target.postMessage({hex:ot,workLoad:m}),d.dAddOffset(E,0)}}}}function c(h,p){var x=new e(h,p),l=h-1;return x.testBit(l)||x.bitwiseTo(e.ONE.shiftLeft(l),i,x),x.dAddOffset(31-x.mod(n).byteValue(),0),x}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var vn=ft((ly,Ss)=>{var M=it();Dr();xn();an();xs();gs();kr();bt();typeof j>"u"&&(j=M.jsbn.BigInteger);var j,Ki=M.util.isNodejs?un():null,v=M.asn1,zt=M.util;M.pki=M.pki||{};Ss.exports=M.pki.rsa=M.rsa=M.rsa||{};var G=M.pki,Nh=[6,4,2,4,2,4,6,2],Dh={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},kh={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Ph={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Uh=M.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Kh={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Oh=function(t){var e;if(t.algorithm in G.oids)e=G.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),o=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);o.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),o.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var s=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),v.toDer(i).getBytes()},ws=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(j.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(j.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new j(M.util.bytesToHex(M.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(j.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};G.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Bs(t,e,r)):(i=M.util.createBuffer(),i.putBytes(t));for(var s=new j(i.toHex(),16),a=ws(s,e,n),f=a.toString(16),c=M.util.createBuffer(),u=o-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),c.getBytes()};G.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new j(M.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=ws(s,e,r),f=a.toString(16),c=M.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),n!==!1?mn(c.getBytes(),e,r):c.getBytes()};G.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||M.random,i={nextBytes:function(a){for(var f=n.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=f.charCodeAt(c)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new j(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};G.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new j(null);r.fromInt(30);for(var n=0,i=function(h,p){return h|p},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new j(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(j.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Vh(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Nh[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(j.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};G.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!M.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(ms("generateKeyPair"))return Ki.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,c){if(a)return n(a);n(null,{privateKey:G.privateKeyFromPem(c),publicKey:G.publicKeyFromPem(f)})});if(vs("generateKey")&&vs("exportKey"))return zt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Es(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return zt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=G.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(a)));n(null,{privateKey:f,publicKey:G.setRsaPublicKey(f.n,f.e)})}});if(bs("generateKey")&&bs("exportKey")){var i=zt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Es(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var f=a.target.result,c=zt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,p=G.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(h)));n(null,{privateKey:p,publicKey:G.setRsaPublicKey(p.n,p.e)})},c.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(ms("generateKeyPairSync")){var o=Ki.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:G.privateKeyFromPem(o.privateKey),publicKey:G.publicKeyFromPem(o.publicKey)}}}var s=G.rsa.createKeyPairGenerationState(t,e,r);if(!n)return G.rsa.stepKeyPairGenerationState(s,0),s.keys;Mh(s,r,n)};G.setRsaPublicKey=G.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,f,c){return Bs(a,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,f){return M.pkcs1.encode_rsa_oaep(f,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return G.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(f,c){c=mn(c,r,!0);var u=v.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},p=[];if(!v.validate(u,Kh,h,p)){var x=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw x.errors=p,x}var l=v.derToOid(h.algorithmIdentifier);if(!(l===M.oids.md2||l===M.oids.md5||l===M.oids.sha1||l===M.oids.sha224||l===M.oids.sha256||l===M.oids.sha384||l===M.oids.sha512||l===M.oids["sha512-224"]||l===M.oids["sha512-256"])){var x=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw x.oid=l,x}if((l===M.oids.md2||l===M.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(f,c){return c=mn(c,r,!0),f===c}});var a=G.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};G.setRsaPrivateKey=G.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var f={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var p=G.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:mn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(x,l){return M.pkcs1.decode_rsa_oaep(l,x,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(p,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Oh},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var p=u.encode(c,f.n.bitLength());return G.rsa.encrypt(p,f,h)},f};G.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};G.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Dh,e,r)&&(t=v.fromDer(M.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,kh,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,f,c,u,h;return i=M.util.createBuffer(e.privateKeyModulus).toHex(),o=M.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=M.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=M.util.createBuffer(e.privateKeyPrime1).toHex(),f=M.util.createBuffer(e.privateKeyPrime2).toHex(),c=M.util.createBuffer(e.privateKeyExponent1).toHex(),u=M.util.createBuffer(e.privateKeyExponent2).toHex(),h=M.util.createBuffer(e.privateKeyCoefficient).toHex(),G.setRsaPrivateKey(new j(i,16),new j(o,16),new j(s,16),new j(a,16),new j(f,16),new j(c,16),new j(u,16),new j(h,16))};G.privateKeyToAsn1=G.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.qInv))])};G.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Uh,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==G.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,Ph,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=M.util.createBuffer(e.publicKeyModulus).toHex(),s=M.util.createBuffer(e.publicKeyExponent).toHex();return G.setRsaPublicKey(new j(o,16),new j(s,16))};G.publicKeyToAsn1=G.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[G.publicKeyToRSAPublicKey(t)])])};G.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,ce(t.e))])};function Bs(t,e,r){var n=M.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<s;++f)n.putByte(a)}else for(;s>0;){for(var c=0,u=M.random.getBytes(s),f=0;f<s;++f)a=u.charCodeAt(f),a===0?++c:n.putByte(a);s=c}return n.putByte(0),n.putBytes(t),n}function mn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=M.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=i-3-n;for(var c=0;c<f;++c)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++f}else if(a===2)for(f=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++f}var u=o.getByte();if(u!==0||f!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function Mh(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,f){if(a)return r(a);if(t.p=f,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,f){M.prime.generateProbablePrime(a,n,f)}function s(a,f){if(a)return r(a);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.p=null,i();return}if(t.q.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(j.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function ce(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=M.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Vh(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function ms(t){return M.util.isNodejs&&typeof Ki[t]=="function"}function vs(t){return typeof zt.globalScope<"u"&&typeof zt.globalScope.crypto=="object"&&typeof zt.globalScope.crypto.subtle=="object"&&typeof zt.globalScope.crypto.subtle[t]=="function"}function bs(t){return typeof zt.globalScope<"u"&&typeof zt.globalScope.msCrypto=="object"&&typeof zt.globalScope.msCrypto.subtle=="object"&&typeof zt.globalScope.msCrypto.subtle[t]=="function"}function Es(t){for(var e=M.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Rs=ft((py,_s)=>{var U=it();tn();Dr();Pa();He();an();Ti();Fa();kr();ts();vn();bt();typeof As>"u"&&(As=U.jsbn.BigInteger);var As,S=U.asn1,W=U.pki=U.pki||{};_s.exports=W.pbe=U.pbe=U.pbe||{};var We=W.oids,qh={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Fh={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Hh={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,o=S.integerToDer(i),s,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=We["aes128-CBC"],h=U.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=We["aes192-CBC"],h=U.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=We["aes256-CBC"],h=U.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=We.desCBC,h=U.des.createEncryptionCipher;break;default:var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var x="hmacWith"+r.prfAlgorithm.toUpperCase(),l=Ts(x),d=U.pkcs5.pbkdf2(e,n,i,s,l),y=U.random.getBytesSync(c),m=h(d);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes();var E=zh(n,o,s,x);a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(We.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(We.pkcs5PBKDF2).getBytes()),E]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(u).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var b=new U.util.ByteBuffer(n),d=W.pbe.generatePkcs12Key(e,b,1,i,s),y=W.pbe.generatePkcs12Key(e,b,2,i,s),m=U.des.createEncryptionCipher(d);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes(),a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(We["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,n),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,o.getBytes())])])}else{var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var R=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[a,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f)]);return R};W.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!S.validate(t,qh,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=S.derToOid(n.encryptionOid),a=W.pbe.getCipher(s,n.encryptionParams,e),f=U.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=S.fromDer(a.output)),r};W.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};W.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(e.body)};W.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(t));return n=W.encryptPrivateKeyInfo(n,e,r),W.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=U.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(c);u.start(o),u.update(S.toDer(W.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(h)};W.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=U.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=U.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=U.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(h){return U.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":o=8,s=function(h){return U.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":o=16,s=function(h){return U.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=U.util.hexToBytes(n.dekInfo.parameters),f=U.pbe.opensslDeriveBytes(e,a.substr(0,8),o),c=s(f);if(c.start(a),c.update(U.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(S.fromDer(r),e):r=S.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');o=U.md.sha1.create()}var f=o.digestLength,c=o.blockLength,u=new U.util.ByteBuffer,h=new U.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var p=h.length(),x=e.length(),l=new U.util.ByteBuffer;l.fillWithByte(r,c);var d=c*Math.ceil(x/c),y=new U.util.ByteBuffer;for(a=0;a<d;a++)y.putByte(e.at(a%x));var m=c*Math.ceil(p/c),E=new U.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(h.at(a%p));var b=y;b.putBuffer(E);for(var R=Math.ceil(i/f),w=1;w<=R;w++){var B=new U.util.ByteBuffer;B.putBytes(l.bytes()),B.putBytes(b.bytes());for(var L=0;L<n;L++)o.start(),o.update(B.getBytes()),B=o.digest();var N=new U.util.ByteBuffer;for(a=0;a<c;a++)N.putByte(B.at(a%f));var z=Math.ceil(x/c)+Math.ceil(p/c),H=new U.util.ByteBuffer;for(s=0;s<z;s++){var V=new U.util.ByteBuffer(b.getBytes(c)),Q=511;for(a=N.length()-1;a>=0;a--)Q=Q>>8,Q+=N.at(a)+V.at(a),V.setAt(a,Q&255);H.putBuffer(V)}b=H,u.putBuffer(B)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(t,e,r){switch(t){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(t,e,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!S.validate(e,Fh,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=S.derToOid(n.kdfOid),t!==W.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=S.derToOid(n.encOid),t!==W.oids["aes128-CBC"]&&t!==W.oids["aes192-CBC"]&&t!==W.oids["aes256-CBC"]&&t!==W.oids["des-EDE3-CBC"]&&t!==W.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=U.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,c;switch(W.oids[t]){case"aes128-CBC":f=16,c=U.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=U.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=U.des.createDecryptionCipher;break;case"desCBC":f=8,c=U.des.createDecryptionCipher;break}var u=Is(n.prfOid),h=U.pkcs5.pbkdf2(r,s,a,f,u),p=n.encIv,x=c(h);return x.start(p),x};W.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!S.validate(e,Hh,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=U.util.createBuffer(n.salt),a=U.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,c,u;switch(t){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=U.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(d,y){var m=U.rc2.createDecryptionCipher(d,40);return m.start(y,null),m};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var h=Is(n.prfOid),p=W.pbe.generatePkcs12Key(r,s,1,a,f,h);h.start();var x=W.pbe.generatePkcs12Key(r,s,2,a,c,h);return u(p,x)};W.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[Cs(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(Cs(n,i[s-1]+t+e));return i.join("").substr(0,r)};function Cs(t,e){return t.start().update(e).digest().getBytes()}function Is(t){var e;if(!t)e="hmacWithSHA1";else if(e=W.oids[S.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Ts(e)}function Ts(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function zh(t,e,r,n){var i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(W.oids[n]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),i}});var B0=ft((px,w0)=>{var ht=it();He();bt();var Hr=w0.exports=ht.sha512=ht.sha512||{};ht.md.sha512=ht.md.algorithms.sha512=Hr;var b0=ht.sha384=ht.sha512.sha384=ht.sha512.sha384||{};b0.create=function(){return Hr.create("SHA-384")};ht.md.sha384=ht.md.algorithms.sha384=b0;ht.sha512.sha256=ht.sha512.sha256||{create:function(){return Hr.create("SHA-512/256")}};ht.md["sha512/256"]=ht.md.algorithms["sha512/256"]=ht.sha512.sha256;ht.sha512.sha224=ht.sha512.sha224||{create:function(){return Hr.create("SHA-512/224")}};ht.md["sha512/224"]=ht.md.algorithms["sha512/224"]=ht.sha512.sha224;Hr.create=function(t){if(E0||up(),typeof t>"u"&&(t="SHA-512"),!(t in je))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=je[t],r=null,n=ht.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,c=0;c<f;++c)a.fullMessageLength.push(0);n=ht.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return a},a.start(),a.update=function(f,c){c==="utf8"&&(f=ht.util.encodeUtf8(f));var u=f.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),v0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=ht.util.createBuffer();f.putBytes(n.bytes());var c=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=c&a.blockLength-1;f.putBytes(mo.substr(0,a.blockLength-u));for(var h,p,x=a.fullMessageLength[0]*8,l=0;l<a.fullMessageLength.length-1;++l)h=a.fullMessageLength[l+1]*8,p=h/4294967296>>>0,x+=p,f.putInt32(x>>>0),x=h>>>0;f.putInt32(x);for(var d=new Array(r.length),l=0;l<r.length;++l)d[l]=r[l].slice(0);v0(d,i,f);var y=ht.util.createBuffer(),m;t==="SHA-512"?m=d.length:t==="SHA-384"?m=d.length-2:m=d.length-4;for(var l=0;l<m;++l)y.putInt32(d[l][0]),(l!==m-1||t!=="SHA-512/224")&&y.putInt32(d[l][1]);return y},a};var mo=null,E0=!1,vo=null,je=null;function up(){mo="\x80",mo+=ht.util.fillString("\0",128),vo=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],je={},je["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],je["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],je["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],je["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],E0=!0}function v0(t,e,r){for(var n,i,o,s,a,f,c,u,h,p,x,l,d,y,m,E,b,R,w,B,L,N,z,H,V,Q,ot,_t,I,k,_,D,A,K,O,F=r.length();F>=128;){for(I=0;I<16;++I)e[I][0]=r.getInt32()>>>0,e[I][1]=r.getInt32()>>>0;for(;I<80;++I)D=e[I-2],k=D[0],_=D[1],n=((k>>>19|_<<13)^(_>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|_>>>19)^(_<<3|k>>>29)^(k<<26|_>>>6))>>>0,K=e[I-15],k=K[0],_=K[1],o=((k>>>1|_<<31)^(k>>>8|_<<24)^k>>>7)>>>0,s=((k<<31|_>>>1)^(k<<24|_>>>8)^(k<<25|_>>>7))>>>0,A=e[I-7],O=e[I-16],_=i+A[1]+s+O[1],e[I][0]=n+A[0]+o+O[0]+(_/4294967296>>>0)>>>0,e[I][1]=_>>>0;for(d=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],R=t[2][1],w=t[3][0],B=t[3][1],L=t[4][0],N=t[4][1],z=t[5][0],H=t[5][1],V=t[6][0],Q=t[6][1],ot=t[7][0],_t=t[7][1],I=0;I<80;++I)c=((L>>>14|N<<18)^(L>>>18|N<<14)^(N>>>9|L<<23))>>>0,u=((L<<18|N>>>14)^(L<<14|N>>>18)^(N<<23|L>>>9))>>>0,h=(V^L&(z^V))>>>0,p=(Q^N&(H^Q))>>>0,a=((d>>>28|y<<4)^(y>>>2|d<<30)^(y>>>7|d<<25))>>>0,f=((d<<4|y>>>28)^(y<<30|d>>>2)^(y<<25|d>>>7))>>>0,x=(d&m|b&(d^m))>>>0,l=(y&E|R&(y^E))>>>0,_=_t+u+p+vo[I][1]+e[I][1],n=ot+c+h+vo[I][0]+e[I][0]+(_/4294967296>>>0)>>>0,i=_>>>0,_=f+l,o=a+x+(_/4294967296>>>0)>>>0,s=_>>>0,ot=V,_t=Q,V=z,Q=H,z=L,H=N,_=B+i,L=w+n+(_/4294967296>>>0)>>>0,N=_>>>0,w=b,B=R,b=m,R=E,m=d,E=y,_=i+s,d=n+o+(_/4294967296>>>0)>>>0,y=_>>>0;_=t[0][1]+y,t[0][0]=t[0][0]+d+(_/4294967296>>>0)>>>0,t[0][1]=_>>>0,_=t[1][1]+E,t[1][0]=t[1][0]+m+(_/4294967296>>>0)>>>0,t[1][1]=_>>>0,_=t[2][1]+R,t[2][0]=t[2][0]+b+(_/4294967296>>>0)>>>0,t[2][1]=_>>>0,_=t[3][1]+B,t[3][0]=t[3][0]+w+(_/4294967296>>>0)>>>0,t[3][1]=_>>>0,_=t[4][1]+N,t[4][0]=t[4][0]+L+(_/4294967296>>>0)>>>0,t[4][1]=_>>>0,_=t[5][1]+H,t[5][0]=t[5][0]+z+(_/4294967296>>>0)>>>0,t[5][1]=_>>>0,_=t[6][1]+Q,t[6][0]=t[6][0]+V+(_/4294967296>>>0)>>>0,t[6][1]=_>>>0,_=t[7][1]+_t,t[7][0]=t[7][0]+ot+(_/4294967296>>>0)>>>0,t[7][1]=_>>>0,F-=128}}});var Fp={};gt(Fp,{aes:()=>Ai,hmac:()=>on,keys:()=>Lo,pbkdf2:()=>No,randomBytes:()=>Er});var Ai={};gt(Ai,{create:()=>Ac});var zp=Symbol.for("@libp2p/connection");var Wp=Symbol.for("@libp2p/content-routing");var $p=Symbol.for("@libp2p/peer-discovery");var Xp=Symbol.for("@libp2p/peer-id");var jp=Symbol.for("@libp2p/peer-routing");var Fo;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})(Fo||(Fo={}));var nd=Symbol.for("@libp2p/transport");var Ho;(function(t){t[t.FATAL_ALL=0]="FATAL_ALL",t[t.NO_FATAL=1]="NO_FATAL"})(Ho||(Ho={}));var q=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var zn=class extends Event{detail;constructor(e,r){super(e,r),this.detail=r?.detail}},ad=globalThis.CustomEvent??zn;var zo={16:"aes-128-ctr",32:"aes-256-ctr"};function Go(t){if(t.length===16||t.length===32)return zo[t.length];let e=Object.entries(zo).map(([r,n])=>`${r} (${n})`).join(" / ");throw new q(`Invalid key length ${t.length} bytes. Must be ${e}`,"ERR_INVALID_KEY_LENGTH")}var q1=Nt(tn(),1),Rr=Nt(it(),1);function qe(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var ai={};gt(ai,{base10:()=>Sf});var Gd=new Uint8Array(0);function aa(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function de(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function sa(t){return new TextEncoder().encode(t)}function fa(t){return new TextDecoder().decode(t)}function vf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,f=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var d=0,y=0,m=0,E=l.length;m!==E&&l[m]===0;)m++,d++;for(var b=(E-m)*u+1>>>0,R=new Uint8Array(b);m!==E;){for(var w=l[m],B=0,L=b-1;(w!==0||B<y)&&L!==-1;L--,B++)w+=256*R[L]>>>0,R[L]=w%a>>>0,w=w/a>>>0;if(w!==0)throw new Error("Non-zero carry");y=B,m++}for(var N=b-y;N!==b&&R[N]===0;)N++;for(var z=f.repeat(d);N<b;++N)z+=t.charAt(R[N]);return z}function p(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var d=0;if(l[d]!==" "){for(var y=0,m=0;l[d]===f;)y++,d++;for(var E=(l.length-d)*c+1>>>0,b=new Uint8Array(E);l[d];){var R=r[l.charCodeAt(d)];if(R===255)return;for(var w=0,B=E-1;(R!==0||w<m)&&B!==-1;B--,w++)R+=a*b[B]>>>0,b[B]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");m=w,d++}if(l[d]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var N=new Uint8Array(y+(E-L)),z=y;L!==E;)N[z++]=b[L++];return N}}}function x(l){var d=p(l);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:x}}var bf=vf,Ef=bf,ua=Ef;var ri=class{name;prefix;baseEncode;constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ni=class{name;prefix;baseDecode;prefixCodePoint;constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ha(this,e)}},ii=class{decoders;constructor(e){this.decoders=e}or(e){return ha(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function ha(t,e){return new ii({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}var oi=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ri(e,r,n),this.decoder=new ni(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function ir({name:t,prefix:e,encode:r,decode:n}){return new oi(t,e,r,n)}function _e({name:t,prefix:e,alphabet:r}){let{encode:n,decode:i}=ua(r,t);return ir({prefix:e,name:t,encode:n,decode:o=>de(i(o))})}function wf(t,e,r,n){let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,f=0,c=0;for(let u=0;u<o;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,a+=r,a>=8&&(a-=8,s[c++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return s}function Bf(t,e,r){let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s!==0&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}function mt({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return ir({prefix:e,name:t,encode(i){return Bf(i,n,r)},decode(i){return wf(i,n,r,t)}})}var Sf=_e({prefix:"9",name:"base10",alphabet:"0123456789"});var si={};gt(si,{base16:()=>Af,base16upper:()=>Cf});var Af=mt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Cf=mt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var fi={};gt(fi,{base2:()=>If});var If=mt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ci={};gt(ci,{base256emoji:()=>Nf});var la=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Tf=la.reduce((t,e,r)=>(t[r]=e,t),[]),_f=la.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Rf(t){return t.reduce((e,r)=>(e+=Tf[r],e),"")}function Lf(t){let e=[];for(let r of t){let n=_f[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Nf=ir({prefix:"\u{1F680}",name:"base256emoji",encode:Rf,decode:Lf});var ui={};gt(ui,{base32:()=>or,base32hex:()=>Uf,base32hexpad:()=>Of,base32hexpadupper:()=>Mf,base32hexupper:()=>Kf,base32pad:()=>kf,base32padupper:()=>Pf,base32upper:()=>Df,base32z:()=>Vf});var or=mt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Df=mt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kf=mt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Pf=mt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Uf=mt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kf=mt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Of=mt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mf=mt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Vf=mt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var hi={};gt(hi,{base36:()=>qf,base36upper:()=>Ff});var qf=_e({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ff=_e({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var li={};gt(li,{base58btc:()=>Ft,base58flickr:()=>Hf});var Ft=_e({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Hf=_e({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var pi={};gt(pi,{base64:()=>Ar,base64pad:()=>zf,base64url:()=>Gf,base64urlpad:()=>Wf});var Ar=mt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zf=mt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Gf=mt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Wf=mt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var di={};gt(di,{base8:()=>Yf});var Yf=mt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var yi={};gt(yi,{identity:()=>Zf});var Zf=ir({prefix:"\0",name:"identity",encode:t=>fa(t),decode:t=>sa(t)});var s1=new TextEncoder,f1=new TextDecoder;var mi={};gt(mi,{identity:()=>gi});var Xf=ya,pa=128,Jf=127,jf=~Jf,tc=Math.pow(2,31);function ya(t,e,r){e=e||[],r=r||0;for(var n=r;t>=tc;)e[r++]=t&255|pa,t/=128;for(;t&jf;)e[r++]=t&255|pa,t>>>=7;return e[r]=t|0,ya.bytes=r-n+1,e}var ec=xi,rc=128,da=127;function xi(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw xi.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&da)<<i:(s&da)*Math.pow(2,i),i+=7}while(s>=rc);return xi.bytes=o-n,r}var nc=Math.pow(2,7),ic=Math.pow(2,14),oc=Math.pow(2,21),ac=Math.pow(2,28),sc=Math.pow(2,35),fc=Math.pow(2,42),cc=Math.pow(2,49),uc=Math.pow(2,56),hc=Math.pow(2,63),lc=function(t){return t<nc?1:t<ic?2:t<oc?3:t<ac?4:t<sc?5:t<fc?6:t<cc?7:t<uc?8:t<hc?9:10},pc={encode:Xf,decode:ec,encodingLength:lc},dc=pc,Cr=dc;function Ir(t,e=0){return[Cr.decode(t,e),Cr.decode.bytes]}function ar(t,e,r=0){return Cr.encode(t,e,r),e}function sr(t){return Cr.encodingLength(t)}function Fe(t,e){let r=e.byteLength,n=sr(t),i=n+sr(r),o=new Uint8Array(i+r);return ar(t,o,0),ar(r,o,n),o.set(e,i),new fr(t,r,e,o)}function xa(t){let e=de(t),[r,n]=Ir(e),[i,o]=Ir(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new fr(r,i,s,e)}function ga(t,e){if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&aa(t.bytes,r.bytes)}}var fr=class{code;size;digest;bytes;constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var ma=0,yc="identity",va=de;function xc(t){return Fe(ma,va(t))}var gi={code:ma,name:yc,encode:va,digest:xc};var Ei={};gt(Ei,{sha256:()=>Mt,sha512:()=>gc});function bi({name:t,code:e,encode:r}){return new vi(t,e,r)}var vi=class{name;code;encode;constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Fe(this.code,r):r.then(n=>Fe(this.code,n))}else throw Error("Unknown type, must be binary type")}};function Ea(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}var Mt=bi({name:"sha2-256",code:18,encode:Ea("SHA-256")}),gc=bi({name:"sha2-512",code:19,encode:Ea("SHA-512")});function wa(t,e){let{bytes:r,version:n}=t;switch(n){case 0:return vc(r,wi(t),e??Ft.encoder);default:return bc(r,wi(t),e??or.encoder)}}var Ba=new WeakMap;function wi(t){let e=Ba.get(t);if(e==null){let r=new Map;return Ba.set(t,r),r}return e}var rn=class t{code;version;multihash;bytes;"/";constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==_r)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Ec)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Fe(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n!=null&&e.code===n.code&&e.version===n.version&&ga(e.multihash,n.multihash)}toString(e){return wa(this,e)}toJSON(){return{"/":wa(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s??Sa(n,i,o.bytes))}else if(r[wc]===!0){let{version:n,multihash:i,code:o}=r,s=xa(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==_r)throw new Error(`Version 0 CID must use dag-pb (code: ${_r}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Sa(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,_r,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=de(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new fr(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Ir(e.subarray(r));return r+=p,h},i=n(),o=_r;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:o,multihashCode:a,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=mc(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return wi(o).set(n,e),o}};function mc(t,e){switch(t[0]){case"Q":{let r=e??Ft;return[Ft.prefix,r.decode(`${Ft.prefix}${t}`)]}case Ft.prefix:{let r=e??Ft;return[Ft.prefix,r.decode(t)]}case or.prefix:{let r=e??or;return[or.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}}function vc(t,e,r){let{prefix:n}=r;if(n!==Ft.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i}function bc(t,e,r){let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i}var _r=112,Ec=18;function Sa(t,e,r){let n=sr(t),i=n+sr(e),o=new Uint8Array(i+r.byteLength);return ar(t,o,0),ar(e,o,n),o.set(r,i),o}var wc=Symbol.for("@ipld/js-cid/CID");var Bi={...yi,...fi,...di,...ai,...si,...ui,...hi,...li,...pi,...ci},_1={...Ei,...mi};function ye(t=0){return globalThis.Buffer?.allocUnsafe!=null?qe(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ca(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Aa=Ca("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Si=Ca("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=ye(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Bc={utf8:Aa,"utf-8":Aa,hex:Bi.base16,latin1:Si,ascii:Si,binary:Si,...Bi},nn=Bc;function Bt(t,e="utf8"){let r=nn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?qe(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function yt(t,e="utf8"){let r=nn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Ia(t,e,r){let n=Rr.default.cipher.createCipher("AES-CTR",yt(e,"ascii"));return n.start({iv:yt(r,"ascii")}),{update:i=>(n.update(Rr.default.util.createBuffer(yt(i,"ascii"))),Bt(n.output.getBytes(),"ascii"))}}function Ta(t,e,r){let n=Rr.default.cipher.createDecipher("AES-CTR",yt(e,"ascii"));return n.start({iv:yt(r,"ascii")}),{update:i=>(n.update(Rr.default.util.createBuffer(yt(i,"ascii"))),Bt(n.output.getBytes(),"ascii"))}}function Ac(t,e){let r=Go(t),n=Ia(r,t,e),i=Ta(r,t,e);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}var on={};gt(on,{create:()=>Ci});var Et={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var _a={SHA1:20,SHA256:32,SHA512:64};var Cc={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Ic=async(t,e)=>{let r=await Et.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function Ci(t,e){let r=Cc[t],n=await Et.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return Ic(n,i)},length:_a[t]}}var Lo={};gt(Lo,{generateEphemeralKeyPair:()=>y0,generateKeyPair:()=>Up,generateKeyPairFromSeed:()=>Kp,importKey:()=>qp,keyStretcher:()=>m0,keysPBM:()=>vr,marshalPrivateKey:()=>Vp,marshalPublicKey:()=>Mp,supportedKeys:()=>le,unmarshalPrivateKey:()=>Y0,unmarshalPublicKey:()=>Op});var gg=Nt(Dr(),1),mg=Nt(Rs(),1);var Fn=Nt(it(),1);var xo={};gt(xo,{Ed25519PrivateKey:()=>Je,Ed25519PublicKey:()=>Fr,generateKeyPair:()=>ap,generateKeyPairFromSeed:()=>yo,unmarshalEd25519PrivateKey:()=>ip,unmarshalEd25519PublicKey:()=>op});function $t(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var my=Nt(bt(),1),vy=Nt(xn(),1),Ls=Nt(it(),1);function ue(t,e){if(globalThis.Buffer!=null)return qe(globalThis.Buffer.concat(t,e));e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=ye(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return qe(r)}function Qt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ue([new Uint8Array(e-r.length),r])}return yt(r,"base64url")}function Vt(t){let e=bn(t);return new Ls.default.jsbn.BigInteger(yt(e,"base16"),16)}function bn(t,e){let r=Bt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ue([new Uint8Array(e-r.length),r])}return r}function Gt(t){return t==null?!1:typeof t.then=="function"&&typeof t.catch=="function"&&typeof t.finally=="function"}function Ns(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Gh(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Oi(t,...e){if(!Gh(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Ds(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ns(t.outputLen),Ns(t.blockLen)}function hr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ks(t,e){Oi(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var En=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Ps(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}var wn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Xt=(t,e)=>t<<32-e|t>>>e,Wh=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Wh)throw new Error("Non little-endian hardware is not supported");function Mi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ur(t){if(typeof t=="string"&&(t=Mi(t)),!Ps(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Bn(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];if(!Ps(i))throw new Error("Uint8Array expected");e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}var lr=class{clone(){return this._cloneInto()}},Iy={}.toString;function Sn(t){let e=n=>t().update(Ur(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function pr(t=32){if(En&&typeof En.getRandomValues=="function")return En.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Yh(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),f=n?4:0,c=n?0:4;t.setUint32(e+f,s,n),t.setUint32(e+c,a,n)}var dr=class extends lr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=wn(this.buffer)}update(e){hr(this);let{view:r,buffer:n,blockLen:i}=this;e=Ur(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let f=wn(e);for(;i<=o-s;s+=i)this.process(f,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){hr(this),ks(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;Yh(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=wn(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var An=BigInt(4294967295),Vi=BigInt(32);function Us(t,e=!1){return e?{h:Number(t&An),l:Number(t>>Vi&An)}:{h:Number(t>>Vi&An)|0,l:Number(t&An)|0}}function Zh(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=Us(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var $h=(t,e)=>BigInt(t>>>0)<<Vi|BigInt(e>>>0),Qh=(t,e,r)=>t>>>r,Xh=(t,e,r)=>t<<32-r|e>>>r,Jh=(t,e,r)=>t>>>r|e<<32-r,jh=(t,e,r)=>t<<32-r|e>>>r,tl=(t,e,r)=>t<<64-r|e>>>r-32,el=(t,e,r)=>t>>>r-32|e<<64-r,rl=(t,e)=>e,nl=(t,e)=>t,il=(t,e,r)=>t<<r|e>>>32-r,ol=(t,e,r)=>e<<r|t>>>32-r,al=(t,e,r)=>e<<r-32|t>>>64-r,sl=(t,e,r)=>t<<r-32|e>>>64-r;function fl(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var cl=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),ul=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,hl=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),ll=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,pl=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),dl=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0;var yl={fromBig:Us,split:Zh,toBig:$h,shrSH:Qh,shrSL:Xh,rotrSH:Jh,rotrSL:jh,rotrBH:tl,rotrBL:el,rotr32H:rl,rotr32L:nl,rotlSH:il,rotlSL:ol,rotlBH:al,rotlBL:sl,add:fl,add3L:cl,add3H:ul,add4L:hl,add4H:ll,add5H:dl,add5L:pl},Y=yl;var[xl,gl]=Y.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ne=new Uint32Array(80),De=new Uint32Array(80),qi=class extends dr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:f,Eh:c,El:u,Fh:h,Fl:p,Gh:x,Gl:l,Hh:d,Hl:y}=this;return[e,r,n,i,o,s,a,f,c,u,h,p,x,l,d,y]}set(e,r,n,i,o,s,a,f,c,u,h,p,x,l,d,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=h|0,this.Fl=p|0,this.Gh=x|0,this.Gl=l|0,this.Hh=d|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)Ne[b]=e.getUint32(r),De[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let R=Ne[b-15]|0,w=De[b-15]|0,B=Y.rotrSH(R,w,1)^Y.rotrSH(R,w,8)^Y.shrSH(R,w,7),L=Y.rotrSL(R,w,1)^Y.rotrSL(R,w,8)^Y.shrSL(R,w,7),N=Ne[b-2]|0,z=De[b-2]|0,H=Y.rotrSH(N,z,19)^Y.rotrBH(N,z,61)^Y.shrSH(N,z,6),V=Y.rotrSL(N,z,19)^Y.rotrBL(N,z,61)^Y.shrSL(N,z,6),Q=Y.add4L(L,V,De[b-7],De[b-16]),ot=Y.add4H(Q,B,H,Ne[b-7],Ne[b-16]);Ne[b]=ot|0,De[b]=Q|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:f,Dh:c,Dl:u,Eh:h,El:p,Fh:x,Fl:l,Gh:d,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let R=Y.rotrSH(h,p,14)^Y.rotrSH(h,p,18)^Y.rotrBH(h,p,41),w=Y.rotrSL(h,p,14)^Y.rotrSL(h,p,18)^Y.rotrBL(h,p,41),B=h&x^~h&d,L=p&l^~p&y,N=Y.add5L(E,w,L,gl[b],De[b]),z=Y.add5H(N,m,R,B,xl[b],Ne[b]),H=N|0,V=Y.rotrSH(n,i,28)^Y.rotrBH(n,i,34)^Y.rotrBH(n,i,39),Q=Y.rotrSL(n,i,28)^Y.rotrBL(n,i,34)^Y.rotrBL(n,i,39),ot=n&o^n&a^o&a,_t=i&s^i&f^s&f;m=d|0,E=y|0,d=x|0,y=l|0,x=h|0,l=p|0,{h,l:p}=Y.add(c|0,u|0,z|0,H|0),c=a|0,u=f|0,a=o|0,f=s|0,o=n|0,s=i|0;let I=Y.add3L(H,Q,_t);n=Y.add3H(I,z,V,ot),i=I|0}({h:n,l:i}=Y.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=Y.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:f}=Y.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=Y.add(this.Dh|0,this.Dl|0,c|0,u|0),{h,l:p}=Y.add(this.Eh|0,this.El|0,h|0,p|0),{h:x,l}=Y.add(this.Fh|0,this.Fl|0,x|0,l|0),{h:d,l:y}=Y.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:m,l:E}=Y.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,o,s,a,f,c,u,h,p,x,l,d,y,m,E)}roundClean(){Ne.fill(0),De.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Fi=Sn(()=>new qi);var In={};gt(In,{bitGet:()=>Sl,bitLen:()=>Bl,bitMask:()=>Kr,bitSet:()=>Al,bytesToHex:()=>be,bytesToNumberBE:()=>Ee,bytesToNumberLE:()=>ke,concatBytes:()=>we,createHmacDrbg:()=>Gi,ensureBytes:()=>vt,equalBytes:()=>El,hexToBytes:()=>Ye,hexToNumber:()=>zi,isBytes:()=>Jt,numberToBytesBE:()=>Pe,numberToBytesLE:()=>Ze,numberToHexUnpadded:()=>Vs,numberToVarBytesBE:()=>bl,utf8ToBytes:()=>wl,validateObject:()=>he});var Ms=BigInt(0),Cn=BigInt(1),ml=BigInt(2);function Jt(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}var vl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function be(t){if(!Jt(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=vl[t[r]];return e}function Vs(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function zi(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}var ve={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Ks(t){if(t>=ve._0&&t<=ve._9)return t-ve._0;if(t>=ve._A&&t<=ve._F)return t-(ve._A-10);if(t>=ve._a&&t<=ve._f)return t-(ve._a-10)}function Ye(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let s=Ks(t.charCodeAt(o)),a=Ks(t.charCodeAt(o+1));if(s===void 0||a===void 0){let f=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+o)}n[i]=s*16+a}return n}function Ee(t){return zi(be(t))}function ke(t){if(!Jt(t))throw new Error("Uint8Array expected");return zi(be(Uint8Array.from(t).reverse()))}function Pe(t,e){return Ye(t.toString(16).padStart(e*2,"0"))}function Ze(t,e){return Pe(t,e).reverse()}function bl(t){return Ye(Vs(t))}function vt(t,e,r){let n;if(typeof e=="string")try{n=Ye(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(Jt(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function we(...t){let e=0;for(let i=0;i<t.length;i++){let o=t[i];if(!Jt(o))throw new Error("Uint8Array expected");e+=o.length}let r=new Uint8Array(e),n=0;for(let i=0;i<t.length;i++){let o=t[i];r.set(o,n),n+=o.length}return r}function El(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function wl(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Bl(t){let e;for(e=0;t>Ms;t>>=Cn,e+=1);return e}function Sl(t,e){return t>>BigInt(e)&Cn}var Al=(t,e,r)=>t|(r?Cn:Ms)<<BigInt(e),Kr=t=>(ml<<BigInt(t-1))-Cn,Hi=t=>new Uint8Array(t),Os=t=>Uint8Array.from(t);function Gi(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Hi(t),i=Hi(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...h)=>r(i,n,...h),f=(h=Hi())=>{i=a(Os([0]),h),n=a(),h.length!==0&&(i=a(Os([1]),h),n=a())},c=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,p=[];for(;h<e;){n=a();let x=n.slice();p.push(x),h+=n.length}return we(...p)};return(h,p)=>{s(),f(h);let x;for(;!(x=p(c()));)f();return s(),x}}var Cl={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Jt(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function he(t,e,r={}){let n=(i,o,s)=>{let a=Cl[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let f=t[i];if(!(s&&f===void 0)&&!a(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var At=BigInt(0),pt=BigInt(1),$e=BigInt(2),Il=BigInt(3),Wi=BigInt(4),qs=BigInt(5),Fs=BigInt(8),Tl=BigInt(9),_l=BigInt(16);function at(t,e){let r=t%e;return r>=At?r:e+r}function Rl(t,e,r){if(r<=At||e<At)throw new Error("Expected power/modulo > 0");if(r===pt)return At;let n=pt;for(;e>At;)e&pt&&(n=n*t%r),t=t*t%r,e>>=pt;return n}function dt(t,e,r){let n=t;for(;e-- >At;)n*=n,n%=r;return n}function Tn(t,e){if(t===At||e<=At)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=at(t,e),n=e,i=At,o=pt,s=pt,a=At;for(;r!==At;){let c=n/r,u=n%r,h=i-s*c,p=o-a*c;n=r,r=u,i=s,o=a,s=h,a=p}if(n!==pt)throw new Error("invert: does not exist");return at(i,e)}function Ll(t){let e=(t-pt)/$e,r,n,i;for(r=t-pt,n=0;r%$e===At;r/=$e,n++);for(i=$e;i<t&&Rl(i,e,t)!==t-pt;i++);if(n===1){let s=(t+pt)/Wi;return function(f,c){let u=f.pow(c,s);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let o=(r+pt)/$e;return function(a,f){if(a.pow(f,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let c=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(f,o),p=a.pow(f,r);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let x=1;for(let d=a.sqr(p);x<c&&!a.eql(d,a.ONE);x++)d=a.sqr(d);let l=a.pow(u,pt<<BigInt(c-x-1));u=a.sqr(l),h=a.mul(h,l),p=a.mul(p,u),c=x}return h}}function Nl(t){if(t%Wi===Il){let e=(t+pt)/Wi;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%Fs===qs){let e=(t-qs)/Fs;return function(n,i){let o=n.mul(i,$e),s=n.pow(o,e),a=n.mul(i,s),f=n.mul(n.mul(a,$e),s),c=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%_l,Ll(t)}var Hs=(t,e)=>(at(t,e)&pt)===pt,Dl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Yi(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Dl.reduce((n,i)=>(n[i]="function",n),e);return he(t,r)}function kl(t,e,r){if(r<At)throw new Error("Expected power > 0");if(r===At)return t.ONE;if(r===pt)return e;let n=t.ONE,i=e;for(;r>At;)r&pt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=pt;return n}function Pl(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function Zi(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function _n(t,e,r=!1,n={}){if(t<=At)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=Zi(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=Nl(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:Kr(i),ZERO:At,ONE:pt,create:f=>at(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return At<=f&&f<t},is0:f=>f===At,isOdd:f=>(f&pt)===pt,neg:f=>at(-f,t),eql:(f,c)=>f===c,sqr:f=>at(f*f,t),add:(f,c)=>at(f+c,t),sub:(f,c)=>at(f-c,t),mul:(f,c)=>at(f*c,t),pow:(f,c)=>kl(a,f,c),div:(f,c)=>at(f*Tn(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>Tn(f,t),sqrt:n.sqrt||(f=>s(a,f)),invertBatch:f=>Pl(a,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?Ze(f,o):Pe(f,o),fromBytes:f=>{if(f.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${f.length}`);return r?ke(f):Ee(f)}});return Object.freeze(a)}function zs(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function Gs(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function $i(t){let e=Gs(t);return e+Math.ceil(e/2)}function Ws(t,e,r=!1){let n=t.length,i=Gs(e),o=$i(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=r?Ee(t):ke(t),a=at(s,e-pt)+pt;return r?Ze(a,i):Pe(a,i)}var Kl=BigInt(0),Qi=BigInt(1);function Rn(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>Kl;)o&Qi&&(s=s.add(a)),a=a.double(),o>>=Qi;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),f=[],c=i,u=c;for(let h=0;h<s;h++){u=c,f.push(u);for(let p=1;p<a;p++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,o,s){let{windows:a,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,h=BigInt(2**i-1),p=2**i,x=BigInt(i);for(let l=0;l<a;l++){let d=l*f,y=Number(s&h);s>>=x,y>f&&(y-=p,s+=Qi);let m=d,E=d+Math.abs(y)-1,b=l%2!==0,R=y<0;y===0?u=u.add(r(b,o[m])):c=c.add(r(R,o[E]))}return{p:c,f:u}},wNAFCached(i,o,s,a){let f=i._WINDOW_SIZE||1,c=o.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&o.set(i,a(c))),this.wNAF(f,c,s)}}}function Or(t){return Yi(t.Fp),he(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Zi(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var jt=BigInt(0),qt=BigInt(1),Ln=BigInt(2),Ol=BigInt(8),Ml={zip215:!0};function Vl(t){let e=Or(t);return he(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Nn(t){let e=Vl(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:f}=e,c=Ln<<BigInt(a*8)-qt,u=r.create,h=e.uvRatio||((D,A)=>{try{return{isValid:!0,value:r.sqrt(D*r.inv(A))}}catch{return{isValid:!1,value:jt}}}),p=e.adjustScalarBytes||(D=>D),x=e.domain||((D,A,K)=>{if(A.length||K)throw new Error("Contexts/pre-hash are not supported");return D}),l=D=>typeof D=="bigint"&&jt<D,d=(D,A)=>l(D)&&l(A)&&D<A,y=D=>D===jt||d(D,c);function m(D,A){if(d(D,A))return D;throw new Error(`Expected valid scalar < ${A}, got ${typeof D} ${D}`)}function E(D){return D===jt?D:m(D,n)}let b=new Map;function R(D){if(!(D instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,K,O,F){if(this.ex=A,this.ey=K,this.ez=O,this.et=F,!y(A))throw new Error("x required");if(!y(K))throw new Error("y required");if(!y(O))throw new Error("z required");if(!y(F))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:K,y:O}=A||{};if(!y(K)||!y(O))throw new Error("invalid affine point");return new w(K,O,qt,u(K*O))}static normalizeZ(A){let K=r.invertBatch(A.map(O=>O.ez));return A.map((O,F)=>O.toAffine(K[F])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:K}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:F,ez:Z,et:X}=this,nt=u(O*O),J=u(F*F),et=u(Z*Z),wt=u(et*et),xt=u(nt*A),Rt=u(et*u(xt+J)),Lt=u(wt+u(K*u(nt*J)));if(Rt!==Lt)throw new Error("bad point: equation left != right (1)");let St=u(O*F),Dt=u(Z*X);if(St!==Dt)throw new Error("bad point: equation left != right (2)")}equals(A){R(A);let{ex:K,ey:O,ez:F}=this,{ex:Z,ey:X,ez:nt}=A,J=u(K*nt),et=u(Z*F),wt=u(O*nt),xt=u(X*F);return J===et&&wt===xt}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:K,ey:O,ez:F}=this,Z=u(K*K),X=u(O*O),nt=u(Ln*u(F*F)),J=u(A*Z),et=K+O,wt=u(u(et*et)-Z-X),xt=J+X,Rt=xt-nt,Lt=J-X,St=u(wt*Rt),Dt=u(xt*Lt),pe=u(wt*Lt),Me=u(Rt*xt);return new w(St,Dt,Me,pe)}add(A){R(A);let{a:K,d:O}=e,{ex:F,ey:Z,ez:X,et:nt}=this,{ex:J,ey:et,ez:wt,et:xt}=A;if(K===BigInt(-1)){let ko=u((Z-F)*(et+J)),Po=u((Z+F)*(et-J)),Hn=u(Po-ko);if(Hn===jt)return this.double();let Uo=u(X*Ln*xt),Ko=u(nt*Ln*wt),Oo=Ko+Uo,Mo=Po+ko,Vo=Ko-Uo,ef=u(Oo*Hn),rf=u(Mo*Vo),nf=u(Oo*Vo),of=u(Hn*Mo);return new w(ef,rf,of,nf)}let Rt=u(F*J),Lt=u(Z*et),St=u(nt*O*xt),Dt=u(X*wt),pe=u((F+Z)*(J+et)-Rt-Lt),Me=Dt-St,Br=Dt+St,Do=u(Lt-K*Rt),X0=u(pe*Me),J0=u(Br*Do),j0=u(pe*Do),tf=u(Me*Br);return new w(X0,J0,tf,j0)}subtract(A){return this.add(A.negate())}wNAF(A){return N.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:K,f:O}=this.wNAF(m(A,n));return w.normalizeZ([K,O])[0]}multiplyUnsafe(A){let K=E(A);return K===jt?L:this.equals(L)||K===qt?this:this.equals(B)?this.wNAF(K).p:N.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return N.unsafeLadder(this,n).is0()}toAffine(A){let{ex:K,ey:O,ez:F}=this,Z=this.is0();A==null&&(A=Z?Ol:r.inv(F));let X=u(K*A),nt=u(O*A),J=u(F*A);if(Z)return{x:jt,y:qt};if(J!==qt)throw new Error("invZ was invalid");return{x:X,y:nt}}clearCofactor(){let{h:A}=e;return A===qt?this:this.multiplyUnsafe(A)}static fromHex(A,K=!1){let{d:O,a:F}=e,Z=r.BYTES;A=vt("pointHex",A,Z);let X=A.slice(),nt=A[Z-1];X[Z-1]=nt&-129;let J=ke(X);J===jt||(K?m(J,c):m(J,r.ORDER));let et=u(J*J),wt=u(et-qt),xt=u(O*et-F),{isValid:Rt,value:Lt}=h(wt,xt);if(!Rt)throw new Error("Point.fromHex: invalid y coordinate");let St=(Lt&qt)===qt,Dt=(nt&128)!==0;if(!K&&Lt===jt&&Dt)throw new Error("Point.fromHex: x=0 and x_0=1");return Dt!==St&&(Lt=u(-Lt)),w.fromAffine({x:Lt,y:J})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:K}=this.toAffine(),O=Ze(K,r.BYTES);return O[O.length-1]|=A&qt?128:0,O}toHex(){return be(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,qt,u(e.Gx*e.Gy)),w.ZERO=new w(jt,qt,qt,jt);let{BASE:B,ZERO:L}=w,N=Rn(w,a*8);function z(D){return at(D,n)}function H(D){return z(ke(D))}function V(D){let A=a;D=vt("private key",D,A);let K=vt("hashed private key",o(D),2*A),O=p(K.slice(0,A)),F=K.slice(A,2*A),Z=H(O),X=B.multiply(Z),nt=X.toRawBytes();return{head:O,prefix:F,scalar:Z,point:X,pointBytes:nt}}function Q(D){return V(D).pointBytes}function ot(D=new Uint8Array,...A){let K=we(...A);return H(o(x(K,vt("context",D),!!i)))}function _t(D,A,K={}){D=vt("message",D),i&&(D=i(D));let{prefix:O,scalar:F,pointBytes:Z}=V(A),X=ot(K.context,O,D),nt=B.multiply(X).toRawBytes(),J=ot(K.context,nt,Z,D),et=z(X+J*F);E(et);let wt=we(nt,Ze(et,r.BYTES));return vt("result",wt,a*2)}let I=Ml;function k(D,A,K,O=I){let{context:F,zip215:Z}=O,X=r.BYTES;D=vt("signature",D,2*X),A=vt("message",A),i&&(A=i(A));let nt=ke(D.slice(X,2*X)),J,et,wt;try{J=w.fromHex(K,Z),et=w.fromHex(D.slice(0,X),Z),wt=B.multiplyUnsafe(nt)}catch{return!1}if(!Z&&J.isSmallOrder())return!1;let xt=ot(F,et.toRawBytes(),J.toRawBytes(),A);return et.add(J.multiplyUnsafe(xt)).subtract(wt).clearCofactor().equals(w.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:Q,sign:_t,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(D=8,A=w.BASE){return A._setWindowSize(D),A.multiply(BigInt(3)),A}}}}var Ji=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ys=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),$y=BigInt(0),ql=BigInt(1),Xi=BigInt(2),Fl=BigInt(5),Zs=BigInt(10),Hl=BigInt(20),zl=BigInt(40),$s=BigInt(80);function Gl(t){let e=Ji,n=t*t%e*t%e,i=dt(n,Xi,e)*n%e,o=dt(i,ql,e)*t%e,s=dt(o,Fl,e)*o%e,a=dt(s,Zs,e)*s%e,f=dt(a,Hl,e)*a%e,c=dt(f,zl,e)*f%e,u=dt(c,$s,e)*c%e,h=dt(u,$s,e)*c%e,p=dt(h,Zs,e)*s%e;return{pow_p_5_8:dt(p,Xi,e)*t%e,b2:n}}function Wl(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Yl(t,e){let r=Ji,n=at(e*e*e,r),i=at(n*n*e,r),o=Gl(t*i).pow_p_5_8,s=at(t*n*o,r),a=at(e*s*s,r),f=s,c=at(s*Ys,r),u=a===t,h=a===at(-t,r),p=a===at(-t*Ys,r);return u&&(s=f),(h||p)&&(s=c),Hs(s,r)&&(s=at(-s,r)),{isValid:u||h,value:s}}var Be=_n(Ji,void 0,!0),ji={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Be,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Fi,randomBytes:pr,adjustScalarBytes:Wl,uvRatio:Yl},yr=Nn(ji);function Qs(t,e,r){if(e.length>255)throw new Error("Context is too big");return Bn(Mi("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var Qy=Nn({...ji,domain:Qs}),Xy=Nn({...ji,domain:Qs,prehash:Fi});var Zl=(Be.ORDER+BigInt(3))/BigInt(8),Jy=Be.pow(Xi,Zl),jy=Be.sqrt(Be.neg(Be.ONE)),t2=(Be.ORDER-BigInt(5))/BigInt(8),e2=BigInt(486662);var r2=zs(Be,Be.neg(BigInt(486664)));var n2=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),i2=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),o2=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),a2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var s2=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var xr=32,Se=64,Dn=32;function Xs(){let t=yr.utils.randomPrivateKey(),e=yr.getPublicKey(t);return{privateKey:e0(t,e),publicKey:e}}function Js(t){if(t.length!==Dn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=yr.getPublicKey(e);return{privateKey:e0(e,r),publicKey:r}}function js(t,e){let r=t.subarray(0,Dn);return yr.sign(e instanceof Uint8Array?e:e.subarray(),r)}function t0(t,e,r){return yr.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}function e0(t,e){let r=new Uint8Array(Se);for(let n=0;n<Dn;n++)r[n]=t[n],r[Dn+n]=e[n];return r}var to={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function kn(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=Et.get();r*=8;async function f(h,p){let x=a.getRandomValues(new Uint8Array(o)),l=a.getRandomValues(new Uint8Array(n)),d={name:e,iv:l};typeof p=="string"&&(p=Bt(p));let y;if(p.length===0){y=await a.subtle.importKey("jwk",to,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",to,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(d,y,h);return ue([x,d.iv,new Uint8Array(m)])}async function c(h,p){let x=h.subarray(0,o),l=h.subarray(o,o+n),d=h.subarray(o+n),y={name:e,iv:l};typeof p=="string"&&(p=Bt(p));let m;if(p.length===0)try{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",to,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(y,m,d);return new Uint8Array(E)}return{encrypt:f,decrypt:c}}async function gr(t,e){let n=await kn().encrypt(t,e);return Ar.encode(n)}var vr={};gt(vr,{KeyType:()=>ut,PrivateKey:()=>re,PublicKey:()=>ee});var eo=new Float32Array([-0]),Ue=new Uint8Array(eo.buffer);function n0(t,e,r){eo[0]=t,e[r]=Ue[0],e[r+1]=Ue[1],e[r+2]=Ue[2],e[r+3]=Ue[3]}function i0(t,e){return Ue[0]=t[e],Ue[1]=t[e+1],Ue[2]=t[e+2],Ue[3]=t[e+3],eo[0]}var ro=new Float64Array([-0]),kt=new Uint8Array(ro.buffer);function o0(t,e,r){ro[0]=t,e[r]=kt[0],e[r+1]=kt[1],e[r+2]=kt[2],e[r+3]=kt[3],e[r+4]=kt[4],e[r+5]=kt[5],e[r+6]=kt[6],e[r+7]=kt[7]}function a0(t,e){return kt[0]=t[e],kt[1]=t[e+1],kt[2]=t[e+2],kt[3]=t[e+3],kt[4]=t[e+4],kt[5]=t[e+5],kt[6]=t[e+6],kt[7]=t[e+7],ro[0]}var Ql=BigInt(Number.MAX_SAFE_INTEGER),Xl=BigInt(Number.MIN_SAFE_INTEGER),Ot=class t{lo;hi;constructor(e,r){this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){let e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){let e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){let e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return Qe;if(e<Ql&&e>Xl)return this.fromNumber(Number(e));let r=e<0n;r&&(e=-e);let n=e>>32n,i=e-(n<<32n);return r&&(n=~n|0n,i=~i|0n,++i>s0&&(i=0n,++n>s0&&(n=0n))),new t(Number(i),Number(n))}static fromNumber(e){if(e===0)return Qe;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new t(n,i)}static from(e){return typeof e=="number"?t.fromNumber(e):typeof e=="bigint"?t.fromBigInt(e):typeof e=="string"?t.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new t(e.low>>>0,e.high>>>0):Qe}},Qe=new Ot(0,0);Qe.toBigInt=function(){return 0n};Qe.zzEncode=Qe.zzDecode=function(){return this};Qe.length=function(){return 1};var s0=4294967296n;function f0(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function c0(t,e,r){if(r-e<1)return"";let i,o=[],s=0,a;for(;e<r;)a=t[e++],a<128?o[s++]=a:a>191&&a<224?o[s++]=(a&31)<<6|t[e++]&63:a>239&&a<365?(a=((a&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,o[s++]=55296+(a>>10),o[s++]=56320+(a&1023)):o[s++]=(a&15)<<12|(t[e++]&63)<<6|t[e++]&63,s>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i!=null?(s>0&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))}function no(t,e,r){let n=r,i,o;for(let s=0;s<t.length;++s)i=t.charCodeAt(s),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&((o=t.charCodeAt(s+1))&64512)===56320?(i=65536+((i&1023)<<10)+(o&1023),++s,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128);return r-n}function te(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function Pn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}var io=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,te(this,10);return e}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw te(this,4);return Pn(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw te(this,4);return Pn(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw te(this,4);let e=i0(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw te(this,4);let e=a0(this.buf,this.pos);return this.pos+=8,e}bytes(){let e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw te(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let e=this.bytes();return c0(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw te(this,e);this.pos+=e}else do if(this.pos>=this.len)throw te(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){let e=new Ot(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw te(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw te(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw te(this,8);let e=Pn(this.buf,this.pos+=4),r=Pn(this.buf,this.pos+=4);return new Ot(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function oo(t){return new io(t instanceof Uint8Array?t:t.subarray())}function Un(t,e){let r=oo(t);return e.decode(r)}function ao(t){let e=t??8192,r=e>>>1,n,i=e;return function(s){if(s<1||s>r)return ye(s);i+s>e&&(n=ye(e),i=0);let a=n.subarray(i,i+=s);return i&7&&(i=(i|7)+1),a}}var Xe=class{fn;len;next;val;constructor(e,r,n){this.fn=e,this.len=r,this.next=void 0,this.val=n}};function so(){}var co=class{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}},Jl=ao();function jl(t){return globalThis.Buffer!=null?ye(t):Jl(t)}var qr=class{len;head;tail;states;constructor(){this.len=0,this.head=new Xe(so,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new Xe(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new uo((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(Mr,10,Ot.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){let r=Ot.fromBigInt(e);return this._push(Mr,r.length(),r)}uint64Number(e){let r=Ot.fromNumber(e);return this._push(Mr,r.length(),r)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){let r=Ot.fromBigInt(e).zzEncode();return this._push(Mr,r.length(),r)}sint64Number(e){let r=Ot.fromNumber(e).zzEncode();return this._push(Mr,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(fo,1,e?1:0)}fixed32(e){return this._push(Vr,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){let r=Ot.fromBigInt(e);return this._push(Vr,4,r.lo)._push(Vr,4,r.hi)}fixed64Number(e){let r=Ot.fromNumber(e);return this._push(Vr,4,r.lo)._push(Vr,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(n0,4,e)}double(e){return this._push(o0,8,e)}bytes(e){let r=e.length>>>0;return r===0?this._push(fo,1,0):this.uint32(r)._push(ep,r,e)}string(e){let r=f0(e);return r!==0?this.uint32(r)._push(no,r,e):this._push(fo,1,0)}fork(){return this.states=new co(this),this.head=this.tail=new Xe(so,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Xe(so,0,0),this.len=0),this}ldelim(){let e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next,r=jl(this.len),n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}};function fo(t,e,r){e[r]=t&255}function tp(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}var uo=class extends Xe{next;constructor(e,r){super(tp,e,r),this.next=void 0}};function Mr(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Vr(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function ep(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&(qr.prototype.bytes=function(t){let e=t.length>>>0;return this.uint32(e),e>0&&this._push(rp,e,t),this},qr.prototype.string=function(t){let e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(np,e,t),this});function rp(t,e,r){e.set(t,r)}function np(t,e,r){t.length<40?no(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(Bt(t),r)}function ho(){return new qr}function Kn(t,e){let r=ho();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var mr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(mr||(mr={}));function On(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function lo(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return On("enum",mr.VARINT,r,n)}function Mn(t,e){return On("message",mr.LENGTH_DELIMITED,t,e)}var ut;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(ut||(ut={}));var po;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(po||(po={}));(function(t){t.codec=()=>lo(po)})(ut||(ut={}));var ee;(function(t){let e;t.codec=()=>(e==null&&(e=Mn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=ut.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Kn(r,t.codec()),t.decode=r=>Un(r,t.codec())})(ee||(ee={}));var re;(function(t){let e;t.codec=()=>(e==null&&(e=Mn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=ut.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Kn(r,t.codec()),t.decode=r=>Un(r,t.codec())})(re||(re={}));var Fr=class{_key;constructor(e){this._key=br(e,xr)}verify(e,r){return t0(this._key,r,e)}marshal(){return this._key}get bytes(){return ee.encode({Type:ut.Ed25519,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}},Je=class{_key;_publicKey;constructor(e,r){this._key=br(e,Se),this._publicKey=br(r,xr)}sign(e){return js(this._key,e)}get public(){return new Fr(this._publicKey)}marshal(){return this._key}get bytes(){return re.encode({Type:ut.Ed25519,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}async hash(){let e=Mt.digest(this.bytes),r;return Gt(e)?{bytes:r}=await e:r=e.bytes,r}async id(){let e=gi.digest(this.public.bytes);return Ft.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return gr(this.bytes,e);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function ip(t){if(t.length>Se){t=br(t,Se+xr);let n=t.subarray(0,Se),i=t.subarray(Se,t.length);return new Je(n,i)}t=br(t,Se);let e=t.subarray(0,Se),r=t.subarray(xr);return new Je(e,r)}function op(t){return t=br(t,xr),new Fr(t)}async function ap(){let{privateKey:t,publicKey:e}=Xs();return new Je(t,e)}async function yo(t){let{privateKey:e,publicKey:r}=Js(t);return new Je(e,r)}function br(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new q(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var h0={"P-256":256,"P-384":384,"P-521":521},sp=Object.keys(h0),go=sp.join(" / ");async function l0(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new q(`Unknown curve: ${t}. Must be ${go}`,"ERR_INVALID_CURVE");let e=await Et.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(o,s)=>{let a;s!=null?a=await Et.get().subtle.importKey("jwk",cp(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):a=e.privateKey;let f=await Et.get().subtle.importKey("jwk",d0(t,o),{name:"ECDH",namedCurve:t},!1,[]),c=await Et.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:f},a,h0[t]);return new Uint8Array(c,0,c.byteLength)},n=await Et.get().subtle.exportKey("jwk",e.publicKey);return{key:fp(n),genSharedKey:r}}var p0={"P-256":32,"P-384":48,"P-521":66};function fp(t){if(t.crv==null||t.x==null||t.y==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw new q(`Unknown curve: ${t.crv}. Must be ${go}`,"ERR_INVALID_CURVE");let e=p0[t.crv];return ue([Uint8Array.from([4]),bn(t.x,e),bn(t.y,e)],1+e*2)}function d0(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new q(`Unknown curve: ${t}. Must be ${go}`,"ERR_INVALID_CURVE");let r=p0[t];if(!$t(e.subarray(0,1),Uint8Array.from([4])))throw new q("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:yt(e.subarray(1,r+1),"base64url"),y:yt(e.subarray(1+r),"base64url"),ext:!0}}var cp=(t,e)=>({...d0(t,e.public),d:yt(e.private,"base64url")});var y0=l0;async function x0(t,e){let r=Ar.decode(t);return kn().decrypt(r,e)}var g0={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function m0(t,e,r){let n=g0[t];if(n==null){let E=Object.keys(g0).join(" / ");throw new q(`unknown cipher type '${t}'. Must be ${E}`,"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw new q("missing hash type","ERR_MISSING_HASH_TYPE");let i=n.keySize,o=n.ivSize,s=20,a=Bt("key expansion"),f=2*(o+i+s),c=await Ci(e,r),u=await c.digest(a),h=[],p=0;for(;p<f;){let E=await c.digest(ue([u,a])),b=E.length;p+b>f&&(b=f-p),h.push(E),p+=b,u=await c.digest(u)}let x=f/2,l=ue(h),d=l.subarray(0,x),y=l.subarray(x,f),m=E=>({iv:E.subarray(0,o),cipherKey:E.subarray(o,o+i),macKey:E.subarray(o+i)});return{k1:m(d),k2:m(y)}}var wo={};gt(wo,{MAX_KEY_SIZE:()=>Wr,RsaPrivateKey:()=>wr,RsaPublicKey:()=>Gr,fromJwk:()=>vp,generateKeyPair:()=>bp,unmarshalRsaPrivateKey:()=>gp,unmarshalRsaPublicKey:()=>mp});var zr=Nt(it(),1);var Px=Nt(B0(),1);function Er(t){if(isNaN(t)||t<=0)throw new q("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return pr(t)}var gx=Nt(vn(),1),bo=Nt(it(),1);function S0(t,e){return e.map(r=>Vt(t[r]))}function A0(t){return bo.default.pki.setRsaPrivateKey(...S0(t,["n","e","d","p","q","dp","dq","qi"]))}function C0(t){return bo.default.pki.setRsaPublicKey(...S0(t,["n","e"]))}var tr={};gt(tr,{jwkToPkcs1:()=>lp,jwkToPkix:()=>dp,pkcs1ToJwk:()=>hp,pkixToJwk:()=>pp});var bx=Nt(Dr(),1),Ex=Nt(vn(),1);var Ae=Nt(it(),1);function hp(t){let e=Ae.default.asn1.fromDer(yt(t,"ascii")),r=Ae.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Qt(r.n),e:Qt(r.e),d:Qt(r.d),p:Qt(r.p),q:Qt(r.q),dp:Qt(r.dP),dq:Qt(r.dQ),qi:Qt(r.qInv),alg:"RS256"}}function lp(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ae.default.pki.privateKeyToAsn1({n:Vt(t.n),e:Vt(t.e),d:Vt(t.d),p:Vt(t.p),q:Vt(t.q),dP:Vt(t.dp),dQ:Vt(t.dq),qInv:Vt(t.qi)});return Bt(Ae.default.asn1.toDer(e).getBytes(),"ascii")}function pp(t){let e=Ae.default.asn1.fromDer(yt(t,"ascii")),r=Ae.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Qt(r.n),e:Qt(r.e)}}function dp(t){if(t.n==null||t.e==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ae.default.pki.publicKeyToAsn1({n:Vt(t.n),e:Vt(t.e)});return Bt(Ae.default.asn1.toDer(e).getBytes(),"ascii")}async function I0(t){let e=await Et.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await R0(e);return{privateKey:r[0],publicKey:r[1]}}async function Eo(t){let r=[await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await yp(t)],n=await R0({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function T0(t,e){let r=await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Et.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(n,0,n.byteLength)}async function _0(t,e,r){let n=await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Et.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}async function R0(t){if(t.privateKey==null||t.publicKey==null)throw new q("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Et.get().subtle.exportKey("jwk",t.privateKey),Et.get().subtle.exportKey("jwk",t.publicKey)])}async function yp(t){return Et.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function L0(t,e,r,n){let i=e?C0(t):A0(t),o=yt(r instanceof Uint8Array?r:r.subarray(),"ascii"),s=n(o,i);return Bt(s,"ascii")}function N0(t,e){return L0(t,!0,e,(r,n)=>n.encrypt(r))}function D0(t,e){return L0(t,!1,e,(r,n)=>n.decrypt(r))}function Vn(t){if(t.kty!=="RSA")throw new q("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new q("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Bt(t.n,"base64url").length*8}var Wr=8192,Gr=class{_key;constructor(e){this._key=e}verify(e,r){return _0(this._key,r,e)}marshal(){return tr.jwkToPkix(this._key)}get bytes(){return ee.encode({Type:ut.RSA,Data:this.marshal()}).subarray()}encrypt(e){return N0(this._key,e)}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}},wr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Er(16)}sign(e){return T0(this._key,e)}get public(){if(this._publicKey==null)throw new q("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Gr(this._publicKey)}decrypt(e){return D0(this._key,e)}marshal(){return tr.jwkToPkcs1(this._key)}get bytes(){return re.encode({Type:ut.RSA,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}async id(){let e=await this.public.hash();return yt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new zr.default.util.ByteBuffer(this.marshal()),i=zr.default.asn1.fromDer(n),o=zr.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return zr.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return gr(this.bytes,e);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function gp(t){let e=tr.pkcs1ToJwk(t);if(Vn(e)>Wr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Eo(e);return new wr(r.privateKey,r.publicKey)}function mp(t){let e=tr.pkixToJwk(t);if(Vn(e)>Wr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Gr(e)}async function vp(t){if(Vn(t)>Wr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Eo(t);return new wr(e.privateKey,e.publicKey)}async function bp(t){if(t>Wr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await I0(t);return new wr(e.privateKey,e.publicKey)}var To={};gt(To,{Secp256k1PrivateKey:()=>Zr,Secp256k1PublicKey:()=>Yr,generateKeyPair:()=>Pp,unmarshalSecp256k1PrivateKey:()=>Dp,unmarshalSecp256k1PublicKey:()=>kp});var Ep=(t,e,r)=>t&e^~t&r,wp=(t,e,r)=>t&e^t&r^e&r,Bp=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ke=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Oe=new Uint32Array(64),Bo=class extends dr{constructor(){super(64,32,8,!1),this.A=Ke[0]|0,this.B=Ke[1]|0,this.C=Ke[2]|0,this.D=Ke[3]|0,this.E=Ke[4]|0,this.F=Ke[5]|0,this.G=Ke[6]|0,this.H=Ke[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:f}=this;return[e,r,n,i,o,s,a,f]}set(e,r,n,i,o,s,a,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=f|0}process(e,r){for(let h=0;h<16;h++,r+=4)Oe[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let p=Oe[h-15],x=Oe[h-2],l=Xt(p,7)^Xt(p,18)^p>>>3,d=Xt(x,17)^Xt(x,19)^x>>>10;Oe[h]=d+Oe[h-7]+l+Oe[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:f,G:c,H:u}=this;for(let h=0;h<64;h++){let p=Xt(a,6)^Xt(a,11)^Xt(a,25),x=u+p+Ep(a,f,c)+Bp[h]+Oe[h]|0,d=(Xt(n,2)^Xt(n,13)^Xt(n,22))+wp(n,i,o)|0;u=c,c=f,f=a,a=s+x|0,s=o,o=i,i=n,n=x+d|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,f,c,u)}roundClean(){Oe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var k0=Sn(()=>new Bo);function Sp(t){let e=Or(t);he(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:Ap,hexToBytes:Cp}=In,er={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=er;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Ap(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=er,r=typeof t=="string"?Cp(t):t;if(!Jt(r))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=er._parseInt(r.subarray(2)),{d:s,l:a}=er._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),f=r(s);return`30${r(s+o+4)}02${f}${i}02${a}${n}`}},Ce=BigInt(0),Wt=BigInt(1),Gx=BigInt(2),P0=BigInt(3),Wx=BigInt(4);function Ip(t){let e=Sp(t),{Fp:r}=e,n=e.toBytes||((l,d,y)=>{let m=d.toAffine();return we(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(l=>{let d=l.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),m=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function o(l){let{a:d,b:y}=e,m=r.sqr(l),E=r.mul(m,l);return r.add(r.add(E,r.mul(l,d)),y)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(l){return typeof l=="bigint"&&Ce<l&&l<e.n}function a(l){if(!s(l))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(l){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(d&&typeof l!="bigint"){if(Jt(l)&&(l=be(l)),typeof l!="string"||!d.includes(l.length))throw new Error("Invalid key");l=l.padStart(y*2,"0")}let b;try{b=typeof l=="bigint"?l:Ee(vt("private key",l,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof l}`)}return m&&(b=at(b,E)),a(b),b}let c=new Map;function u(l){if(!(l instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(d,y,m){if(this.px=d,this.py=y,this.pz=m,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(d){let{x:y,y:m}=d||{};if(!d||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(d instanceof h)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(m=>m.pz));return d.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(d){let y=h.fromAffine(i(vt("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return h.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=o(d);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){u(d);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=d,B=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(R,E));return B&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=e,m=r.mul(y,P0),{px:E,py:b,pz:R}=this,w=r.ZERO,B=r.ZERO,L=r.ZERO,N=r.mul(E,E),z=r.mul(b,b),H=r.mul(R,R),V=r.mul(E,b);return V=r.add(V,V),L=r.mul(E,R),L=r.add(L,L),w=r.mul(d,L),B=r.mul(m,H),B=r.add(w,B),w=r.sub(z,B),B=r.add(z,B),B=r.mul(w,B),w=r.mul(V,w),L=r.mul(m,L),H=r.mul(d,H),V=r.sub(N,H),V=r.mul(d,V),V=r.add(V,L),L=r.add(N,N),N=r.add(L,N),N=r.add(N,H),N=r.mul(N,V),B=r.add(B,N),H=r.mul(b,R),H=r.add(H,H),N=r.mul(H,V),w=r.sub(w,N),L=r.mul(H,z),L=r.add(L,L),L=r.add(L,L),new h(w,B,L)}add(d){u(d);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=d,B=r.ZERO,L=r.ZERO,N=r.ZERO,z=e.a,H=r.mul(e.b,P0),V=r.mul(y,b),Q=r.mul(m,R),ot=r.mul(E,w),_t=r.add(y,m),I=r.add(b,R);_t=r.mul(_t,I),I=r.add(V,Q),_t=r.sub(_t,I),I=r.add(y,E);let k=r.add(b,w);return I=r.mul(I,k),k=r.add(V,ot),I=r.sub(I,k),k=r.add(m,E),B=r.add(R,w),k=r.mul(k,B),B=r.add(Q,ot),k=r.sub(k,B),N=r.mul(z,I),B=r.mul(H,ot),N=r.add(B,N),B=r.sub(Q,N),N=r.add(Q,N),L=r.mul(B,N),Q=r.add(V,V),Q=r.add(Q,V),ot=r.mul(z,ot),I=r.mul(H,I),Q=r.add(Q,ot),ot=r.sub(V,ot),ot=r.mul(z,ot),I=r.add(I,ot),V=r.mul(Q,I),L=r.add(L,V),V=r.mul(k,I),B=r.mul(_t,B),B=r.sub(B,V),V=r.mul(_t,Q),N=r.mul(k,N),N=r.add(N,V),new h(B,L,N)}subtract(d){return this.add(d.negate())}is0(){return this.equals(h.ZERO)}wNAF(d){return x.wNAFCached(this,c,d,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(h.fromAffine)})}multiplyUnsafe(d){let y=h.ZERO;if(d===Ce)return y;if(a(d),d===Wt)return this;let{endo:m}=e;if(!m)return x.unsafeLadder(this,d);let{k1neg:E,k1:b,k2neg:R,k2:w}=m.splitScalar(d),B=y,L=y,N=this;for(;b>Ce||w>Ce;)b&Wt&&(B=B.add(N)),w&Wt&&(L=L.add(N)),N=N.double(),b>>=Wt,w>>=Wt;return E&&(B=B.negate()),R&&(L=L.negate()),L=new h(r.mul(L.px,m.beta),L.py,L.pz),B.add(L)}multiply(d){a(d);let y=d,m,E,{endo:b}=e;if(b){let{k1neg:R,k1:w,k2neg:B,k2:L}=b.splitScalar(y),{p:N,f:z}=this.wNAF(w),{p:H,f:V}=this.wNAF(L);N=x.constTimeNegate(R,N),H=x.constTimeNegate(B,H),H=new h(r.mul(H.px,b.beta),H.py,H.pz),m=N.add(H),E=z.add(V)}else{let{p:R,f:w}=this.wNAF(y);m=R,E=w}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(d,y,m){let E=h.BASE,b=(w,B)=>B===Ce||B===Wt||!w.equals(E)?w.multiplyUnsafe(B):w.multiply(B),R=b(this,y).add(b(d,m));return R.is0()?void 0:R}toAffine(d){let{px:y,py:m,pz:E}=this,b=this.is0();d==null&&(d=b?r.ONE:r.inv(E));let R=r.mul(y,d),w=r.mul(m,d),B=r.mul(E,d);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:R,y:w}}isTorsionFree(){let{h:d,isTorsionFree:y}=e;if(d===Wt)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=e;return d===Wt?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),n(h,this,d)}toHex(d=!0){return be(this.toRawBytes(d))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let p=e.nBitLength,x=Rn(h,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:o,isWithinCurveOrder:s}}function Tp(t){let e=Or(t);return he(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function U0(t){let e=Tp(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(I){return Ce<I&&I<r.ORDER}function a(I){return at(I,n)}function f(I){return Tn(I,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:p}=Ip({...e,toBytes(I,k,_){let D=k.toAffine(),A=r.toBytes(D.x),K=we;return _?K(Uint8Array.from([k.hasEvenY()?2:3]),A):K(Uint8Array.from([4]),A,r.toBytes(D.y))},fromBytes(I){let k=I.length,_=I[0],D=I.subarray(1);if(k===i&&(_===2||_===3)){let A=Ee(D);if(!s(A))throw new Error("Point is not on curve");let K=h(A),O=r.sqrt(K),F=(O&Wt)===Wt;return(_&1)===1!==F&&(O=r.neg(O)),{x:A,y:O}}else if(k===o&&_===4){let A=r.fromBytes(D.subarray(0,r.BYTES)),K=r.fromBytes(D.subarray(r.BYTES,2*r.BYTES));return{x:A,y:K}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),x=I=>be(Pe(I,e.nByteLength));function l(I){let k=n>>Wt;return I>k}function d(I){return l(I)?a(-I):I}let y=(I,k,_)=>Ee(I.slice(k,_));class m{constructor(k,_,D){this.r=k,this.s=_,this.recovery=D,this.assertValidity()}static fromCompact(k){let _=e.nByteLength;return k=vt("compactSignature",k,_*2),new m(y(k,0,_),y(k,_,2*_))}static fromDER(k){let{r:_,s:D}=er.toSig(vt("DER",k));return new m(_,D)}assertValidity(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:_,s:D,recovery:A}=this,K=L(vt("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let O=A===2||A===3?_+e.n:_;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let F=A&1?"03":"02",Z=c.fromHex(F+x(O)),X=f(O),nt=a(-K*X),J=a(D*X),et=c.BASE.multiplyAndAddUnsafe(Z,nt,J);if(!et)throw new Error("point at infinify");return et.assertValidity(),et}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Ye(this.toDERHex())}toDERHex(){return er.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ye(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}let E={isValidPrivateKey(I){try{return u(I),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let I=$i(e.n);return Ws(e.randomBytes(I),e.n)},precompute(I=8,k=c.BASE){return k._setWindowSize(I),k.multiply(BigInt(3)),k}};function b(I,k=!0){return c.fromPrivateKey(I).toRawBytes(k)}function R(I){let k=Jt(I),_=typeof I=="string",D=(k||_)&&I.length;return k?D===i||D===o:_?D===2*i||D===2*o:I instanceof c}function w(I,k,_=!0){if(R(I))throw new Error("first arg must be private key");if(!R(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(I)).toRawBytes(_)}let B=e.bits2int||function(I){let k=Ee(I),_=I.length*8-e.nBitLength;return _>0?k>>BigInt(_):k},L=e.bits2int_modN||function(I){return a(B(I))},N=Kr(e.nBitLength);function z(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(Ce<=I&&I<N))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Pe(I,e.nByteLength)}function H(I,k,_=V){if(["recovered","canonical"].some(xt=>xt in _))throw new Error("sign() legacy options not supported");let{hash:D,randomBytes:A}=e,{lowS:K,prehash:O,extraEntropy:F}=_;K==null&&(K=!0),I=vt("msgHash",I),O&&(I=vt("prehashed msgHash",D(I)));let Z=L(I),X=u(k),nt=[z(X),z(Z)];if(F!=null){let xt=F===!0?A(r.BYTES):F;nt.push(vt("extraEntropy",xt))}let J=we(...nt),et=Z;function wt(xt){let Rt=B(xt);if(!p(Rt))return;let Lt=f(Rt),St=c.BASE.multiply(Rt).toAffine(),Dt=a(St.x);if(Dt===Ce)return;let pe=a(Lt*a(et+Dt*X));if(pe===Ce)return;let Me=(St.x===Dt?0:2)|Number(St.y&Wt),Br=pe;return K&&l(pe)&&(Br=d(pe),Me^=1),new m(Dt,Br,Me)}return{seed:J,k2sig:wt}}let V={lowS:e.lowS,prehash:!1},Q={lowS:e.lowS,prehash:!1};function ot(I,k,_=V){let{seed:D,k2sig:A}=H(I,k,_),K=e;return Gi(K.hash.outputLen,K.nByteLength,K.hmac)(D,A)}c.BASE._setWindowSize(8);function _t(I,k,_,D=Q){let A=I;if(k=vt("msgHash",k),_=vt("publicKey",_),"strict"in D)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:O}=D,F,Z;try{if(typeof A=="string"||Jt(A))try{F=m.fromDER(A)}catch(St){if(!(St instanceof er.Err))throw St;F=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:St,s:Dt}=A;F=new m(St,Dt)}else throw new Error("PARSE");Z=c.fromHex(_)}catch(St){if(St.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&F.hasHighS())return!1;O&&(k=e.hash(k));let{r:X,s:nt}=F,J=L(k),et=f(nt),wt=a(J*et),xt=a(X*et),Rt=c.BASE.multiplyAndAddUnsafe(Z,wt,xt)?.toAffine();return Rt?a(Rt.x)===X:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:ot,verify:_t,ProjectivePoint:c,Signature:m,utils:E}}var qn=class extends lr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Ds(e);let n=Ur(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return hr(this),this.iHash.update(e),this}digestInto(e){hr(this),Oi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},So=(t,e,r)=>new qn(t,e).update(r).digest();So.create=(t,e)=>new qn(t,e);function _p(t){return{hash:t,hmac:(e,...r)=>So(t,e,Bn(...r)),randomBytes:pr}}function K0(t,e){let r=n=>U0({...t,..._p(n)});return Object.freeze({...r(e),create:r})}var V0=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),O0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Rp=BigInt(1),Ao=BigInt(2),M0=(t,e)=>(t+e/Ao)/e;function Lp(t){let e=V0,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=dt(u,r,e)*u%e,p=dt(h,r,e)*u%e,x=dt(p,Ao,e)*c%e,l=dt(x,i,e)*x%e,d=dt(l,o,e)*l%e,y=dt(d,a,e)*d%e,m=dt(y,f,e)*y%e,E=dt(m,a,e)*d%e,b=dt(E,r,e)*u%e,R=dt(b,s,e)*l%e,w=dt(R,n,e)*c%e,B=dt(w,Ao,e);if(!Co.eql(Co.sqr(B),t))throw new Error("Cannot find square root");return B}var Co=_n(V0,void 0,void 0,{sqrt:Lp}),ne=K0({a:BigInt(0),b:BigInt(7),Fp:Co,n:O0,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=O0,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Rp*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=M0(o*t,e),f=M0(-n*t,e),c=at(t-a*r-f*i,e),u=at(-a*n-f*o,e),h=c>s,p=u>s;if(h&&(c=e-c),p&&(u=e-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:p,k2:u}}}},k0),ig=BigInt(0);var og=ne.ProjectivePoint;function q0(){return ne.utils.randomPrivateKey()}function F0(t,e){let r=Mt.digest(e instanceof Uint8Array?e:e.subarray());if(Gt(r))return r.then(({digest:n})=>ne.sign(n,t).toDERRawBytes()).catch(n=>{throw new q(String(n),"ERR_INVALID_INPUT")});try{return ne.sign(r.digest,t).toDERRawBytes()}catch(n){throw new q(String(n),"ERR_INVALID_INPUT")}}function H0(t,e,r){let n=Mt.digest(r instanceof Uint8Array?r:r.subarray());if(Gt(n))return n.then(({digest:i})=>ne.verify(e,i,t)).catch(i=>{throw new q(String(i),"ERR_INVALID_INPUT")});try{return ne.verify(e,n.digest,t)}catch(i){throw new q(String(i),"ERR_INVALID_INPUT")}}function z0(t){return ne.ProjectivePoint.fromHex(t).toRawBytes(!0)}function G0(t){try{ne.getPublicKey(t,!0)}catch(e){throw new q(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Io(t){try{ne.ProjectivePoint.fromHex(t)}catch(e){throw new q(String(e),"ERR_INVALID_PUBLIC_KEY")}}function W0(t){try{return ne.getPublicKey(t,!0)}catch(e){throw new q(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Yr=class{_key;constructor(e){Io(e),this._key=e}verify(e,r){return H0(this._key,r,e)}marshal(){return z0(this._key)}get bytes(){return ee.encode({Type:ut.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}async hash(){let e=Mt.digest(this.bytes),r;return Gt(e)?{bytes:r}=await e:r=e.bytes,r}},Zr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??W0(e),G0(this._key),Io(this._publicKey)}sign(e){return F0(this._key,e)}get public(){return new Yr(this._publicKey)}marshal(){return this._key}get bytes(){return re.encode({Type:ut.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}async id(){let e=await this.public.hash();return yt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return gr(this.bytes,e);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Dp(t){return new Zr(t)}function kp(t){return new Yr(t)}async function Pp(){let t=q0();return new Zr(t)}var le={rsa:wo,ed25519:xo,secp256k1:To};function _o(t){let e=Object.keys(le).join(" / ");return new q(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ro(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return le[t];throw _o(t)}async function Up(t,e){return Ro(t).generateKeyPair(e??2048)}async function Kp(t,e,r){if(t.toLowerCase()!=="ed25519")throw new q("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return yo(e)}function Op(t){let e=ee.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case ut.RSA:return le.rsa.unmarshalRsaPublicKey(r);case ut.Ed25519:return le.ed25519.unmarshalEd25519PublicKey(r);case ut.Secp256k1:return le.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw _o(e.Type??"unknown")}}function Mp(t,e){return e=(e??"rsa").toLowerCase(),Ro(e),t.bytes}async function Y0(t){let e=re.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case ut.RSA:return le.rsa.unmarshalRsaPrivateKey(r);case ut.Ed25519:return le.ed25519.unmarshalEd25519PrivateKey(r);case ut.Secp256k1:return le.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw _o(e.Type??"RSA")}}function Vp(t,e){return e=(e??"rsa").toLowerCase(),Ro(e),t.bytes}async function qp(t,e){try{let i=await x0(t,e);return await Y0(i)}catch{}let r=Fn.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new q("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=Fn.default.asn1.toDer(Fn.default.pki.privateKeyToAsn1(r));return n=Bt(n.getBytes(),"ascii"),le.rsa.unmarshalRsaPrivateKey(n)}var $0=Nt(Ti(),1),Q0=Nt(bt(),1),Z0={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function No(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let a=Object.keys(Z0).join(" / ");throw new q(`Hash '${i}' is unknown or not supported. Must be ${a}`,"ERR_UNSUPPORTED_HASH_TYPE")}let o=Z0[i],s=(0,$0.default)(t,e,r,n,o);return Q0.default.encode64(s,null)}return hf(Fp);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PCrypto}));
