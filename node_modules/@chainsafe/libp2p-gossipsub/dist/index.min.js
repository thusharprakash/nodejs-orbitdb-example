(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PGossipsub=(()=>{var Ul=Object.create;var ns=Object.defineProperty;var Fl=Object.getOwnPropertyDescriptor;var Kl=Object.getOwnPropertyNames;var ql=Object.getPrototypeOf,Vl=Object.prototype.hasOwnProperty;var Ka=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var W=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),De=(t,e)=>{for(var r in e)ns(t,r,{get:e[r],enumerable:!0})},qa=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Kl(e))!Vl.call(t,s)&&s!==r&&ns(t,s,{get:()=>e[s],enumerable:!(n=Fl(e,s))||n.enumerable});return t};var _e=(t,e,r)=>(r=t!=null?Ul(ql(t)):{},qa(e||!t||!t.__esModule?ns(r,"default",{value:t,enumerable:!0}):r,t)),zl=t=>qa(ns({},"__esModule",{value:!0}),t);var yc=W((G2,gc)=>{"use strict";function dc(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function np(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return dc(t,r)}catch{r.message=t.message,r.stack=t.stack;let s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(t)),dc(new s,r)}}gc.exports=np});var Ec=W((cx,Sc)=>{"use strict";Sc.exports=lp;function lp(t,e){for(var r=new Array(arguments.length-1),n=0,s=2,i=!0;s<arguments.length;)r[n++]=arguments[s++];return new Promise(function(a,f){r[n]=function(c){if(i)if(i=!1,c)f(c);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(u){i&&(i=!1,f(u))}})}});var Tc=W(Bc=>{"use strict";var ps=Bc;ps.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var tn=new Array(64),Ic=new Array(123);for(dt=0;dt<64;)Ic[tn[dt]=dt<26?dt+65:dt<52?dt+71:dt<62?dt-4:dt-59|43]=dt++;var dt;ps.encode=function(e,r,n){for(var s=null,i=[],o=0,a=0,f;r<n;){var u=e[r++];switch(a){case 0:i[o++]=tn[u>>2],f=(u&3)<<4,a=1;break;case 1:i[o++]=tn[f|u>>4],f=(u&15)<<2,a=2;break;case 2:i[o++]=tn[f|u>>6],i[o++]=tn[u&63],a=0;break}o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,i)),o=0)}return a&&(i[o++]=tn[f],i[o++]=61,a===1&&(i[o++]=61)),s?(o&&s.push(String.fromCharCode.apply(String,i.slice(0,o))),s.join("")):String.fromCharCode.apply(String,i.slice(0,o))};var _c="invalid encoding";ps.decode=function(e,r,n){for(var s=n,i=0,o,a=0;a<e.length;){var f=e.charCodeAt(a++);if(f===61&&i>1)break;if((f=Ic[f])===void 0)throw Error(_c);switch(i){case 0:o=f,i=1;break;case 1:r[n++]=o<<2|(f&48)>>4,o=f,i=2;break;case 2:r[n++]=(o&15)<<4|(f&60)>>2,o=f,i=3;break;case 3:r[n++]=(o&3)<<6|f,i=0;break}}if(i===1)throw Error(_c);return n-s};ps.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Cc=W((fx,Ac)=>{"use strict";Ac.exports=ds;function ds(){this._listeners={}}ds.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};ds.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],s=0;s<n.length;)n[s].fn===r?n.splice(s,1):++s;return this};ds.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],s=1;s<arguments.length;)n.push(arguments[s++]);for(s=0;s<r.length;)r[s].fn.apply(r[s++].ctx,n)}return this}});var Lc=W((hx,Nc)=>{"use strict";Nc.exports=Pc(Pc);function Pc(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function s(f,u,c){e[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3]}function i(f,u,c){e[0]=f,u[c]=r[3],u[c+1]=r[2],u[c+2]=r[1],u[c+3]=r[0]}t.writeFloatLE=n?s:i,t.writeFloatBE=n?i:s;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],e[0]}function a(f,u){return r[3]=f[u],r[2]=f[u+1],r[1]=f[u+2],r[0]=f[u+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,s,i,o){var a=s<0?1:0;if(a&&(s=-s),s===0)n(1/s>0?0:2147483648,i,o);else if(isNaN(s))n(2143289344,i,o);else if(s>34028234663852886e22)n((a<<31|2139095040)>>>0,i,o);else if(s<11754943508222875e-54)n((a<<31|Math.round(s/1401298464324817e-60))>>>0,i,o);else{var f=Math.floor(Math.log(s)/Math.LN2),u=Math.round(s*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|u)>>>0,i,o)}}t.writeFloatLE=e.bind(null,Rc),t.writeFloatBE=e.bind(null,Dc);function r(n,s,i){var o=n(s,i),a=(o>>31)*2+1,f=o>>>23&255,u=o&8388607;return f===255?u?NaN:a*(1/0):f===0?a*1401298464324817e-60*u:a*Math.pow(2,f-150)*(u+8388608)}t.readFloatLE=r.bind(null,kc),t.readFloatBE=r.bind(null,Mc)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function s(f,u,c){e[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3],u[c+4]=r[4],u[c+5]=r[5],u[c+6]=r[6],u[c+7]=r[7]}function i(f,u,c){e[0]=f,u[c]=r[7],u[c+1]=r[6],u[c+2]=r[5],u[c+3]=r[4],u[c+4]=r[3],u[c+5]=r[2],u[c+6]=r[1],u[c+7]=r[0]}t.writeDoubleLE=n?s:i,t.writeDoubleBE=n?i:s;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],r[4]=f[u+4],r[5]=f[u+5],r[6]=f[u+6],r[7]=f[u+7],e[0]}function a(f,u){return r[7]=f[u],r[6]=f[u+1],r[5]=f[u+2],r[4]=f[u+3],r[3]=f[u+4],r[2]=f[u+5],r[1]=f[u+6],r[0]=f[u+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,s,i,o,a,f){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,f+s),n(1/o>0?0:2147483648,a,f+i);else if(isNaN(o))n(0,a,f+s),n(2146959360,a,f+i);else if(o>17976931348623157e292)n(0,a,f+s),n((u<<31|2146435072)>>>0,a,f+i);else{var c;if(o<22250738585072014e-324)c=o/5e-324,n(c>>>0,a,f+s),n((u<<31|c/4294967296)>>>0,a,f+i);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),c=o*Math.pow(2,-h),n(c*4503599627370496>>>0,a,f+s),n((u<<31|h+1023<<20|c*1048576&1048575)>>>0,a,f+i)}}}t.writeDoubleLE=e.bind(null,Rc,0,4),t.writeDoubleBE=e.bind(null,Dc,4,0);function r(n,s,i,o,a){var f=n(o,a+s),u=n(o,a+i),c=(u>>31)*2+1,h=u>>>20&2047,l=4294967296*(u&1048575)+f;return h===2047?l?NaN:c*(1/0):h===0?c*5e-324*l:c*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,kc,0,4),t.readDoubleBE=r.bind(null,Mc,4,0)}(),t}function Rc(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Dc(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function kc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Mc(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Oc=W((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Fc=W(Uc=>{"use strict";var Qi=Uc;Qi.length=function(e){for(var r=0,n=0,s=0;s<e.length;++s)n=e.charCodeAt(s),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(s+1)&64512)===56320?(++s,r+=4):r+=3;return r};Qi.read=function(e,r,n){var s=n-r;if(s<1)return"";for(var i=null,o=[],a=0,f;r<n;)f=e[r++],f<128?o[a++]=f:f>191&&f<224?o[a++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(f>>10),o[a++]=56320+(f&1023)):o[a++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Qi.write=function(e,r,n){for(var s=n,i,o,a=0;a<e.length;++a)i=e.charCodeAt(a),i<128?r[n++]=i:i<2048?(r[n++]=i>>6|192,r[n++]=i&63|128):(i&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(i=65536+((i&1023)<<10)+(o&1023),++a,r[n++]=i>>18|240,r[n++]=i>>12&63|128,r[n++]=i>>6&63|128,r[n++]=i&63|128):(r[n++]=i>>12|224,r[n++]=i>>6&63|128,r[n++]=i&63|128);return n-s}});var qc=W((px,Kc)=>{"use strict";Kc.exports=pp;function pp(t,e,r){var n=r||8192,s=n>>>1,i=null,o=n;return function(f){if(f<1||f>s)return t(f);o+f>n&&(i=t(n),o=0);var u=e.call(i,o,o+=f);return o&7&&(o=(o|7)+1),u}}});var zc=W((dx,Vc)=>{"use strict";Vc.exports=ke;var Dn=tr();function ke(t,e){this.lo=t>>>0,this.hi=e>>>0}var Br=ke.zero=new ke(0,0);Br.toNumber=function(){return 0};Br.zzEncode=Br.zzDecode=function(){return this};Br.length=function(){return 1};var dp=ke.zeroHash="\0\0\0\0\0\0\0\0";ke.fromNumber=function(e){if(e===0)return Br;var r=e<0;r&&(e=-e);var n=e>>>0,s=(e-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new ke(n,s)};ke.from=function(e){if(typeof e=="number")return ke.fromNumber(e);if(Dn.isString(e))if(Dn.Long)e=Dn.Long.fromString(e);else return ke.fromNumber(parseInt(e,10));return e.low||e.high?new ke(e.low>>>0,e.high>>>0):Br};ke.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};ke.prototype.toLong=function(e){return Dn.Long?new Dn.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var er=String.prototype.charCodeAt;ke.fromHash=function(e){return e===dp?Br:new ke((er.call(e,0)|er.call(e,1)<<8|er.call(e,2)<<16|er.call(e,3)<<24)>>>0,(er.call(e,4)|er.call(e,5)<<8|er.call(e,6)<<16|er.call(e,7)<<24)>>>0)};ke.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ke.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};ke.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};ke.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var tr=W(Xi=>{"use strict";var z=Xi;z.asPromise=Ec();z.base64=Tc();z.EventEmitter=Cc();z.float=Lc();z.inquire=Oc();z.utf8=Fc();z.pool=qc();z.LongBits=zc();z.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);z.global=z.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Xi;z.emptyArray=Object.freeze?Object.freeze([]):[];z.emptyObject=Object.freeze?Object.freeze({}):{};z.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};z.isString=function(e){return typeof e=="string"||e instanceof String};z.isObject=function(e){return e&&typeof e=="object"};z.isset=z.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};z.Buffer=function(){try{var t=z.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();z._Buffer_from=null;z._Buffer_allocUnsafe=null;z.newBuffer=function(e){return typeof e=="number"?z.Buffer?z._Buffer_allocUnsafe(e):new z.Array(e):z.Buffer?z._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};z.Array=typeof Uint8Array<"u"?Uint8Array:Array;z.Long=z.global.dcodeIO&&z.global.dcodeIO.Long||z.global.Long||z.inquire("long");z.key2Re=/^true|false|0|1$/;z.key32Re=/^-?(?:0|[1-9][0-9]*)$/;z.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;z.longToHash=function(e){return e?z.LongBits.from(e).toHash():z.LongBits.zeroHash};z.longFromHash=function(e,r){var n=z.LongBits.fromHash(e);return z.Long?z.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function Hc(t,e,r){for(var n=Object.keys(e),s=0;s<n.length;++s)(t[n[s]]===void 0||!r)&&(t[n[s]]=e[n[s]]);return t}z.merge=Hc;z.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Gc(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Hc(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}z.newError=Gc;z.ProtocolError=Gc("ProtocolError");z.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var s=Object.keys(this),i=s.length-1;i>-1;--i)if(r[s[i]]===1&&this[s[i]]!==void 0&&this[s[i]]!==null)return s[i]}};z.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};z.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};z._configure=function(){var t=z.Buffer;if(!t){z._Buffer_from=z._Buffer_allocUnsafe=null;return}z._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},z._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var io=W((yx,Yc)=>{"use strict";Yc.exports=re;var ct=tr(),Ji,gs=ct.LongBits,Wc=ct.base64,jc=ct.utf8;function kn(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function to(){}function gp(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function re(){this.len=0,this.head=new kn(to,0,0),this.tail=this.head,this.states=null}var $c=function(){return ct.Buffer?function(){return(re.create=function(){return new Ji})()}:function(){return new re}};re.create=$c();re.alloc=function(e){return new ct.Array(e)};ct.Array!==Array&&(re.alloc=ct.pool(re.alloc,ct.Array.prototype.subarray));re.prototype._push=function(e,r,n){return this.tail=this.tail.next=new kn(e,r,n),this.len+=r,this};function ro(t,e,r){e[r]=t&255}function yp(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function no(t,e){this.len=t,this.next=void 0,this.val=e}no.prototype=Object.create(kn.prototype);no.prototype.fn=yp;re.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new no((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};re.prototype.int32=function(e){return e<0?this._push(so,10,gs.fromNumber(e)):this.uint32(e)};re.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function so(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}re.prototype.uint64=function(e){var r=gs.from(e);return this._push(so,r.length(),r)};re.prototype.int64=re.prototype.uint64;re.prototype.sint64=function(e){var r=gs.from(e).zzEncode();return this._push(so,r.length(),r)};re.prototype.bool=function(e){return this._push(ro,1,e?1:0)};function eo(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}re.prototype.fixed32=function(e){return this._push(eo,4,e>>>0)};re.prototype.sfixed32=re.prototype.fixed32;re.prototype.fixed64=function(e){var r=gs.from(e);return this._push(eo,4,r.lo)._push(eo,4,r.hi)};re.prototype.sfixed64=re.prototype.fixed64;re.prototype.float=function(e){return this._push(ct.float.writeFloatLE,4,e)};re.prototype.double=function(e){return this._push(ct.float.writeDoubleLE,8,e)};var mp=ct.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var s=0;s<e.length;++s)r[n+s]=e[s]};re.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(ro,1,0);if(ct.isString(e)){var n=re.alloc(r=Wc.length(e));Wc.decode(e,n,0),e=n}return this.uint32(r)._push(mp,r,e)};re.prototype.string=function(e){var r=jc.length(e);return r?this.uint32(r)._push(jc.write,r,e):this._push(ro,1,0)};re.prototype.fork=function(){return this.states=new gp(this),this.head=this.tail=new kn(to,0,0),this.len=0,this};re.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new kn(to,0,0),this.len=0),this};re.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};re.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};re._configure=function(t){Ji=t,re.create=$c(),Ji._configure()}});var Xc=W((mx,Qc)=>{"use strict";Qc.exports=Bt;var Zc=io();(Bt.prototype=Object.create(Zc.prototype)).constructor=Bt;var rr=tr();function Bt(){Zc.call(this)}Bt._configure=function(){Bt.alloc=rr._Buffer_allocUnsafe,Bt.writeBytesBuffer=rr.Buffer&&rr.Buffer.prototype instanceof Uint8Array&&rr.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var s=0;s<e.length;)r[n++]=e[s++]}};Bt.prototype.bytes=function(e){rr.isString(e)&&(e=rr._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Bt.writeBytesBuffer,r,e),this};function bp(t,e,r){t.length<40?rr.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Bt.prototype.string=function(e){var r=rr.Buffer.byteLength(e);return this.uint32(r),r&&this._push(bp,r,e),this};Bt._configure()});var co=W((bx,nu)=>{"use strict";nu.exports=Ie;var gt=tr(),ao,tu=gt.LongBits,xp=gt.utf8;function yt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Ie(t){this.buf=t,this.pos=0,this.len=t.length}var Jc=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ie(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ie(e);throw Error("illegal buffer")},ru=function(){return gt.Buffer?function(r){return(Ie.create=function(s){return gt.Buffer.isBuffer(s)?new ao(s):Jc(s)})(r)}:Jc};Ie.create=ru();Ie.prototype._slice=gt.Array.prototype.subarray||gt.Array.prototype.slice;Ie.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,yt(this,10);return e}}();Ie.prototype.int32=function(){return this.uint32()|0};Ie.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function oo(){var t=new tu(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw yt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw yt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Ie.prototype.bool=function(){return this.uint32()!==0};function ys(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Ie.prototype.fixed32=function(){if(this.pos+4>this.len)throw yt(this,4);return ys(this.buf,this.pos+=4)};Ie.prototype.sfixed32=function(){if(this.pos+4>this.len)throw yt(this,4);return ys(this.buf,this.pos+=4)|0};function eu(){if(this.pos+8>this.len)throw yt(this,8);return new tu(ys(this.buf,this.pos+=4),ys(this.buf,this.pos+=4))}Ie.prototype.float=function(){if(this.pos+4>this.len)throw yt(this,4);var e=gt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Ie.prototype.double=function(){if(this.pos+8>this.len)throw yt(this,4);var e=gt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Ie.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw yt(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var s=gt.Buffer;return s?s.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};Ie.prototype.string=function(){var e=this.bytes();return xp.read(e,0,e.length)};Ie.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw yt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw yt(this);while(this.buf[this.pos++]&128);return this};Ie.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Ie._configure=function(t){ao=t,Ie.create=ru(),ao._configure();var e=gt.Long?"toLong":"toNumber";gt.merge(Ie.prototype,{int64:function(){return oo.call(this)[e](!1)},uint64:function(){return oo.call(this)[e](!0)},sint64:function(){return oo.call(this).zzDecode()[e](!1)},fixed64:function(){return eu.call(this)[e](!0)},sfixed64:function(){return eu.call(this)[e](!1)}})}});var au=W((xx,ou)=>{"use strict";ou.exports=Tr;var iu=co();(Tr.prototype=Object.create(iu.prototype)).constructor=Tr;var su=tr();function Tr(t){iu.call(this,t)}Tr._configure=function(){su.Buffer&&(Tr.prototype._slice=su.Buffer.prototype.slice)};Tr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Tr._configure()});var uu=W((vx,cu)=>{"use strict";cu.exports=Mn;var uo=tr();(Mn.prototype=Object.create(uo.EventEmitter.prototype)).constructor=Mn;function Mn(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");uo.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!r}Mn.prototype.rpcCall=function t(e,r,n,s,i){if(!s)throw TypeError("request must be specified");var o=this;if(!i)return uo.asPromise(t,o,e,r,n,s);if(!o.rpcImpl){setTimeout(function(){i(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(f,u){if(f)return o.emit("error",f,e),i(f);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(c){return o.emit("error",c,e),i(c)}return o.emit("data",u,e),i(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){i(a)},0);return}};Mn.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var hu=W(fu=>{"use strict";var vp=fu;vp.Service=uu()});var pu=W((Sx,lu)=>{"use strict";lu.exports={}});var yu=W(gu=>{"use strict";var tt=gu;tt.build="minimal";tt.Writer=io();tt.BufferWriter=Xc();tt.Reader=co();tt.BufferReader=au();tt.util=tr();tt.rpc=hu();tt.roots=pu();tt.configure=du;function du(){tt.util._configure(),tt.Writer._configure(tt.BufferWriter),tt.Reader._configure(tt.BufferReader)}du()});var fo=W((_x,mu)=>{"use strict";mu.exports=yu()});var Su=W((wu,Nn)=>{"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Ka=="function"&&typeof Nn=="object"&&Nn&&Nn.exports&&(Nn.exports=e(fo()))})(wu,function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,s=t.roots.default||(t.roots.default={});return s.RPC=function(){function i(a){if(this.subscriptions=[],this.messages=[],a)for(var f=Object.keys(a),u=0;u<f.length;++u)a[f[u]]!=null&&(this[f[u]]=a[f[u]])}i.prototype.subscriptions=n.emptyArray,i.prototype.messages=n.emptyArray,i.prototype.control=null;var o;return Object.defineProperty(i.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),i.encode=function(f,u){if(u||(u=r.create()),f.subscriptions!=null&&f.subscriptions.length)for(var c=0;c<f.subscriptions.length;++c)s.RPC.SubOpts.encode(f.subscriptions[c],u.uint32(10).fork()).ldelim();if(f.messages!=null&&f.messages.length)for(var c=0;c<f.messages.length;++c)s.RPC.Message.encode(f.messages[c],u.uint32(18).fork()).ldelim();return f.control!=null&&Object.hasOwnProperty.call(f,"control")&&s.RPC.ControlMessage.encode(f.control,u.uint32(26).fork()).ldelim(),u},i.decode=function(f,u){f instanceof e||(f=e.create(f));for(var c=u===void 0?f.len:f.pos+u,h=new s.RPC;f.pos<c;){var l=f.uint32();switch(l>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(s.RPC.SubOpts.decode(f,f.uint32()));break;case 2:h.messages&&h.messages.length||(h.messages=[]),h.messages.push(s.RPC.Message.decode(f,f.uint32()));break;case 3:h.control=s.RPC.ControlMessage.decode(f,f.uint32());break;default:f.skipType(l&7);break}}return h},i.fromObject=function(f){if(f instanceof s.RPC)return f;var u=new s.RPC;if(f.subscriptions){if(!Array.isArray(f.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var c=0;c<f.subscriptions.length;++c){if(typeof f.subscriptions[c]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[c]=s.RPC.SubOpts.fromObject(f.subscriptions[c])}}if(f.messages){if(!Array.isArray(f.messages))throw TypeError(".RPC.messages: array expected");u.messages=[];for(var c=0;c<f.messages.length;++c){if(typeof f.messages[c]!="object")throw TypeError(".RPC.messages: object expected");u.messages[c]=s.RPC.Message.fromObject(f.messages[c])}}if(f.control!=null){if(typeof f.control!="object")throw TypeError(".RPC.control: object expected");u.control=s.RPC.ControlMessage.fromObject(f.control)}return u},i.toObject=function(f,u){u||(u={});var c={};if((u.arrays||u.defaults)&&(c.subscriptions=[],c.messages=[]),f.subscriptions&&f.subscriptions.length){c.subscriptions=[];for(var h=0;h<f.subscriptions.length;++h)c.subscriptions[h]=s.RPC.SubOpts.toObject(f.subscriptions[h],u)}if(f.messages&&f.messages.length){c.messages=[];for(var h=0;h<f.messages.length;++h)c.messages[h]=s.RPC.Message.toObject(f.messages[h],u)}return f.control!=null&&f.hasOwnProperty("control")&&(c.control=s.RPC.ControlMessage.toObject(f.control,u),u.oneofs&&(c._control="control")),c},i.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},i.SubOpts=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.subscribe=null,a.prototype.topic=null;var f;return Object.defineProperty(a.prototype,"_subscribe",{get:n.oneOfGetter(f=["subscribe"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_topic",{get:n.oneOfGetter(f=["topic"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.subscribe!=null&&Object.hasOwnProperty.call(c,"subscribe")&&h.uint32(8).bool(c.subscribe),c.topic!=null&&Object.hasOwnProperty.call(c,"topic")&&h.uint32(18).string(c.topic),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.SubOpts;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.subscribe=c.bool();break;case 2:g.topic=c.string();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.SubOpts)return c;var h=new s.RPC.SubOpts;return c.subscribe!=null&&(h.subscribe=!!c.subscribe),c.topic!=null&&(h.topic=String(c.topic)),h},a.toObject=function(c,h){h||(h={});var l={};return c.subscribe!=null&&c.hasOwnProperty("subscribe")&&(l.subscribe=c.subscribe,h.oneofs&&(l._subscribe="subscribe")),c.topic!=null&&c.hasOwnProperty("topic")&&(l.topic=c.topic,h.oneofs&&(l._topic="topic")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.Message=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topic="",a.prototype.signature=null,a.prototype.key=null;var f;return Object.defineProperty(a.prototype,"_from",{get:n.oneOfGetter(f=["from"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_data",{get:n.oneOfGetter(f=["data"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_seqno",{get:n.oneOfGetter(f=["seqno"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_signature",{get:n.oneOfGetter(f=["signature"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_key",{get:n.oneOfGetter(f=["key"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.from!=null&&Object.hasOwnProperty.call(c,"from")&&h.uint32(10).bytes(c.from),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&h.uint32(18).bytes(c.data),c.seqno!=null&&Object.hasOwnProperty.call(c,"seqno")&&h.uint32(26).bytes(c.seqno),h.uint32(34).string(c.topic),c.signature!=null&&Object.hasOwnProperty.call(c,"signature")&&h.uint32(42).bytes(c.signature),c.key!=null&&Object.hasOwnProperty.call(c,"key")&&h.uint32(50).bytes(c.key),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.Message;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.from=c.bytes();break;case 2:g.data=c.bytes();break;case 3:g.seqno=c.bytes();break;case 4:g.topic=c.string();break;case 5:g.signature=c.bytes();break;case 6:g.key=c.bytes();break;default:c.skipType(p&7);break}}if(!g.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:g});return g},a.fromObject=function(c){if(c instanceof s.RPC.Message)return c;var h=new s.RPC.Message;return c.from!=null&&(typeof c.from=="string"?n.base64.decode(c.from,h.from=n.newBuffer(n.base64.length(c.from)),0):c.from.length&&(h.from=c.from)),c.data!=null&&(typeof c.data=="string"?n.base64.decode(c.data,h.data=n.newBuffer(n.base64.length(c.data)),0):c.data.length&&(h.data=c.data)),c.seqno!=null&&(typeof c.seqno=="string"?n.base64.decode(c.seqno,h.seqno=n.newBuffer(n.base64.length(c.seqno)),0):c.seqno.length&&(h.seqno=c.seqno)),c.topic!=null&&(h.topic=String(c.topic)),c.signature!=null&&(typeof c.signature=="string"?n.base64.decode(c.signature,h.signature=n.newBuffer(n.base64.length(c.signature)),0):c.signature.length&&(h.signature=c.signature)),c.key!=null&&(typeof c.key=="string"?n.base64.decode(c.key,h.key=n.newBuffer(n.base64.length(c.key)),0):c.key.length&&(h.key=c.key)),h},a.toObject=function(c,h){h||(h={});var l={};return h.defaults&&(l.topic=""),c.from!=null&&c.hasOwnProperty("from")&&(l.from=h.bytes===String?n.base64.encode(c.from,0,c.from.length):h.bytes===Array?Array.prototype.slice.call(c.from):c.from,h.oneofs&&(l._from="from")),c.data!=null&&c.hasOwnProperty("data")&&(l.data=h.bytes===String?n.base64.encode(c.data,0,c.data.length):h.bytes===Array?Array.prototype.slice.call(c.data):c.data,h.oneofs&&(l._data="data")),c.seqno!=null&&c.hasOwnProperty("seqno")&&(l.seqno=h.bytes===String?n.base64.encode(c.seqno,0,c.seqno.length):h.bytes===Array?Array.prototype.slice.call(c.seqno):c.seqno,h.oneofs&&(l._seqno="seqno")),c.topic!=null&&c.hasOwnProperty("topic")&&(l.topic=c.topic),c.signature!=null&&c.hasOwnProperty("signature")&&(l.signature=h.bytes===String?n.base64.encode(c.signature,0,c.signature.length):h.bytes===Array?Array.prototype.slice.call(c.signature):c.signature,h.oneofs&&(l._signature="signature")),c.key!=null&&c.hasOwnProperty("key")&&(l.key=h.bytes===String?n.base64.encode(c.key,0,c.key.length):h.bytes===Array?Array.prototype.slice.call(c.key):c.key,h.oneofs&&(l._key="key")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlMessage=function(){function a(f){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],f)for(var u=Object.keys(f),c=0;c<u.length;++c)f[u[c]]!=null&&(this[u[c]]=f[u[c]])}return a.prototype.ihave=n.emptyArray,a.prototype.iwant=n.emptyArray,a.prototype.graft=n.emptyArray,a.prototype.prune=n.emptyArray,a.encode=function(u,c){if(c||(c=r.create()),u.ihave!=null&&u.ihave.length)for(var h=0;h<u.ihave.length;++h)s.RPC.ControlIHave.encode(u.ihave[h],c.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var h=0;h<u.iwant.length;++h)s.RPC.ControlIWant.encode(u.iwant[h],c.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var h=0;h<u.graft.length;++h)s.RPC.ControlGraft.encode(u.graft[h],c.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var h=0;h<u.prune.length;++h)s.RPC.ControlPrune.encode(u.prune[h],c.uint32(34).fork()).ldelim();return c},a.decode=function(u,c){u instanceof e||(u=e.create(u));for(var h=c===void 0?u.len:u.pos+c,l=new s.RPC.ControlMessage;u.pos<h;){var g=u.uint32();switch(g>>>3){case 1:l.ihave&&l.ihave.length||(l.ihave=[]),l.ihave.push(s.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:l.iwant&&l.iwant.length||(l.iwant=[]),l.iwant.push(s.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:l.graft&&l.graft.length||(l.graft=[]),l.graft.push(s.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:l.prune&&l.prune.length||(l.prune=[]),l.prune.push(s.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(g&7);break}}return l},a.fromObject=function(u){if(u instanceof s.RPC.ControlMessage)return u;var c=new s.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");c.ihave=[];for(var h=0;h<u.ihave.length;++h){if(typeof u.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");c.ihave[h]=s.RPC.ControlIHave.fromObject(u.ihave[h])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");c.iwant=[];for(var h=0;h<u.iwant.length;++h){if(typeof u.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");c.iwant[h]=s.RPC.ControlIWant.fromObject(u.iwant[h])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");c.graft=[];for(var h=0;h<u.graft.length;++h){if(typeof u.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");c.graft[h]=s.RPC.ControlGraft.fromObject(u.graft[h])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");c.prune=[];for(var h=0;h<u.prune.length;++h){if(typeof u.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");c.prune[h]=s.RPC.ControlPrune.fromObject(u.prune[h])}}return c},a.toObject=function(u,c){c||(c={});var h={};if((c.arrays||c.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),u.ihave&&u.ihave.length){h.ihave=[];for(var l=0;l<u.ihave.length;++l)h.ihave[l]=s.RPC.ControlIHave.toObject(u.ihave[l],c)}if(u.iwant&&u.iwant.length){h.iwant=[];for(var l=0;l<u.iwant.length;++l)h.iwant[l]=s.RPC.ControlIWant.toObject(u.iwant[l],c)}if(u.graft&&u.graft.length){h.graft=[];for(var l=0;l<u.graft.length;++l)h.graft[l]=s.RPC.ControlGraft.toObject(u.graft[l],c)}if(u.prune&&u.prune.length){h.prune=[];for(var l=0;l<u.prune.length;++l)h.prune[l]=s.RPC.ControlPrune.toObject(u.prune[l],c)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null,a.prototype.messageIDs=n.emptyArray;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){if(h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),c.messageIDs!=null&&c.messageIDs.length)for(var l=0;l<c.messageIDs.length;++l)h.uint32(18).bytes(c.messageIDs[l]);return h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.ControlIHave;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.topicID=c.string();break;case 2:g.messageIDs&&g.messageIDs.length||(g.messageIDs=[]),g.messageIDs.push(c.bytes());break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.ControlIHave)return c;var h=new s.RPC.ControlIHave;if(c.topicID!=null&&(h.topicID=String(c.topicID)),c.messageIDs){if(!Array.isArray(c.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var l=0;l<c.messageIDs.length;++l)typeof c.messageIDs[l]=="string"?n.base64.decode(c.messageIDs[l],h.messageIDs[l]=n.newBuffer(n.base64.length(c.messageIDs[l])),0):c.messageIDs[l].length&&(h.messageIDs[l]=c.messageIDs[l])}return h},a.toObject=function(c,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.messageIDs=[]),c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),c.messageIDs&&c.messageIDs.length){l.messageIDs=[];for(var g=0;g<c.messageIDs.length;++g)l.messageIDs[g]=h.bytes===String?n.base64.encode(c.messageIDs[g],0,c.messageIDs[g].length):h.bytes===Array?Array.prototype.slice.call(c.messageIDs[g]):c.messageIDs[g]}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlIWant=function(){function a(f){if(this.messageIDs=[],f)for(var u=Object.keys(f),c=0;c<u.length;++c)f[u[c]]!=null&&(this[u[c]]=f[u[c]])}return a.prototype.messageIDs=n.emptyArray,a.encode=function(u,c){if(c||(c=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var h=0;h<u.messageIDs.length;++h)c.uint32(10).bytes(u.messageIDs[h]);return c},a.decode=function(u,c){u instanceof e||(u=e.create(u));for(var h=c===void 0?u.len:u.pos+c,l=new s.RPC.ControlIWant;u.pos<h;){var g=u.uint32();switch(g>>>3){case 1:l.messageIDs&&l.messageIDs.length||(l.messageIDs=[]),l.messageIDs.push(u.bytes());break;default:u.skipType(g&7);break}}return l},a.fromObject=function(u){if(u instanceof s.RPC.ControlIWant)return u;var c=new s.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");c.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)typeof u.messageIDs[h]=="string"?n.base64.decode(u.messageIDs[h],c.messageIDs[h]=n.newBuffer(n.base64.length(u.messageIDs[h])),0):u.messageIDs[h].length&&(c.messageIDs[h]=u.messageIDs[h])}return c},a.toObject=function(u,c){c||(c={});var h={};if((c.arrays||c.defaults)&&(h.messageIDs=[]),u.messageIDs&&u.messageIDs.length){h.messageIDs=[];for(var l=0;l<u.messageIDs.length;++l)h.messageIDs[l]=c.bytes===String?n.base64.encode(u.messageIDs[l],0,u.messageIDs[l].length):c.bytes===Array?Array.prototype.slice.call(u.messageIDs[l]):u.messageIDs[l]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlGraft=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.ControlGraft;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.topicID=c.string();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.ControlGraft)return c;var h=new s.RPC.ControlGraft;return c.topicID!=null&&(h.topicID=String(c.topicID)),h},a.toObject=function(c,h){h||(h={});var l={};return c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null,a.prototype.peers=n.emptyArray,a.prototype.backoff=null;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_backoff",{get:n.oneOfGetter(f=["backoff"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){if(h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),c.peers!=null&&c.peers.length)for(var l=0;l<c.peers.length;++l)s.RPC.PeerInfo.encode(c.peers[l],h.uint32(18).fork()).ldelim();return c.backoff!=null&&Object.hasOwnProperty.call(c,"backoff")&&h.uint32(24).uint64(c.backoff),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.ControlPrune;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.topicID=c.string();break;case 2:g.peers&&g.peers.length||(g.peers=[]),g.peers.push(s.RPC.PeerInfo.decode(c,c.uint32()));break;case 3:g.backoff=c.uint64();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.ControlPrune)return c;var h=new s.RPC.ControlPrune;if(c.topicID!=null&&(h.topicID=String(c.topicID)),c.peers){if(!Array.isArray(c.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var l=0;l<c.peers.length;++l){if(typeof c.peers[l]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[l]=s.RPC.PeerInfo.fromObject(c.peers[l])}}return c.backoff!=null&&(n.Long?(h.backoff=n.Long.fromValue(c.backoff)).unsigned=!0:typeof c.backoff=="string"?h.backoff=parseInt(c.backoff,10):typeof c.backoff=="number"?h.backoff=c.backoff:typeof c.backoff=="object"&&(h.backoff=new n.LongBits(c.backoff.low>>>0,c.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(c,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.peers=[]),c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),c.peers&&c.peers.length){l.peers=[];for(var g=0;g<c.peers.length;++g)l.peers[g]=s.RPC.PeerInfo.toObject(c.peers[g],h)}return c.backoff!=null&&c.hasOwnProperty("backoff")&&(typeof c.backoff=="number"?l.backoff=h.longs===String?String(c.backoff):c.backoff:l.backoff=h.longs===String?n.Long.prototype.toString.call(c.backoff):h.longs===Number?new n.LongBits(c.backoff.low>>>0,c.backoff.high>>>0).toNumber(!0):c.backoff,h.oneofs&&(l._backoff="backoff")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.PeerInfo=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var f;return Object.defineProperty(a.prototype,"_peerID",{get:n.oneOfGetter(f=["peerID"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:n.oneOfGetter(f=["signedPeerRecord"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.peerID!=null&&Object.hasOwnProperty.call(c,"peerID")&&h.uint32(10).bytes(c.peerID),c.signedPeerRecord!=null&&Object.hasOwnProperty.call(c,"signedPeerRecord")&&h.uint32(18).bytes(c.signedPeerRecord),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.PeerInfo;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.peerID=c.bytes();break;case 2:g.signedPeerRecord=c.bytes();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.PeerInfo)return c;var h=new s.RPC.PeerInfo;return c.peerID!=null&&(typeof c.peerID=="string"?n.base64.decode(c.peerID,h.peerID=n.newBuffer(n.base64.length(c.peerID)),0):c.peerID.length&&(h.peerID=c.peerID)),c.signedPeerRecord!=null&&(typeof c.signedPeerRecord=="string"?n.base64.decode(c.signedPeerRecord,h.signedPeerRecord=n.newBuffer(n.base64.length(c.signedPeerRecord)),0):c.signedPeerRecord.length&&(h.signedPeerRecord=c.signedPeerRecord)),h},a.toObject=function(c,h){h||(h={});var l={};return c.peerID!=null&&c.hasOwnProperty("peerID")&&(l.peerID=h.bytes===String?n.base64.encode(c.peerID,0,c.peerID.length):h.bytes===Array?Array.prototype.slice.call(c.peerID):c.peerID,h.oneofs&&(l._peerID="peerID")),c.signedPeerRecord!=null&&c.hasOwnProperty("signedPeerRecord")&&(l.signedPeerRecord=h.bytes===String?n.base64.encode(c.signedPeerRecord,0,c.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(c.signedPeerRecord):c.signedPeerRecord,h.oneofs&&(l._signedPeerRecord="signedPeerRecord")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i}(),s})});var ku=W((Hx,Du)=>{"use strict";function ve(t,r){var r=r||{};this._capacity=r.capacity,this._head=0,this._tail=0,Array.isArray(t)?this._fromArray(t):(this._capacityMask=3,this._list=new Array(4))}ve.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};ve.prototype.get=function(e){return this.peekAt(e)};ve.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};ve.prototype.peekFront=function(){return this.peek()};ve.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(ve.prototype,"length",{get:function(){return this.size()}});ve.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ve.prototype.unshift=function(e){if(arguments.length===0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ve.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};ve.prototype.push=function(e){if(arguments.length===0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ve.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};ve.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),s=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var i=this._list[r],o;if(e<n/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+s&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+s&this._capacityMask}else{for(o=n-1-e;o>0;o--)this._list[r]=this._list[r=r+1+s&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+s&this._capacityMask}return i}}};ve.prototype.remove=function(e,r){var n=e,s,i=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return s=new Array(1),s[0]=this.removeOne(n),s;if(n===0&&n+r>=o)return s=this.toArray(),this.clear(),s;n+r>o&&(r=o-n);var f;for(s=new Array(r),f=0;f<r;f++)s[f]=this._list[this._head+n+f&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,f=r;f>0;f--)this._list[n=n+1+a&this._capacityMask]=void 0;return s}if(e===0){for(this._head=this._head+r+a&this._capacityMask,f=r-1;f>0;f--)this._list[n=n+1+a&this._capacityMask]=void 0;return s}if(n<o/2){for(this._head=this._head+e+r+a&this._capacityMask,f=e;f>0;f--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;i>0;)this._list[n=n-1+a&this._capacityMask]=void 0,i--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,f=o-(r+e);f>0;f--)this.push(this._list[n++]);for(n=this._tail;i>0;)this._list[n=n+1+a&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),s}}};ve.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var s=this.size();if(n<0&&(n+=s),!(n>s))if(arguments.length>2){var i,o,a,f=arguments.length,u=this._list.length,c=2;if(!s||n<s/2){for(o=new Array(n),i=0;i<n;i++)o[i]=this._list[this._head+i&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+u&this._capacityMask);f>c;)this.unshift(arguments[--f]);for(i=n;i>0;i--)this.unshift(o[i-1])}else{o=new Array(s-(n+r));var h=o.length;for(i=0;i<h;i++)o[i]=this._list[this._head+n+r+i&this._capacityMask];for(r===0?(a=[],n!=s&&(this._tail=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-h+u&this._capacityMask);c<f;)this.push(arguments[c++]);for(i=0;i<h;i++)this.push(o[i])}return a}else return this.remove(n,r)}};ve.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0};ve.prototype.isEmpty=function(){return this._head===this._tail};ve.prototype.toArray=function(){return this._copyArray(!1)};ve.prototype._fromArray=function(e){var r=e.length,n=this._nextPowerOf2(r);this._list=new Array(n),this._capacityMask=n-1,this._tail=r;for(var s=0;s<r;s++)this._list[s]=e[s]};ve.prototype._copyArray=function(e,r){var n=this._list,s=n.length,i=this.length;if(r=r|i,r==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o=new Array(r),a=0,f;if(e||this._head>this._tail){for(f=this._head;f<s;f++)o[a++]=n[f];for(f=0;f<this._tail;f++)o[a++]=n[f]}else for(f=this._head;f<this._tail;f++)o[a++]=n[f];return o};ve.prototype._growArray=function(){if(this._head!=0){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};ve.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};ve.prototype._nextPowerOf2=function(e){var r=Math.log(e)/Math.log(2),n=1<<r+1;return Math.max(n,4)};Du.exports=ve});var ce=W((bv,Ou)=>{Ou.exports={options:{usePureJavaScript:!1}}});var Ku=W((xv,Fu)=>{var lo={};Fu.exports=lo;var Uu={};lo.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Lp(t,e);else{var s=0,i=e.length,o=e.charAt(0),a=[0];for(s=0;s<t.length;++s){for(var f=0,u=t[s];f<a.length;++f)u+=a[f]<<8,a[f]=u%i,u=u/i|0;for(;u>0;)a.push(u%i),u=u/i|0}for(s=0;t[s]===0&&s<t.length-1;++s)n+=o;for(s=a.length-1;s>=0;--s)n+=e[a[s]]}if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join(`\r
`)}return n};lo.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Uu[e];if(!r){r=Uu[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var s=e.length,i=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var f=0,u=a;f<o.length;++f)u+=o[f]*s,o[f]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var c=0;t[c]===i&&c<t.length-1;++c)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function Lp(t,e){var r=0,n=e.length,s=e.charAt(0),i=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<i.length;++o)a+=i[o]<<8,i[o]=a%n,a=a/n|0;for(;a>0;)i.push(a%n),a=a/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=s;for(r=i.length-1;r>=0;--r)f+=e[i[r]];return f}});var Be=W((vv,Hu)=>{var qu=ce(),Vu=Ku(),x=Hu.exports=qu.util=qu.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){x.nextTick=process.nextTick,typeof setImmediate=="function"?x.setImmediate=setImmediate:x.setImmediate=x.nextTick;return}if(typeof setImmediate=="function"){x.setImmediate=function(){return setImmediate.apply(void 0,arguments)},x.nextTick=function(a){return setImmediate(a)};return}if(x.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(c){c()})}};var o=a,t="forge.setImmediate",e=[];x.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,s=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(u){u()})}).observe(s,{attributes:!0});var i=x.setImmediate;x.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),i(f)):(e.push(f),e.length===1&&s.setAttribute("a",n=!n))}}x.nextTick=x.setImmediate})();x.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;x.globalScope=function(){return x.isNodejs?globalThis:typeof self>"u"?window:self}();x.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};x.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};x.isArrayBufferView=function(t){return t&&x.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function On(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}x.ByteBuffer=po;function po(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(x.isArrayBuffer(t)||x.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof po||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}x.ByteStringBuffer=po;var Op=4096;x.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>Op&&(this.data.substr(0,1),this._constructedStringLength=0)};x.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};x.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};x.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};x.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};x.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};x.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(x.encodeUtf8(t))};x.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};x.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};x.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};x.ByteStringBuffer.prototype.putInt=function(t,e){On(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};x.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};x.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};x.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};x.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};x.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};x.ByteStringBuffer.prototype.getInt=function(t){On(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};x.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};x.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};x.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};x.ByteStringBuffer.prototype.copy=function(){var t=x.createBuffer(this.data);return t.read=this.read,t};x.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};x.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};x.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};x.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.ByteStringBuffer.prototype.toString=function(){return x.decodeUtf8(this.bytes())};function Up(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=x.isArrayBuffer(t),n=x.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}x.DataBuffer=Up;x.DataBuffer.prototype.length=function(){return this.write-this.read};x.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};x.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};x.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};x.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};x.DataBuffer.prototype.putBytes=function(t,e){if(x.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var s=new Uint8Array(this.data.buffer,this.write);return s.set(r),this.write+=n,this}if(x.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var s=new Uint8Array(this.data.buffer);return s.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof x.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&x.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var s=new Uint8Array(t.data.byteLength,this.write);return s.set(r),this.write+=r.byteLength,this}if(t instanceof x.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var i;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.hex.decode(t,i,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),i=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.base64.decode(t,i,this.write),this;if(e==="utf8"&&(t=x.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.raw.decode(i),this;if(e==="utf16")return this.accommodate(t.length*2),i=new Uint16Array(this.data.buffer,this.write),this.write+=x.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};x.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};x.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};x.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};x.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};x.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};x.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};x.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};x.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};x.DataBuffer.prototype.putInt=function(t,e){On(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};x.DataBuffer.prototype.putSignedInt=function(t,e){return On(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};x.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};x.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};x.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};x.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};x.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};x.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};x.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};x.DataBuffer.prototype.getInt=function(t){On(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};x.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};x.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};x.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};x.DataBuffer.prototype.copy=function(){return new x.DataBuffer(this)};x.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};x.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};x.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};x.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return x.binary.raw.encode(e);if(t==="hex")return x.binary.hex.encode(e);if(t==="base64")return x.binary.base64.encode(e);if(t==="utf8")return x.text.utf8.decode(e);if(t==="utf16")return x.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};x.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=x.encodeUtf8(t)),new x.ByteBuffer(t)};x.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};x.xorBytes=function(t,e,r){for(var n="",s="",i="",o=0,a=0;r>0;--r,++o)s=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=i,i="",a=0),i+=String.fromCharCode(s),++a;return n+=i,n};x.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};x.bytesToHex=function(t){return x.createBuffer(t).toHex()};x.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var sr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ir=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],zu="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";x.encode64=function(t,e){for(var r="",n="",s,i,o,a=0;a<t.length;)s=t.charCodeAt(a++),i=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=sr.charAt(s>>2),r+=sr.charAt((s&3)<<4|i>>4),isNaN(i)?r+="==":(r+=sr.charAt((i&15)<<2|o>>6),r+=isNaN(o)?"=":sr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,s,i,o=0;o<t.length;)r=ir[t.charCodeAt(o++)-43],n=ir[t.charCodeAt(o++)-43],s=ir[t.charCodeAt(o++)-43],i=ir[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),s!==64&&(e+=String.fromCharCode((n&15)<<4|s>>2),i!==64&&(e+=String.fromCharCode((s&3)<<6|i)));return e};x.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};x.decodeUtf8=function(t){return decodeURIComponent(escape(t))};x.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Vu.encode,decode:Vu.decode}};x.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};x.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var s=r,i=0;i<t.length;++i)n[s++]=t.charCodeAt(i);return e?s-r:n};x.binary.hex.encode=x.bytesToHex;x.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var s=0,i=r;for(t.length&1&&(s=1,n[i++]=parseInt(t[0],16));s<t.length;s+=2)n[i++]=parseInt(t.substr(s,2),16);return e?i-r:n};x.binary.base64.encode=function(t,e){for(var r="",n="",s,i,o,a=0;a<t.byteLength;)s=t[a++],i=t[a++],o=t[a++],r+=sr.charAt(s>>2),r+=sr.charAt((s&3)<<4|i>>4),isNaN(i)?r+="==":(r+=sr.charAt((i&15)<<2|o>>6),r+=isNaN(o)?"=":sr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var s,i,o,a,f=0,u=r;f<t.length;)s=ir[t.charCodeAt(f++)-43],i=ir[t.charCodeAt(f++)-43],o=ir[t.charCodeAt(f++)-43],a=ir[t.charCodeAt(f++)-43],n[u++]=s<<2|i>>4,o!==64&&(n[u++]=(i&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return e?u-r:n.subarray(0,u)};x.binary.base58.encode=function(t,e){return x.binary.baseN.encode(t,zu,e)};x.binary.base58.decode=function(t,e){return x.binary.baseN.decode(t,zu,e)};x.text={utf8:{},utf16:{}};x.text.utf8.encode=function(t,e,r){t=x.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var s=r,i=0;i<t.length;++i)n[s++]=t.charCodeAt(i);return e?s-r:n};x.text.utf8.decode=function(t){return x.decodeUtf8(String.fromCharCode.apply(null,t))};x.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var s=new Uint16Array(n.buffer);r=r||0;for(var i=r,o=r,a=0;a<t.length;++a)s[o++]=t.charCodeAt(a),i+=2;return e?i-r:n};x.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};x.deflate=function(t,e,r){if(e=x.decode64(t.deflate(x.encode64(e)).rval),r){var n=2,s=e.charCodeAt(1);s&32&&(n=6),e=e.substring(n,e.length-4)}return e};x.inflate=function(t,e,r){var n=t.inflate(x.encode64(e)).rval;return n===null?null:x.decode64(n)};var go=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=x.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var s=new Error(n.error.message);throw s.id=n.error.id,s.name=n.error.name,s}},yo=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(x.decode64(r))),r},Fp=function(t,e,r,n){var s=yo(t,e);s===null&&(s={}),s[r]=n,go(t,e,s)},Kp=function(t,e,r){var n=yo(t,e);return n!==null&&(n=r in n?n[r]:null),n},qp=function(t,e,r){var n=yo(t,e);if(n!==null&&r in n){delete n[r];var s=!0;for(var i in n){s=!1;break}s&&(n=null),go(t,e,n)}},Vp=function(t,e){go(t,e,null)},Bs=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var s,i=!1,o=null;for(var a in r){s=r[a];try{if(s==="flash"||s==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),i=s==="flash"}(s==="web"||s==="both")&&(e[0]=localStorage,n=t.apply(this,e),i=!0)}catch(f){o=f}if(i)break}if(!i)throw o;return n};x.setItem=function(t,e,r,n,s){Bs(Fp,arguments,s)};x.getItem=function(t,e,r,n){return Bs(Kp,arguments,n)};x.removeItem=function(t,e,r,n){Bs(qp,arguments,n)};x.clearItems=function(t,e,r){Bs(Vp,arguments,r)};x.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};x.format=function(t){for(var e=/%./g,r,n,s=0,i=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&i.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":s<arguments.length?i.push(arguments[s+++1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+a+"?>")}}return i.push(t.substring(o)),i.join("")};x.formatNumber=function(t,e,r,n){var s=t,i=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,f=s<0?"-":"",u=parseInt(s=Math.abs(+s||0).toFixed(i),10)+"",c=u.length>3?u.length%3:0;return f+(c?u.substr(0,c)+a:"")+u.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+a)+(i?o+Math.abs(s-u).toFixed(i).slice(2):"")};x.formatSize=function(t){return t>=1073741824?t=x.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=x.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=x.formatNumber(t/1024,0)+" KiB":t=x.formatNumber(t,0)+" bytes",t};x.bytesFromIP=function(t){return t.indexOf(".")!==-1?x.bytesFromIPv4(t):t.indexOf(":")!==-1?x.bytesFromIPv6(t):null};x.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=x.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};x.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=x.createBuffer(),s=0;s<8;++s){if(!t[s]||t[s].length===0){n.fillWithByte(0,r),r=0;continue}var i=x.hexToBytes(t[s]);i.length<2&&n.putByte(0),n.putBytes(i)}return n.getBytes()};x.bytesToIP=function(t){return t.length===4?x.bytesToIPv4(t):t.length===16?x.bytesToIPv6(t):null};x.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};x.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,s=0;s<t.length;s+=2){for(var i=x.bytesToHex(t[s]+t[s+1]);i[0]==="0"&&i!=="0";)i=i.substr(1);if(i==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(i)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};x.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in x&&!t.update)return e(null,x.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return x.cores=navigator.hardwareConcurrency,e(null,x.cores);if(typeof Worker>"u")return x.cores=1,e(null,x.cores);if(typeof Blob>"u")return x.cores=2,e(null,x.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,f){if(a===0){var u=Math.floor(o.reduce(function(c,h){return c+h},0)/o.length);return x.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,x.cores)}s(f,function(c,h){o.push(i(f,h)),n(o,a-1,f)})}function s(o,a){for(var f=[],u=[],c=0;c<o;++c){var h=new Worker(r);h.addEventListener("message",function(l){if(u.push(l.data),u.length===o){for(var g=0;g<o;++g)f[g].terminate();a(null,u)}}),f.push(h)}for(var c=0;c<o;++c)f[c].postMessage(c)}function i(o,a){for(var f=[],u=0;u<o;++u)for(var c=a[u],h=f[u]=[],l=0;l<o;++l)if(u!==l){var g=a[l];(c.st>g.st&&c.st<g.et||g.st>c.st&&g.st<c.et)&&h.push(l)}return f.reduce(function(p,d){return Math.max(p,d.length)},0)}}});var bo=W((wv,Gu)=>{var Me=ce();Be();Gu.exports=Me.cipher=Me.cipher||{};Me.cipher.algorithms=Me.cipher.algorithms||{};Me.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Me.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Me.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Me.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Me.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Me.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Me.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Me.cipher.algorithms[t]=e};Me.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Me.cipher.algorithms?Me.cipher.algorithms[t]:null};var mo=Me.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};mo.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Me.util.createBuffer(),this.output=t.output||Me.util.createBuffer(),this.mode.start(e)};mo.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};mo.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var vo=W((Sv,Wu)=>{var Ne=ce();Be();Ne.cipher=Ne.cipher||{};var Q=Wu.exports=Ne.cipher.modes=Ne.cipher.modes||{};Q.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Q.ecb.prototype.start=function(t){};Q.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Q.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Q.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Q.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Q.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Q.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Ts(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Q.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Q.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Q.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Q.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Q.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0};Q.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ts(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)this._inBlock[s]=t.getInt32()^this._outBlock[s],e.putInt32(this._inBlock[s]);return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialBlock[s]=t.getInt32()^this._outBlock[s],this._partialOutput.putInt32(this._partialBlock[s]);if(i>0)t.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)this._inBlock[s]=t.getInt32(),e.putInt32(this._inBlock[s]^this._outBlock[s]);return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialBlock[s]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[s]^this._outBlock[s]);if(i>0)t.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0};Q.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ts(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)e.putInt32(t.getInt32()^this._outBlock[s]),this._inBlock[s]=this._outBlock[s];return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(t.getInt32()^this._outBlock[s]);if(i>0)t.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._outBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.ofb.prototype.decrypt=Q.ofb.prototype.encrypt;Q.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0};Q.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ts(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var s=0;s<this._ints;++s)e.putInt32(t.getInt32()^this._outBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(t.getInt32()^this._outBlock[s]);if(i>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}As(this._inBlock)};Q.ctr.prototype.decrypt=Q.ctr.prototype.encrypt;Q.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Q.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Ne.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Ne.util.createBuffer(t.additionalData):r=Ne.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Ne.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(xo(n*8)))}this._inBlock=this._j0.slice(0),As(this._inBlock),this._partialBytes=0,r=Ne.util.createBuffer(r),this._aDataLength=xo(r.length()*8);var s=r.length()%this.blockSize;for(s&&r.fillWithByte(0,this.blockSize-s),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Q.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)e.putInt32(this._outBlock[s]^=t.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(t.getInt32()^this._outBlock[s]);if(i<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var s=0;s<this._ints;++s)this._outBlock[s]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),As(this._inBlock)};Q.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),As(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var s=0;s<this._ints;++s)e.putInt32(this._outBlock[s]^this._hashBlock[s]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Q.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Ne.util.createBuffer();var n=this._aDataLength.concat(xo(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var s=[];this.cipher.encrypt(this._j0,s);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^s[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Q.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),s=0;s<128;++s){var i=t[s/32|0]&1<<31-s%32;i&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Q.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Q.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,s=t[n]>>>(7-r%8)*4&15,i=this._m[r][s];e[0]^=i[0],e[1]^=i[1],e[2]^=i[2],e[3]^=i[3]}return e};Q.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Q.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,s=16*r,i=new Array(s),o=0;o<s;++o){var a=[0,0,0,0],f=o/n|0,u=(n-1-o%n)*e;a[f]=1<<e-1<<u,i[o]=this.generateSubHashTable(this.multiply(a,t),e)}return i};Q.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,s=new Array(r);s[n]=t.slice(0);for(var i=n>>>1;i>0;)this.pow(s[2*i],s[i]=[]),i>>=1;for(i=2;i<n;){for(var o=1;o<i;++o){var a=s[i],f=s[o];s[i+o]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}i*=2}for(s[0]=[0,0,0,0],i=n+1;i<r;++i){var u=s[i^n];s[i]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return s};function Ts(t,e){if(typeof t=="string"&&(t=Ne.util.createBuffer(t)),Ne.util.isArray(t)&&t.length>4){var r=t;t=Ne.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Ne.util.isArray(t)){for(var s=[],i=e/4,n=0;n<i;++n)s.push(t.getInt32());t=s}return t}function As(t){t[t.length-1]=t[t.length-1]+1&4294967295}function xo(t){return[t/4294967296|0,t&4294967295]}});var Ps=W((Ev,Zu)=>{var pe=ce();bo();vo();Be();Zu.exports=pe.aes=pe.aes||{};pe.aes.startEncrypting=function(t,e,r,n){var s=Cs({key:t,output:r,decrypt:!1,mode:n});return s.start(e),s};pe.aes.createEncryptionCipher=function(t,e){return Cs({key:t,output:null,decrypt:!1,mode:e})};pe.aes.startDecrypting=function(t,e,r,n){var s=Cs({key:t,output:r,decrypt:!0,mode:n});return s.start(e),s};pe.aes.createDecryptionCipher=function(t,e){return Cs({key:t,output:null,decrypt:!0,mode:e})};pe.aes.Algorithm=function(t,e){Eo||$u();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,s){return So(r._w,n,s,!1)},decrypt:function(n,s){return So(r._w,n,s,!0)}}}),r._init=!1};pe.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=pe.util.createBuffer(e);else if(pe.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=pe.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!pe.util.isArray(e)){r=e,e=[];var s=r.length();if(s===16||s===24||s===32){s=s>>>2;for(var n=0;n<s;++n)e.push(r.getInt32())}}if(!pe.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var i=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(i)!==-1;this._w=Yu(e,t.decrypt&&!o),this._init=!0}};pe.aes._expandKey=function(t,e){return Eo||$u(),Yu(t,e)};pe.aes._updateBlock=So;cn("AES-ECB",pe.cipher.modes.ecb);cn("AES-CBC",pe.cipher.modes.cbc);cn("AES-CFB",pe.cipher.modes.cfb);cn("AES-OFB",pe.cipher.modes.ofb);cn("AES-CTR",pe.cipher.modes.ctr);cn("AES-GCM",pe.cipher.modes.gcm);function cn(t,e){var r=function(){return new pe.aes.Algorithm(t,e)};pe.cipher.registerAlgorithm(t,r)}var Eo=!1,an=4,Xe,wo,ju,Ar,bt;function $u(){Eo=!0,ju=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Xe=new Array(256),wo=new Array(256),Ar=new Array(4),bt=new Array(4);for(var e=0;e<4;++e)Ar[e]=new Array(256),bt[e]=new Array(256);for(var r=0,n=0,s,i,o,a,f,u,c,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Xe[r]=a,wo[a]=r,f=t[a],s=t[r],i=t[s],o=t[i],u=f<<24^a<<16^a<<8^(a^f),c=(s^i^o)<<24^(r^o)<<16^(r^i^o)<<8^(r^s^o);for(var h=0;h<4;++h)Ar[h][r]=u,bt[h][a]=c,u=u<<24|u>>>8,c=c<<24|c>>>8;r===0?r=n=1:(r=s^t[t[t[s^o]]],n^=t[t[n]])}}function Yu(t,e){for(var r=t.slice(0),n,s=1,i=r.length,o=i+6+1,a=an*o,f=i;f<a;++f)n=r[f-1],f%i===0?(n=Xe[n>>>16&255]<<24^Xe[n>>>8&255]<<16^Xe[n&255]<<8^Xe[n>>>24]^ju[s]<<24,s++):i>6&&f%i===4&&(n=Xe[n>>>24]<<24^Xe[n>>>16&255]<<16^Xe[n>>>8&255]<<8^Xe[n&255]),r[f]=r[f-i]^n;if(e){var u,c=bt[0],h=bt[1],l=bt[2],g=bt[3],p=r.slice(0);a=r.length;for(var f=0,d=a-an;f<a;f+=an,d-=an)if(f===0||f===a-an)p[f]=r[d],p[f+1]=r[d+3],p[f+2]=r[d+2],p[f+3]=r[d+1];else for(var y=0;y<an;++y)u=r[d+y],p[f+(3&-y)]=c[Xe[u>>>24]]^h[Xe[u>>>16&255]]^l[Xe[u>>>8&255]]^g[Xe[u&255]];r=p}return r}function So(t,e,r,n){var s=t.length/4-1,i,o,a,f,u;n?(i=bt[0],o=bt[1],a=bt[2],f=bt[3],u=wo):(i=Ar[0],o=Ar[1],a=Ar[2],f=Ar[3],u=Xe);var c,h,l,g,p,d,y;c=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],g=e[n?1:3]^t[3];for(var m=3,E=1;E<s;++E)p=i[c>>>24]^o[h>>>16&255]^a[l>>>8&255]^f[g&255]^t[++m],d=i[h>>>24]^o[l>>>16&255]^a[g>>>8&255]^f[c&255]^t[++m],y=i[l>>>24]^o[g>>>16&255]^a[c>>>8&255]^f[h&255]^t[++m],g=i[g>>>24]^o[c>>>16&255]^a[h>>>8&255]^f[l&255]^t[++m],c=p,h=d,l=y;r[0]=u[c>>>24]<<24^u[h>>>16&255]<<16^u[l>>>8&255]<<8^u[g&255]^t[++m],r[n?3:1]=u[h>>>24]<<24^u[l>>>16&255]<<16^u[g>>>8&255]<<8^u[c&255]^t[++m],r[2]=u[l>>>24]<<24^u[g>>>16&255]<<16^u[c>>>8&255]<<8^u[h&255]^t[++m],r[n?1:3]=u[g>>>24]<<24^u[c>>>16&255]<<16^u[h>>>8&255]<<8^u[l&255]^t[++m]}function Cs(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=pe.cipher.createDecipher(r,t.key):n=pe.cipher.createCipher(r,t.key);var s=n.start;return n.start=function(i,o){var a=null;o instanceof pe.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=i,s.call(n,o)},n}});var Ds=W((Hv,ef)=>{var Un=ce();Un.pki=Un.pki||{};var Io=ef.exports=Un.pki.oids=Un.oids=Un.oids||{};function R(t,e){Io[t]=e,Io[e]=t}function oe(t,e){Io[t]=e}R("1.2.840.113549.1.1.1","rsaEncryption");R("1.2.840.113549.1.1.4","md5WithRSAEncryption");R("1.2.840.113549.1.1.5","sha1WithRSAEncryption");R("1.2.840.113549.1.1.7","RSAES-OAEP");R("1.2.840.113549.1.1.8","mgf1");R("1.2.840.113549.1.1.9","pSpecified");R("1.2.840.113549.1.1.10","RSASSA-PSS");R("1.2.840.113549.1.1.11","sha256WithRSAEncryption");R("1.2.840.113549.1.1.12","sha384WithRSAEncryption");R("1.2.840.113549.1.1.13","sha512WithRSAEncryption");R("1.3.101.112","EdDSA25519");R("1.2.840.10040.4.3","dsa-with-sha1");R("1.3.14.3.2.7","desCBC");R("1.3.14.3.2.26","sha1");R("1.3.14.3.2.29","sha1WithRSASignature");R("2.16.840.1.101.3.4.2.1","sha256");R("2.16.840.1.101.3.4.2.2","sha384");R("2.16.840.1.101.3.4.2.3","sha512");R("2.16.840.1.101.3.4.2.4","sha224");R("2.16.840.1.101.3.4.2.5","sha512-224");R("2.16.840.1.101.3.4.2.6","sha512-256");R("1.2.840.113549.2.2","md2");R("1.2.840.113549.2.5","md5");R("1.2.840.113549.1.7.1","data");R("1.2.840.113549.1.7.2","signedData");R("1.2.840.113549.1.7.3","envelopedData");R("1.2.840.113549.1.7.4","signedAndEnvelopedData");R("1.2.840.113549.1.7.5","digestedData");R("1.2.840.113549.1.7.6","encryptedData");R("1.2.840.113549.1.9.1","emailAddress");R("1.2.840.113549.1.9.2","unstructuredName");R("1.2.840.113549.1.9.3","contentType");R("1.2.840.113549.1.9.4","messageDigest");R("1.2.840.113549.1.9.5","signingTime");R("1.2.840.113549.1.9.6","counterSignature");R("1.2.840.113549.1.9.7","challengePassword");R("1.2.840.113549.1.9.8","unstructuredAddress");R("1.2.840.113549.1.9.14","extensionRequest");R("1.2.840.113549.1.9.20","friendlyName");R("1.2.840.113549.1.9.21","localKeyId");R("1.2.840.113549.1.9.22.1","x509Certificate");R("1.2.840.113549.1.12.10.1.1","keyBag");R("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");R("1.2.840.113549.1.12.10.1.3","certBag");R("1.2.840.113549.1.12.10.1.4","crlBag");R("1.2.840.113549.1.12.10.1.5","secretBag");R("1.2.840.113549.1.12.10.1.6","safeContentsBag");R("1.2.840.113549.1.5.13","pkcs5PBES2");R("1.2.840.113549.1.5.12","pkcs5PBKDF2");R("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");R("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");R("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");R("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");R("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");R("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");R("1.2.840.113549.2.7","hmacWithSHA1");R("1.2.840.113549.2.8","hmacWithSHA224");R("1.2.840.113549.2.9","hmacWithSHA256");R("1.2.840.113549.2.10","hmacWithSHA384");R("1.2.840.113549.2.11","hmacWithSHA512");R("1.2.840.113549.3.7","des-EDE3-CBC");R("2.16.840.1.101.3.4.1.2","aes128-CBC");R("2.16.840.1.101.3.4.1.22","aes192-CBC");R("2.16.840.1.101.3.4.1.42","aes256-CBC");R("2.5.4.3","commonName");R("2.5.4.4","surname");R("2.5.4.5","serialNumber");R("2.5.4.6","countryName");R("2.5.4.7","localityName");R("2.5.4.8","stateOrProvinceName");R("2.5.4.9","streetAddress");R("2.5.4.10","organizationName");R("2.5.4.11","organizationalUnitName");R("2.5.4.12","title");R("2.5.4.13","description");R("2.5.4.15","businessCategory");R("2.5.4.17","postalCode");R("2.5.4.42","givenName");R("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");R("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");R("2.16.840.1.113730.1.1","nsCertType");R("2.16.840.1.113730.1.13","nsComment");oe("2.5.29.1","authorityKeyIdentifier");oe("2.5.29.2","keyAttributes");oe("2.5.29.3","certificatePolicies");oe("2.5.29.4","keyUsageRestriction");oe("2.5.29.5","policyMapping");oe("2.5.29.6","subtreesConstraint");oe("2.5.29.7","subjectAltName");oe("2.5.29.8","issuerAltName");oe("2.5.29.9","subjectDirectoryAttributes");oe("2.5.29.10","basicConstraints");oe("2.5.29.11","nameConstraints");oe("2.5.29.12","policyConstraints");oe("2.5.29.13","basicConstraints");R("2.5.29.14","subjectKeyIdentifier");R("2.5.29.15","keyUsage");oe("2.5.29.16","privateKeyUsagePeriod");R("2.5.29.17","subjectAltName");R("2.5.29.18","issuerAltName");R("2.5.29.19","basicConstraints");oe("2.5.29.20","cRLNumber");oe("2.5.29.21","cRLReason");oe("2.5.29.22","expirationDate");oe("2.5.29.23","instructionCode");oe("2.5.29.24","invalidityDate");oe("2.5.29.25","cRLDistributionPoints");oe("2.5.29.26","issuingDistributionPoint");oe("2.5.29.27","deltaCRLIndicator");oe("2.5.29.28","issuingDistributionPoint");oe("2.5.29.29","certificateIssuer");oe("2.5.29.30","nameConstraints");R("2.5.29.31","cRLDistributionPoints");R("2.5.29.32","certificatePolicies");oe("2.5.29.33","policyMappings");oe("2.5.29.34","policyConstraints");R("2.5.29.35","authorityKeyIdentifier");oe("2.5.29.36","policyConstraints");R("2.5.29.37","extKeyUsage");oe("2.5.29.46","freshestCRL");oe("2.5.29.54","inhibitAnyPolicy");R("1.3.6.1.4.1.11129.2.4.2","timestampList");R("1.3.6.1.5.5.7.1.1","authorityInfoAccess");R("1.3.6.1.5.5.7.3.1","serverAuth");R("1.3.6.1.5.5.7.3.2","clientAuth");R("1.3.6.1.5.5.7.3.3","codeSigning");R("1.3.6.1.5.5.7.3.4","emailProtection");R("1.3.6.1.5.5.7.3.8","timeStamping")});var Kn=W((Gv,rf)=>{var de=ce();Be();Ds();var N=rf.exports=de.asn1=de.asn1||{};N.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};N.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};N.create=function(t,e,r,n,s){if(de.util.isArray(n)){for(var i=[],o=0;o<n.length;++o)n[o]!==void 0&&i.push(n[o]);n=i}var a={tagClass:t,type:e,constructed:r,composed:r||de.util.isArray(n),value:n};return s&&"bitStringContents"in s&&(a.bitStringContents=s.bitStringContents,a.original=N.copy(a)),a};N.copy=function(t,e){var r;if(de.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(N.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:N.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};N.equals=function(t,e,r){if(de.util.isArray(t)){if(!de.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!N.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var s=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&N.equals(t.value,e.value);return r&&r.includeBitStringContents&&(s=s&&t.bitStringContents===e.bitStringContents),s};N.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Fn(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var jp=function(t,e){var r=t.getByte();if(e--,r!==128){var n,s=r&128;if(!s)n=r;else{var i=r&127;Fn(t,e,i),n=t.getInt(i<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};N.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=de.util.createBuffer(t));var r=t.length(),n=ks(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var s=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw s.byteCount=r,s.remaining=t.length(),s}return n};function ks(t,e,r,n){var s;Fn(t,e,2);var i=t.getByte();e--;var o=i&192,a=i&31;s=t.length();var f=jp(t,e);if(e-=s-t.length(),f!==void 0&&f>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=f,u}f=e}var c,h,l=(i&32)===32;if(l)if(c=[],f===void 0)for(;;){if(Fn(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}s=t.length(),c.push(ks(t,e,r+1,n)),e-=s-t.length()}else for(;f>0;)s=t.length(),c.push(ks(t,f,r+1,n)),e-=s-t.length(),f-=s-t.length();if(c===void 0&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&(h=t.bytes(f)),c===void 0&&n.decodeBitStrings&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&f>1){var g=t.read,p=e,d=0;if(a===N.Type.BITSTRING&&(Fn(t,e,1),d=t.getByte(),e--),d===0)try{s=t.length();var y={strict:!0,decodeBitStrings:!0},m=ks(t,e,r+1,y),E=s-t.length();e-=E,a==N.Type.BITSTRING&&E++;var v=m.tagClass;E===f&&(v===N.Class.UNIVERSAL||v===N.Class.CONTEXT_SPECIFIC)&&(c=[m])}catch{}c===void 0&&(t.read=g,e=p)}if(c===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(a===N.Type.BMPSTRING)for(c="";f>0;f-=2)Fn(t,e,2),c+=String.fromCharCode(t.getInt16()),e-=2;else c=t.getBytes(f),e-=f}var T=h===void 0?null:{bitStringContents:h};return N.create(o,a,l,c,T)}N.toDer=function(t){var e=de.util.createBuffer(),r=t.tagClass|t.type,n=de.util.createBuffer(),s=!1;if("bitStringContents"in t&&(s=!0,t.original&&(s=N.equals(t,t.original))),s)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var i=0;i<t.value.length;++i)t.value[i]!==void 0&&n.putBuffer(N.toDer(t.value[i]))}else if(t.type===N.Type.BMPSTRING)for(var i=0;i<t.value.length;++i)n.putInt16(t.value.charCodeAt(i));else t.type===N.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var i=a.length-1;i>=0;--i)e.putByte(a.charCodeAt(i))}return e.putBuffer(n),e};N.oidToDer=function(t){var e=t.split("."),r=de.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,s,i,o,a=2;a<e.length;++a){n=!0,s=[],i=parseInt(e[a],10);do o=i&127,i=i>>>7,n||(o|=128),s.push(o),n=!1;while(i>0);for(var f=s.length-1;f>=0;--f)r.putByte(s[f])}return r};N.derToOid=function(t){var e;typeof t=="string"&&(t=de.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};N.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,s=parseInt(t.substr(4,2),10),i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var f=t.charAt(10),u=10;f!=="+"&&f!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,s),e.setUTCHours(i,o,a,0),u&&(f=t.charAt(u),f==="+"||f==="-")){var c=parseInt(t.substr(u+1,2),10),h=parseInt(t.substr(u+4,2),10),l=c*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};N.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,s=parseInt(t.substr(6,2),10),i=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),f=0,u=0,c=!1;t.charAt(t.length-1)==="Z"&&(c=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var g=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);u=g*60+p,u*=6e4,l==="+"&&(u*=-1),c=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),c?(e.setUTCFullYear(r,n,s),e.setUTCHours(i,o,a,f),e.setTime(+e+u)):(e.setFullYear(r,n,s),e.setHours(i,o,a,f)),e};N.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};N.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};N.integerToDer=function(t){var e=de.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};N.derToInteger=function(t){typeof t=="string"&&(t=de.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};N.validate=function(t,e,r,n){var s=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(s=!0,e.value&&de.util.isArray(e.value))for(var i=0,o=0;s&&o<e.value.length;++o)s=e.value[o].optional||!1,t.value[i]&&(s=N.validate(t.value[i],e.value[o],r,n),s?++i:e.value[o].optional&&(s=!0)),!s&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(s&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return s};var tf=/[^\\u0000-\\u00ff]/;N.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var s="",i=0;i<e*r;++i)s+=" ";switch(n+=s+"Tag: ",t.tagClass){case N.Class.UNIVERSAL:n+="Universal:";break;case N.Class.APPLICATION:n+="Application:";break;case N.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case N.Class.PRIVATE:n+="Private:";break}if(t.tagClass===N.Class.UNIVERSAL)switch(n+=t.type,t.type){case N.Type.NONE:n+=" (None)";break;case N.Type.BOOLEAN:n+=" (Boolean)";break;case N.Type.INTEGER:n+=" (Integer)";break;case N.Type.BITSTRING:n+=" (Bit string)";break;case N.Type.OCTETSTRING:n+=" (Octet string)";break;case N.Type.NULL:n+=" (Null)";break;case N.Type.OID:n+=" (Object Identifier)";break;case N.Type.ODESC:n+=" (Object Descriptor)";break;case N.Type.EXTERNAL:n+=" (External or Instance of)";break;case N.Type.REAL:n+=" (Real)";break;case N.Type.ENUMERATED:n+=" (Enumerated)";break;case N.Type.EMBEDDED:n+=" (Embedded PDV)";break;case N.Type.UTF8:n+=" (UTF8)";break;case N.Type.ROID:n+=" (Relative Object Identifier)";break;case N.Type.SEQUENCE:n+=" (Sequence)";break;case N.Type.SET:n+=" (Set)";break;case N.Type.PRINTABLESTRING:n+=" (Printable String)";break;case N.Type.IA5String:n+=" (IA5String (ASCII))";break;case N.Type.UTCTIME:n+=" (UTC time)";break;case N.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case N.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=s+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",i=0;i<t.value.length;++i)t.value[i]!==void 0&&(o+=1,a+=N.prettyPrint(t.value[i],e+1,r),i+1<t.value.length&&(a+=","));n+=s+"Sub values: "+o+a}else{if(n+=s+"Value: ",t.type===N.Type.OID){var f=N.derToOid(t.value);n+=f,de.pki&&de.pki.oids&&f in de.pki.oids&&(n+=" ("+de.pki.oids[f]+") ")}if(t.type===N.Type.INTEGER)try{n+=N.derToInteger(t.value)}catch{n+="0x"+de.util.bytesToHex(t.value)}else if(t.type===N.Type.BITSTRING){if(t.value.length>1?n+="0x"+de.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===N.Type.OCTETSTRING)tf.test(t.value)||(n+="("+t.value+") "),n+="0x"+de.util.bytesToHex(t.value);else if(t.type===N.Type.UTF8)try{n+=de.util.decodeUtf8(t.value)}catch(c){if(c.message==="URI malformed")n+="0x"+de.util.bytesToHex(t.value)+" (malformed UTF8)";else throw c}else t.type===N.Type.PRINTABLESTRING||t.type===N.Type.IA5String?n+=t.value:tf.test(t.value)?n+="0x"+de.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var of=W((Wv,sf)=>{var ye=ce();bo();vo();Be();sf.exports=ye.des=ye.des||{};ye.des.startEncrypting=function(t,e,r,n){var s=Ms({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return s.start(e),s};ye.des.createEncryptionCipher=function(t,e){return Ms({key:t,output:null,decrypt:!1,mode:e})};ye.des.startDecrypting=function(t,e,r,n){var s=Ms({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return s.start(e),s};ye.des.createDecryptionCipher=function(t,e){return Ms({key:t,output:null,decrypt:!0,mode:e})};ye.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,s){return nf(r._keys,n,s,!1)},decrypt:function(n,s){return nf(r._keys,n,s,!0)}}}),r._init=!1};ye.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=ye.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=rd(e),this._init=!0}};Tt("DES-ECB",ye.cipher.modes.ecb);Tt("DES-CBC",ye.cipher.modes.cbc);Tt("DES-CFB",ye.cipher.modes.cfb);Tt("DES-OFB",ye.cipher.modes.ofb);Tt("DES-CTR",ye.cipher.modes.ctr);Tt("3DES-ECB",ye.cipher.modes.ecb);Tt("3DES-CBC",ye.cipher.modes.cbc);Tt("3DES-CFB",ye.cipher.modes.cfb);Tt("3DES-OFB",ye.cipher.modes.ofb);Tt("3DES-CTR",ye.cipher.modes.ctr);function Tt(t,e){var r=function(){return new ye.des.Algorithm(t,e)};ye.cipher.registerAlgorithm(t,r)}var $p=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Yp=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Zp=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Qp=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Xp=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Jp=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],ed=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],td=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function rd(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,v,T=0;T<d;T++){var b=t.getInt32(),S=t.getInt32();v=(b>>>4^S)&252645135,S^=v,b^=v<<4,v=(S>>>-16^b)&65535,b^=v,S^=v<<-16,v=(b>>>2^S)&858993459,S^=v,b^=v<<2,v=(S>>>-16^b)&65535,b^=v,S^=v<<-16,v=(b>>>1^S)&1431655765,S^=v,b^=v<<1,v=(S>>>8^b)&16711935,b^=v,S^=v<<8,v=(b>>>1^S)&1431655765,S^=v,b^=v<<1,v=b<<8|S>>>20&240,b=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=v;for(var I=0;I<m.length;++I){m[I]?(b=b<<2|b>>>26,S=S<<2|S>>>26):(b=b<<1|b>>>27,S=S<<1|S>>>27),b&=-15,S&=-15;var C=e[b>>>28]|r[b>>>24&15]|n[b>>>20&15]|s[b>>>16&15]|i[b>>>12&15]|o[b>>>8&15]|a[b>>>4&15],F=f[S>>>28]|u[S>>>24&15]|c[S>>>20&15]|h[S>>>16&15]|l[S>>>12&15]|g[S>>>8&15]|p[S>>>4&15];v=(F>>>16^C)&65535,y[E++]=C^v,y[E++]=F^v<<16}}return y}function nf(t,e,r,n){var s=t.length===32?3:9,i;s===3?i=n?[30,-2,-2]:[0,32,2]:i=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],f=e[1];o=(a>>>4^f)&252645135,f^=o,a^=o<<4,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var u=0;u<s;u+=3){for(var c=i[u+1],h=i[u+2],l=i[u];l!=c;l+=h){var g=f^t[l],p=(f>>>4|f<<28)^t[l+1];o=a,a=f,f=o^(Yp[g>>>24&63]|Qp[g>>>16&63]|Jp[g>>>8&63]|td[g&63]|$p[p>>>24&63]|Zp[p>>>16&63]|Xp[p>>>8&63]|ed[p&63])}o=a,a=f,f=o}a=a>>>1|a<<31,f=f>>>1|f<<31,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(a>>>4^f)&252645135,f^=o,a^=o<<4,r[0]=a,r[1]=f}function Ms(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=ye.cipher.createDecipher(r,t.key):n=ye.cipher.createCipher(r,t.key);var s=n.start;return n.start=function(i,o){var a=null;o instanceof ye.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=i,s.call(n,o)},n}});var Cr=W((jv,af)=>{var Ns=ce();af.exports=Ns.md=Ns.md||{};Ns.md.algorithms=Ns.md.algorithms||{}});var uf=W(($v,cf)=>{var Kt=ce();Cr();Be();var nd=cf.exports=Kt.hmac=Kt.hmac||{};nd.create=function(){var t=null,e=null,r=null,n=null,s={};return s.start=function(i,o){if(i!==null)if(typeof i=="string")if(i=i.toLowerCase(),i in Kt.md.algorithms)e=Kt.md.algorithms[i].create();else throw new Error('Unknown hash algorithm "'+i+'"');else e=i;if(o===null)o=t;else{if(typeof o=="string")o=Kt.util.createBuffer(o);else if(Kt.util.isArray(o)){var a=o;o=Kt.util.createBuffer();for(var f=0;f<a.length;++f)o.putByte(a[f])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Kt.util.createBuffer(),n=Kt.util.createBuffer(),u=o.length();for(var f=0;f<u;++f){var a=o.at(f);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,f=0;f<a;++f)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},s.update=function(i){e.update(i)},s.getMac=function(){var i=e.digest().bytes();return e.start(),e.update(n),e.update(i),e.digest()},s.digest=s.getMac,s}});var Ls=W(()=>{});var Bo=W((Qv,ff)=>{var Je=ce();uf();Cr();Be();var sd=Je.pkcs5=Je.pkcs5||{},qt;Je.util.isNodejs&&!Je.options.usePureJavaScript&&(qt=Ls());ff.exports=Je.pbkdf2=sd.pbkdf2=function(t,e,r,n,s,i){if(typeof s=="function"&&(i=s,s=null),Je.util.isNodejs&&!Je.options.usePureJavaScript&&qt.pbkdf2&&(s===null||typeof s!="object")&&(qt.pbkdf2Sync.length>4||!s||s==="sha1"))return typeof s!="string"&&(s="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),i?qt.pbkdf2Sync.length===4?qt.pbkdf2(t,e,r,n,function(v,T){if(v)return i(v);i(null,T.toString("binary"))}):qt.pbkdf2(t,e,r,n,s,function(v,T){if(v)return i(v);i(null,T.toString("binary"))}):qt.pbkdf2Sync.length===4?qt.pbkdf2Sync(t,e,r,n).toString("binary"):qt.pbkdf2Sync(t,e,r,n,s).toString("binary");if((typeof s>"u"||s===null)&&(s="sha1"),typeof s=="string"){if(!(s in Je.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=Je.md[s].create()}var o=s.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(i)return i(a);throw a}var f=Math.ceil(n/o),u=n-(f-1)*o,c=Je.hmac.create();c.start(s,t);var h="",l,g,p;if(!i){for(var d=1;d<=f;++d){c.start(null,null),c.update(e),c.update(Je.util.int32ToBytes(d)),l=p=c.digest().getBytes();for(var y=2;y<=r;++y)c.start(null,null),c.update(p),g=c.digest().getBytes(),l=Je.util.xorBytes(l,g,o),p=g;h+=d<f?l:l.substr(0,u)}return h}var d=1,y;function m(){if(d>f)return i(null,h);c.start(null,null),c.update(e),c.update(Je.util.int32ToBytes(d)),l=p=c.digest().getBytes(),y=2,E()}function E(){if(y<=r)return c.start(null,null),c.update(p),g=c.digest().getBytes(),l=Je.util.xorBytes(l,g,o),p=g,++y,Je.util.setImmediate(E);h+=d<f?l:l.substr(0,u),++d,m()}m()}});var pf=W((Xv,lf)=>{var Us=ce();Be();var hf=lf.exports=Us.pem=Us.pem||{};hf.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Os(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Os(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Os(n)),t.headers)for(var s=0;s<t.headers.length;++s)r+=Os(t.headers[s]);return t.procType&&(r+=`\r
`),r+=Us.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};hf.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,s=/\r?\n/,i;i=r.exec(t),!!i;){var o=i[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Us.util.decode64(i[3])};if(e.push(a),!!i[2]){for(var f=i[2].split(s),u=0;i&&u<f.length;){for(var c=f[u].replace(/\s+$/,""),h=u+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;c+=l,u=h}if(i=c.match(n),i){for(var g={name:i[1],values:[]},p=i[2].split(","),d=0;d<p.length;++d)g.values.push(id(p[d]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Os(t){for(var e=t.name+": ",r=[],n=function(f,u){return" "+u},s=0;s<t.values.length;++s)r.push(t.values[s].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var i=0,o=-1,s=0;s<e.length;++s,++i)if(i>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),i=s-o-1,o=-1,++s}else(e[s]===" "||e[s]==="	"||e[s]===",")&&(o=s);return e}function id(t){return t.replace(/^\s+/,"")}});var xf=W((Jv,bf)=>{var At=ce();Cr();Be();var gf=bf.exports=At.sha256=At.sha256||{};At.md.sha256=At.md.algorithms.sha256=gf;gf.create=function(){yf||od();var t=null,e=At.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var s=n.messageLengthSize/4,i=0;i<s;++i)n.fullMessageLength.push(0);return e=At.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(s,i){i==="utf8"&&(s=At.util.encodeUtf8(s));var o=s.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(s),df(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var s=At.util.createBuffer();s.putBytes(e.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=i&n.blockLength-1;s.putBytes(To.substr(0,n.blockLength-o));for(var a,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,f=a/4294967296>>>0,u+=f,s.putInt32(u>>>0),u=a>>>0;s.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};df(h,r,s);var l=At.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var To=null,yf=!1,mf=null;function od(){To=String.fromCharCode(128),To+=At.util.fillString(String.fromCharCode(0),64),mf=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],yf=!0}function df(t,e,r){for(var n,s,i,o,a,f,u,c,h,l,g,p,d,y,m,E=r.length();E>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,s=e[u-15],s=(s>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,e[u]=n+e[u-7]+s+e[u-16]|0;for(c=t.h0,h=t.h1,l=t.h2,g=t.h3,p=t.h4,d=t.h5,y=t.h6,m=t.h7,u=0;u<64;++u)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=y^p&(d^y),i=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),f=c&h|l&(c^h),n=m+o+a+mf[u]+e[u],s=i+f,m=y,y=d,d=p,p=g+n>>>0,g=l,l=h,h=c,c=n+s>>>0;t.h0=t.h0+c|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+g|0,t.h4=t.h4+p|0,t.h5=t.h5+d|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var wf=W((ew,vf)=>{var Ct=ce();Be();var Fs=null;Ct.util.isNodejs&&!Ct.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Fs=Ls());var ad=vf.exports=Ct.prng=Ct.prng||{};ad.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),s=0;s<32;++s)n[s]=r.create();e.pools=n,e.pool=0,e.generate=function(u,c){if(!c)return e.generateSync(u);var h=e.plugin.cipher,l=e.plugin.increment,g=e.plugin.formatKey,p=e.plugin.formatSeed,d=Ct.util.createBuffer();e.key=null,y();function y(m){if(m)return c(m);if(d.length()>=u)return c(null,d.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Ct.util.nextTick(function(){i(y)});var E=h(e.key,e.seed);e.generated+=E.length,d.putBytes(E),e.key=g(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Ct.util.setImmediate(y)}},e.generateSync=function(u){var c=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,g=e.plugin.formatSeed;e.key=null;for(var p=Ct.util.createBuffer();p.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var d=c(e.key,e.seed);e.generated+=d.length,p.putBytes(d),e.key=l(c(e.key,h(e.seed))),e.seed=g(c(e.key,e.seed))}return p.getBytes(u)};function i(u){if(e.pools[0].messageLength>=32)return a(),u();var c=32-e.pools[0].messageLength<<5;e.seedFile(c,function(h,l){if(h)return u(h);e.collect(l),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var c=1,h=0;h<32;++h)e.reseeds%c===0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),c=c<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var l=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(u){var c=null,h=Ct.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(c=function(b){return l.getRandomValues(b)});var g=Ct.util.createBuffer();if(c)for(;g.length()<u;){var p=Math.max(1,Math.min(u-g.length(),65536)/4),d=new Uint32Array(Math.floor(p));try{c(d);for(var y=0;y<d.length;++y)g.putInt32(d[y])}catch(b){if(!(typeof QuotaExceededError<"u"&&b instanceof QuotaExceededError))throw b}}if(g.length()<u)for(var m,E,v,T=Math.floor(Math.random()*65536);g.length()<u;){E=16807*(T&65535),m=16807*(T>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),T=E&4294967295;for(var y=0;y<3;++y)v=T>>>(y<<3),v^=Math.floor(Math.random()*256),g.putByte(v&255)}return g.getBytes(u)}return Fs?(e.seedFile=function(u,c){Fs.randomBytes(u,function(h,l){if(h)return c(h);c(null,l.toString())})},e.seedFileSync=function(u){return Fs.randomBytes(u).toString()}):(e.seedFile=function(u,c){try{c(null,f(u))}catch(h){c(h)}},e.seedFileSync=f),e.collect=function(u){for(var c=u.length,h=0;h<c;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,c){for(var h="",l=0;l<c;l+=8)h+=String.fromCharCode(u>>l&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,l){function g(p){var d=p.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",g),l(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var c=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(g,p){u.postMessage({forge:{prng:{err:g,bytes:p}}})})};u.addEventListener("message",c)}},e}});var qn=W((tw,Ao)=>{var Le=ce();Ps();xf();wf();Be();(function(){if(Le.random&&Le.random.getBytes){Ao.exports=Le.random;return}(function(t){var e={},r=new Array(4),n=Le.util.createBuffer();e.formatKey=function(h){var l=Le.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Le.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Le.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Le.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Le.md.sha256;function s(){var h=Le.prng.create(e);return h.getBytes=function(l,g){return h.generate(l,g)},h.getBytesSync=function(l){return h.generate(l)},h}var i=s(),o=null,a=Le.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),Le.options.usePureJavaScript||!Le.util.isNodejs&&!o){if(typeof window>"u"||window.document,i.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var c in navigator)try{typeof navigator[c]=="string"&&(u+=navigator[c])}catch{}i.collect(u),u=null}t&&(t().mousemove(function(h){i.collectInt(h.clientX,16),i.collectInt(h.clientY,16)}),t().keypress(function(h){i.collectInt(h.charCode,8)}))}if(!Le.random)Le.random=i;else for(var c in i)Le.random[c]=i[c];Le.random.createInstance=s,Ao.exports=Le.random})(typeof jQuery<"u"?jQuery:null)})()});var If=W((rw,_f)=>{var nt=ce();Be();var Co=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Sf=[1,2,3,5],cd=function(t,e){return t<<e&65535|(t&65535)>>16-e},ud=function(t,e){return(t&65535)>>e|t<<16-e&65535};_f.exports=nt.rc2=nt.rc2||{};nt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=nt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),s=e,i=Math.ceil(s/8),o=255>>(s&7),a;for(a=n;a<128;a++)r.putByte(Co[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-i,Co[r.at(128-i)&o]),a=127-i;a>=0;a--)r.setAt(a,Co[r.at(a+1)^r.at(a+i)]);return r};var Ef=function(t,e,r){var n=!1,s=null,i=null,o=null,a,f,u,c,h=[];for(t=nt.rc2.expandKey(t,e),u=0;u<64;u++)h.push(t.getInt16Le());r?(a=function(p){for(u=0;u<4;u++)p[u]+=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=cd(p[u],Sf[u]),c++},f=function(p){for(u=0;u<4;u++)p[u]+=h[p[(u+3)%4]&63]}):(a=function(p){for(u=3;u>=0;u--)p[u]=ud(p[u],Sf[u]),p[u]-=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),c--},f=function(p){for(u=3;u>=0;u--)p[u]-=h[p[(u+3)%4]&63]});var l=function(p){var d=[];for(u=0;u<4;u++){var y=s.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),d.push(y&65535)}c=r?0:63;for(var m=0;m<p.length;m++)for(var E=0;E<p[m][0];E++)p[m][1](d);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(d[u]):d[u]^=o.getInt16Le()),i.putInt16Le(d[u])},g=null;return g={start:function(p,d){p&&typeof p=="string"&&(p=nt.util.createBuffer(p)),n=!1,s=nt.util.createBuffer(),i=d||new nt.util.createBuffer,o=p,g.output=i},update:function(p){for(n||s.putBuffer(p);s.length()>=8;)l([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(p){var d=!0;if(r)if(p)d=p(8,s,!r);else{var y=s.length()===8?8:8-s.length();s.fillWithByte(y,y)}if(d&&(n=!0,g.update()),!r&&(d=s.length()===0,d))if(p)d=p(8,i,!r);else{var m=i.length(),E=i.at(m-1);E>m?d=!1:i.truncate(E)}return d}},g};nt.rc2.startEncrypting=function(t,e,r){var n=nt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};nt.rc2.createEncryptionCipher=function(t,e){return Ef(t,e,!0)};nt.rc2.startDecrypting=function(t,e,r){var n=nt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};nt.rc2.createDecryptionCipher=function(t,e){return Ef(t,e,!1)}});var Vs=W((nw,kf)=>{var Po=ce();kf.exports=Po.jsbn=Po.jsbn||{};var Vt,fd=0xdeadbeefcafe,Bf=(fd&16777215)==15715070;function A(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Po.jsbn.BigInteger=A;function ne(){return new A(null)}function hd(t,e,r,n,s,i){for(;--i>=0;){var o=e*this.data[t++]+r.data[n]+s;s=Math.floor(o/67108864),r.data[n++]=o&67108863}return s}function ld(t,e,r,n,s,i){for(var o=e&32767,a=e>>15;--i>=0;){var f=this.data[t]&32767,u=this.data[t++]>>15,c=a*f+u*o;f=o*f+((c&32767)<<15)+r.data[n]+(s&1073741823),s=(f>>>30)+(c>>>15)+a*u+(s>>>30),r.data[n++]=f&1073741823}return s}function Tf(t,e,r,n,s,i){for(var o=e&16383,a=e>>14;--i>=0;){var f=this.data[t]&16383,u=this.data[t++]>>14,c=a*f+u*o;f=o*f+((c&16383)<<14)+r.data[n]+s,s=(f>>28)+(c>>14)+a*u,r.data[n++]=f&268435455}return s}typeof navigator>"u"?(A.prototype.am=Tf,Vt=28):Bf&&navigator.appName=="Microsoft Internet Explorer"?(A.prototype.am=ld,Vt=30):Bf&&navigator.appName!="Netscape"?(A.prototype.am=hd,Vt=26):(A.prototype.am=Tf,Vt=28);A.prototype.DB=Vt;A.prototype.DM=(1<<Vt)-1;A.prototype.DV=1<<Vt;var Ro=52;A.prototype.FV=Math.pow(2,Ro);A.prototype.F1=Ro-Vt;A.prototype.F2=2*Vt-Ro;var pd="0123456789abcdefghijklmnopqrstuvwxyz",Ks=new Array,un,ut;un="0".charCodeAt(0);for(ut=0;ut<=9;++ut)Ks[un++]=ut;un="a".charCodeAt(0);for(ut=10;ut<36;++ut)Ks[un++]=ut;un="A".charCodeAt(0);for(ut=10;ut<36;++ut)Ks[un++]=ut;function Af(t){return pd.charAt(t)}function Cf(t,e){var r=Ks[t.charCodeAt(e)];return r??-1}function dd(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function gd(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function or(t){var e=ne();return e.fromInt(t),e}function yd(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,s=!1,i=0;--n>=0;){var o=r==8?t[n]&255:Cf(t,n);if(o<0){t.charAt(n)=="-"&&(s=!0);continue}s=!1,i==0?this.data[this.t++]=o:i+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-i)-1)<<i,this.data[this.t++]=o>>this.DB-i):this.data[this.t-1]|=o<<i,i+=r,i>=this.DB&&(i-=this.DB)}r==8&&t[0]&128&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),s&&A.ZERO.subTo(this,this)}function md(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function bd(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,s=!1,i="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(s=!0,i=Af(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(s=!0),s&&(i+=Af(n));return s?i:"0"}function xd(){var t=ne();return A.ZERO.subTo(this,t),t}function vd(){return this.s<0?this.negate():this}function wd(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function qs(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Sd(){return this.t<=0?0:this.DB*(this.t-1)+qs(this.data[this.t-1]^this.s&this.DM)}function Ed(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function _d(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Id(t,e){var r=t%this.DB,n=this.DB-r,s=(1<<n)-1,i=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+i+1]=this.data[a]>>n|o,o=(this.data[a]&s)<<r;for(a=i-1;a>=0;--a)e.data[a]=0;e.data[i]=o,e.t=this.t+i+1,e.s=this.s,e.clamp()}function Bd(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,s=this.DB-n,i=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&i)<<s,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&i)<<s),e.t=this.t-r,e.clamp()}function Td(t,e){for(var r=0,n=0,s=Math.min(t.t,this.t);r<s;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Ad(t,e){var r=this.abs(),n=t.abs(),s=r.t;for(e.t=s+n.t;--s>=0;)e.data[s]=0;for(s=0;s<n.t;++s)e.data[s+r.t]=r.am(0,n.data[s],e,s,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&A.ZERO.subTo(e,e)}function Cd(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Pd(t,e,r){var n=t.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ne());var i=ne(),o=this.s,a=t.s,f=this.DB-qs(n.data[n.t-1]);f>0?(n.lShiftTo(f,i),s.lShiftTo(f,r)):(n.copyTo(i),s.copyTo(r));var u=i.t,c=i.data[u-1];if(c!=0){var h=c*(1<<this.F1)+(u>1?i.data[u-2]>>this.F2:0),l=this.FV/h,g=(1<<this.F1)/h,p=1<<this.F2,d=r.t,y=d-u,m=e??ne();for(i.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),A.ONE.dlShiftTo(u,m),m.subTo(i,i);i.t<u;)i.data[i.t++]=0;for(;--y>=0;){var E=r.data[--d]==c?this.DM:Math.floor(r.data[d]*l+(r.data[d-1]+p)*g);if((r.data[d]+=i.am(0,E,r,y,0,u))<E)for(i.dlShiftTo(y,m),r.subTo(m,r);r.data[d]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&A.ZERO.subTo(e,e)),r.t=u,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&A.ZERO.subTo(r,r)}}}function Rd(t){var e=ne();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(A.ZERO)>0&&t.subTo(e,e),e}function Pr(t){this.m=t}function Dd(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function kd(t){return t}function Md(t){t.divRemTo(this.m,null,t)}function Nd(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Ld(t,e){t.squareTo(e),this.reduce(e)}Pr.prototype.convert=Dd;Pr.prototype.revert=kd;Pr.prototype.reduce=Md;Pr.prototype.mulTo=Nd;Pr.prototype.sqrTo=Ld;function Od(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Rr(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Ud(t){var e=ne();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(A.ZERO)>0&&this.m.subTo(e,e),e}function Fd(t){var e=ne();return t.copyTo(e),this.reduce(e),e}function Kd(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function qd(t,e){t.squareTo(e),this.reduce(e)}function Vd(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Rr.prototype.convert=Ud;Rr.prototype.revert=Fd;Rr.prototype.reduce=Kd;Rr.prototype.mulTo=Vd;Rr.prototype.sqrTo=qd;function zd(){return(this.t>0?this.data[0]&1:this.s)==0}function Hd(t,e){if(t>4294967295||t<1)return A.ONE;var r=ne(),n=ne(),s=e.convert(this),i=qs(t)-1;for(s.copyTo(r);--i>=0;)if(e.sqrTo(r,n),(t&1<<i)>0)e.mulTo(n,s,r);else{var o=r;r=n,n=o}return e.revert(r)}function Gd(t,e){var r;return t<256||e.isEven()?r=new Pr(e):r=new Rr(e),this.exp(t,r)}A.prototype.copyTo=dd;A.prototype.fromInt=gd;A.prototype.fromString=yd;A.prototype.clamp=md;A.prototype.dlShiftTo=Ed;A.prototype.drShiftTo=_d;A.prototype.lShiftTo=Id;A.prototype.rShiftTo=Bd;A.prototype.subTo=Td;A.prototype.multiplyTo=Ad;A.prototype.squareTo=Cd;A.prototype.divRemTo=Pd;A.prototype.invDigit=Od;A.prototype.isEven=zd;A.prototype.exp=Hd;A.prototype.toString=bd;A.prototype.negate=xd;A.prototype.abs=vd;A.prototype.compareTo=wd;A.prototype.bitLength=Sd;A.prototype.mod=Rd;A.prototype.modPowInt=Gd;A.ZERO=or(0);A.ONE=or(1);function Wd(){var t=ne();return this.copyTo(t),t}function jd(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function $d(){return this.t==0?this.s:this.data[0]<<24>>24}function Yd(){return this.t==0?this.s:this.data[0]<<16>>16}function Zd(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Qd(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Xd(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=or(r),s=ne(),i=ne(),o="";for(this.divRemTo(n,s,i);s.signum()>0;)o=(r+i.intValue()).toString(t).substr(1)+o,s.divRemTo(n,s,i);return i.intValue().toString(t)+o}function Jd(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),s=!1,i=0,o=0,a=0;a<t.length;++a){var f=Cf(t,a);if(f<0){t.charAt(a)=="-"&&this.signum()==0&&(s=!0);continue}o=e*o+f,++i>=r&&(this.dMultiply(n),this.dAddOffset(o,0),i=0,o=0)}i>0&&(this.dMultiply(Math.pow(e,i)),this.dAddOffset(o,0)),s&&A.ZERO.subTo(this,this)}function eg(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(A.ONE.shiftLeft(t-1),Do,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(A.ONE.shiftLeft(t-1),this);else{var n=new Array,s=t&7;n.length=(t>>3)+1,e.nextBytes(n),s>0?n[0]&=(1<<s)-1:n[0]=0,this.fromString(n,256)}}function tg(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,s=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[s++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),s==0&&(this.s&128)!=(n&128)&&++s,(s>0||n!=this.s)&&(e[s++]=n);return e}function rg(t){return this.compareTo(t)==0}function ng(t){return this.compareTo(t)<0?this:t}function sg(t){return this.compareTo(t)>0?this:t}function ig(t,e,r){var n,s,i=Math.min(t.t,this.t);for(n=0;n<i;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(s=t.s&this.DM,n=i;n<this.t;++n)r.data[n]=e(this.data[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=i;n<t.t;++n)r.data[n]=e(s,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function og(t,e){return t&e}function ag(t){var e=ne();return this.bitwiseTo(t,og,e),e}function Do(t,e){return t|e}function cg(t){var e=ne();return this.bitwiseTo(t,Do,e),e}function Pf(t,e){return t^e}function ug(t){var e=ne();return this.bitwiseTo(t,Pf,e),e}function Rf(t,e){return t&~e}function fg(t){var e=ne();return this.bitwiseTo(t,Rf,e),e}function hg(){for(var t=ne(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function lg(t){var e=ne();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function pg(t){var e=ne();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function dg(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function gg(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+dg(this.data[t]);return this.s<0?this.t*this.DB:-1}function yg(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function mg(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=yg(this.data[r]^e);return t}function bg(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function xg(t,e){var r=A.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function vg(t){return this.changeBit(t,Do)}function wg(t){return this.changeBit(t,Rf)}function Sg(t){return this.changeBit(t,Pf)}function Eg(t,e){for(var r=0,n=0,s=Math.min(t.t,this.t);r<s;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function _g(t){var e=ne();return this.addTo(t,e),e}function Ig(t){var e=ne();return this.subTo(t,e),e}function Bg(t){var e=ne();return this.multiplyTo(t,e),e}function Tg(t){var e=ne();return this.divRemTo(t,e,null),e}function Ag(t){var e=ne();return this.divRemTo(t,null,e),e}function Cg(t){var e=ne(),r=ne();return this.divRemTo(t,e,r),new Array(e,r)}function Pg(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Rg(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Vn(){}function Df(t){return t}function Dg(t,e,r){t.multiplyTo(e,r)}function kg(t,e){t.squareTo(e)}Vn.prototype.convert=Df;Vn.prototype.revert=Df;Vn.prototype.mulTo=Dg;Vn.prototype.sqrTo=kg;function Mg(t){return this.exp(t,new Vn)}function Ng(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var s;for(s=r.t-this.t;n<s;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(s=Math.min(t.t,e);n<s;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Lg(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function fn(t){this.r2=ne(),this.q3=ne(),A.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Og(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ne();return t.copyTo(e),this.reduce(e),e}function Ug(t){return t}function Fg(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Kg(t,e){t.squareTo(e),this.reduce(e)}function qg(t,e,r){t.multiplyTo(e,r),this.reduce(r)}fn.prototype.convert=Og;fn.prototype.revert=Ug;fn.prototype.reduce=Fg;fn.prototype.mulTo=qg;fn.prototype.sqrTo=Kg;function Vg(t,e){var r=t.bitLength(),n,s=or(1),i;if(r<=0)return s;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?i=new Pr(e):e.isEven()?i=new fn(e):i=new Rr(e);var o=new Array,a=3,f=n-1,u=(1<<n)-1;if(o[1]=i.convert(this),n>1){var c=ne();for(i.sqrTo(o[1],c);a<=u;)o[a]=ne(),i.mulTo(c,o[a-2],o[a]),a+=2}var h=t.t-1,l,g=!0,p=ne(),d;for(r=qs(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&u:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[l].copyTo(s),g=!1;else{for(;a>1;)i.sqrTo(s,p),i.sqrTo(p,s),a-=2;a>0?i.sqrTo(s,p):(d=s,s=p,p=d),i.mulTo(p,o[l],s)}for(;h>=0&&!(t.data[h]&1<<r);)i.sqrTo(s,p),d=s,s=p,p=d,--r<0&&(r=this.DB-1,--h)}return i.revert(s)}function zg(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var s=e.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return e;for(s<i&&(i=s),i>0&&(e.rShiftTo(i,e),r.rShiftTo(i,r));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r}function Hg(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Gg(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return A.ZERO;for(var r=t.clone(),n=this.clone(),s=or(1),i=or(0),o=or(0),a=or(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!s.isEven()||!i.isEven())&&(s.addTo(this,s),i.subTo(t,i)),s.rShiftTo(1,s)):i.isEven()||i.subTo(t,i),i.rShiftTo(1,i);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&s.subTo(o,s),i.subTo(a,i)):(n.subTo(r,n),e&&o.subTo(s,o),a.subTo(i,a))}if(n.compareTo(A.ONE)!=0)return A.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var xt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Wg=(1<<26)/xt[xt.length-1];function jg(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=xt[xt.length-1]){for(e=0;e<xt.length;++e)if(r.data[0]==xt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<xt.length;){for(var n=xt[e],s=e+1;s<xt.length&&n<Wg;)n*=xt[s++];for(n=r.modInt(n);e<s;)if(n%xt[e++]==0)return!1}return r.millerRabin(t)}function $g(t){var e=this.subtract(A.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),s=Yg(),i,o=0;o<t;++o){do i=new A(this.bitLength(),s);while(i.compareTo(A.ONE)<=0||i.compareTo(e)>=0);var a=i.modPow(n,this);if(a.compareTo(A.ONE)!=0&&a.compareTo(e)!=0){for(var f=1;f++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(A.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function Yg(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}A.prototype.chunkSize=Zd;A.prototype.toRadix=Xd;A.prototype.fromRadix=Jd;A.prototype.fromNumber=eg;A.prototype.bitwiseTo=ig;A.prototype.changeBit=xg;A.prototype.addTo=Eg;A.prototype.dMultiply=Pg;A.prototype.dAddOffset=Rg;A.prototype.multiplyLowerTo=Ng;A.prototype.multiplyUpperTo=Lg;A.prototype.modInt=Hg;A.prototype.millerRabin=$g;A.prototype.clone=Wd;A.prototype.intValue=jd;A.prototype.byteValue=$d;A.prototype.shortValue=Yd;A.prototype.signum=Qd;A.prototype.toByteArray=tg;A.prototype.equals=rg;A.prototype.min=ng;A.prototype.max=sg;A.prototype.and=ag;A.prototype.or=cg;A.prototype.xor=ug;A.prototype.andNot=fg;A.prototype.not=hg;A.prototype.shiftLeft=lg;A.prototype.shiftRight=pg;A.prototype.getLowestSetBit=gg;A.prototype.bitCount=mg;A.prototype.testBit=bg;A.prototype.setBit=vg;A.prototype.clearBit=wg;A.prototype.flipBit=Sg;A.prototype.add=_g;A.prototype.subtract=Ig;A.prototype.multiply=Bg;A.prototype.divide=Tg;A.prototype.remainder=Ag;A.prototype.divideAndRemainder=Cg;A.prototype.modPow=Vg;A.prototype.modInverse=Gg;A.prototype.pow=Mg;A.prototype.gcd=zg;A.prototype.isProbablePrime=jg});var Uf=W((sw,Of)=>{var Pt=ce();Cr();Be();var Nf=Of.exports=Pt.sha1=Pt.sha1||{};Pt.md.sha1=Pt.md.algorithms.sha1=Nf;Nf.create=function(){Lf||Zg();var t=null,e=Pt.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var s=n.messageLengthSize/4,i=0;i<s;++i)n.fullMessageLength.push(0);return e=Pt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(s,i){i==="utf8"&&(s=Pt.util.encodeUtf8(s));var o=s.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(s),Mf(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var s=Pt.util.createBuffer();s.putBytes(e.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=i&n.blockLength-1;s.putBytes(ko.substr(0,n.blockLength-o));for(var a,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,f=a/4294967296>>>0,u+=f,s.putInt32(u>>>0),u=a>>>0;s.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Mf(h,r,s);var l=Pt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var ko=null,Lf=!1;function Zg(){ko=String.fromCharCode(128),ko+=Pt.util.fillString(String.fromCharCode(0),64),Lf=!0}function Mf(t,e,r){for(var n,s,i,o,a,f,u,c,h=r.length();h>=64;){for(s=t.h0,i=t.h1,o=t.h2,a=t.h3,f=t.h4,c=0;c<16;++c)n=r.getInt32(),e[c]=n,u=a^i&(o^a),n=(s<<5|s>>>27)+u+f+1518500249+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<20;++c)n=e[c-3]^e[c-8]^e[c-14]^e[c-16],n=n<<1|n>>>31,e[c]=n,u=a^i&(o^a),n=(s<<5|s>>>27)+u+f+1518500249+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<32;++c)n=e[c-3]^e[c-8]^e[c-14]^e[c-16],n=n<<1|n>>>31,e[c]=n,u=i^o^a,n=(s<<5|s>>>27)+u+f+1859775393+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<40;++c)n=e[c-6]^e[c-16]^e[c-28]^e[c-32],n=n<<2|n>>>30,e[c]=n,u=i^o^a,n=(s<<5|s>>>27)+u+f+1859775393+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<60;++c)n=e[c-6]^e[c-16]^e[c-28]^e[c-32],n=n<<2|n>>>30,e[c]=n,u=i&o|a&(i^o),n=(s<<5|s>>>27)+u+f+2400959708+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<80;++c)n=e[c-6]^e[c-16]^e[c-28]^e[c-32],n=n<<2|n>>>30,e[c]=n,u=i^o^a,n=(s<<5|s>>>27)+u+f+3395469782+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;t.h0=t.h0+s|0,t.h1=t.h1+i|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+f|0,h-=64}}});var qf=W((iw,Kf)=>{var Rt=ce();Be();qn();Uf();var Ff=Kf.exports=Rt.pkcs1=Rt.pkcs1||{};Ff.encode_rsa_oaep=function(t,e,r){var n,s,i,o;typeof r=="string"?(n=r,s=arguments[3]||void 0,i=arguments[4]||void 0):r&&(n=r.label||void 0,s=r.seed||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),i?i.start():i=Rt.md.sha1.create(),o||(o=i);var a=Math.ceil(t.n.bitLength()/8),f=a-2*i.digestLength-2;if(e.length>f){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=f,u}n||(n=""),i.update(n,"raw");for(var c=i.digest(),h="",l=f-e.length,g=0;g<l;g++)h+="\0";var p=c.getBytes()+h+""+e;if(!s)s=Rt.random.getBytes(i.digestLength);else if(s.length!==i.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=s.length,u.digestLength=i.digestLength,u}var d=zs(s,a-i.digestLength-1,o),y=Rt.util.xorBytes(p,d,p.length),m=zs(y,i.digestLength,o),E=Rt.util.xorBytes(s,m,s.length);return"\0"+E+y};Ff.decode_rsa_oaep=function(t,e,r){var n,s,i;typeof r=="string"?(n=r,s=arguments[3]||void 0):r&&(n=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(i=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=o,y}if(s===void 0?s=Rt.md.sha1.create():s.start(),i||(i=s),o<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),s.update(n,"raw");for(var a=s.digest().getBytes(),f=e.charAt(0),u=e.substring(1,s.digestLength+1),c=e.substring(1+s.digestLength),h=zs(c,s.digestLength,i),l=Rt.util.xorBytes(u,h,u.length),g=zs(l,o-s.digestLength-1,i),p=Rt.util.xorBytes(c,g,c.length),d=p.substring(0,s.digestLength),y=f!=="\0",m=0;m<s.digestLength;++m)y|=a.charAt(m)!==d.charAt(m);for(var E=1,v=s.digestLength,T=s.digestLength;T<p.length;T++){var b=p.charCodeAt(T),S=b&1^1,I=E?65534:0;y|=b&I,E=E&S,v+=E}if(y||p.charCodeAt(v)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(v+1)};function zs(t,e,r){r||(r=Rt.md.sha1.create());for(var n="",s=Math.ceil(e/r.digestLength),i=0;i<s;++i){var o=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var Vf=W((ow,Mo)=>{var ar=ce();Be();Vs();qn();(function(){if(ar.prime){Mo.exports=ar.prime;return}var t=Mo.exports=ar.prime=ar.prime||{},e=ar.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var s=function(h,l){return h|l};t.generateProbablePrime=function(h,l,g){typeof l=="function"&&(g=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var d=l.prng||ar.random,y={nextBytes:function(m){for(var E=d.getBytesSync(m.length),v=0;v<m.length;++v)m[v]=E.charCodeAt(v)}};if(p.name==="PRIMEINC")return i(h,y,p.options,g);throw new Error("Invalid prime generation algorithm: "+p.name)};function i(h,l,g,p){return"workers"in g?f(h,l,g,p):o(h,l,g,p)}function o(h,l,g,p){var d=u(h,l),y=0,m=c(d.bitLength());"millerRabinTests"in g&&(m=g.millerRabinTests);var E=10;"maxBlockTime"in g&&(E=g.maxBlockTime),a(d,h,l,y,m,E,p)}function a(h,l,g,p,d,y,m){var E=+new Date;do{if(h.bitLength()>l&&(h=u(l,g)),h.isProbablePrime(d))return m(null,h);h.dAddOffset(r[p++%8],0)}while(y<0||+new Date-E<y);ar.util.setImmediate(function(){a(h,l,g,p,d,y,m)})}function f(h,l,g,p){if(typeof Worker>"u")return o(h,l,g,p);var d=u(h,l),y=g.workers,m=g.workLoad||100,E=m*30/8,v=g.workerScript||"forge/prime.worker.js";if(y===-1)return ar.util.estimateCores(function(b,S){b&&(S=2),y=S-1,T()});T();function T(){y=Math.max(1,y);for(var b=[],S=0;S<y;++S)b[S]=new Worker(v);for(var I=y,S=0;S<y;++S)b[S].addEventListener("message",F);var C=!1;function F(K){if(!C){--I;var q=K.data;if(q.found){for(var X=0;X<b.length;++X)b[X].terminate();return C=!0,p(null,new e(q.prime,16))}d.bitLength()>h&&(d=u(h,l));var ue=d.toString(16);K.target.postMessage({hex:ue,workLoad:m}),d.dAddOffset(E,0)}}}}function u(h,l){var g=new e(h,l),p=h-1;return g.testBit(p)||g.bitwiseTo(e.ONE.shiftLeft(p),s,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}function c(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Gs=W((aw,Yf)=>{var H=ce();Kn();Vs();Ds();qf();Vf();qn();Be();typeof te>"u"&&(te=H.jsbn.BigInteger);var te,No=H.util.isNodejs?Ls():null,w=H.asn1,ft=H.util;H.pki=H.pki||{};Yf.exports=H.pki.rsa=H.rsa=H.rsa||{};var j=H.pki,Qg=[6,4,2,4,2,4,6,2],Xg={name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Jg={name:"RSAPrivateKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},ey={name:"RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},ty=H.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},ry={name:"DigestInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:w.Class.UNIVERSAL,type:w.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},ny=function(t){var e;if(t.algorithm in j.oids)e=j.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=w.oidToDer(e).getBytes(),s=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),i=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);i.value.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,n)),i.value.push(w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,""));var o=w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,t.digest().getBytes());return s.value.push(i),s.value.push(o),w.toDer(s).getBytes()},jf=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(te.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(te.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new te(H.util.bytesToHex(H.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(te.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var s=t.mod(e.p).modPow(e.dP,e.p),i=t.mod(e.q).modPow(e.dQ,e.q);s.compareTo(i)<0;)s=s.add(e.p);var o=s.subtract(i).multiply(e.qInv).mod(e.p).multiply(e.q).add(i);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};j.rsa.encrypt=function(t,e,r){var n=r,s,i=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,s=$f(t,e,r)):(s=H.util.createBuffer(),s.putBytes(t));for(var o=new te(s.toHex(),16),a=jf(o,e,n),f=a.toString(16),u=H.util.createBuffer(),c=i-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(H.util.hexToBytes(f)),u.getBytes()};j.rsa.decrypt=function(t,e,r,n){var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var i=new Error("Encrypted message length is invalid.");throw i.length=t.length,i.expected=s,i}var o=new te(H.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=jf(o,e,r),f=a.toString(16),u=H.util.createBuffer(),c=s-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(H.util.hexToBytes(f)),n!==!1?Hs(u.getBytes(),e,r):u.getBytes()};j.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||H.random,s={nextBytes:function(a){for(var f=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=f.charCodeAt(u)}},i=r.algorithm||"PRIMEINC",o;if(i==="PRIMEINC")o={algorithm:i,state:0,bits:t,rng:s,eInt:e||65537,e:new te(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+i);return o};j.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new te(null);r.fromInt(30);for(var n=0,s=function(h,l){return h|l},i=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,u=f-1;t.pqState===0?(t.num=new te(f,t.rng),t.num.testBit(u)||t.num.bitwiseTo(te.ONE.shiftLeft(u),s,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(iy(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Qg[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(te.ONE).gcd(t.e).compareTo(te.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(te.ONE),t.q1=t.q.subtract(te.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(te.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var c=t.e.modInverse(t.phi);t.keys={privateKey:j.rsa.setPrivateKey(t.n,t.e,c,t.p,t.q,c.mod(t.p1),c.mod(t.q1),t.q.modInverse(t.p)),publicKey:j.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-i,i=o}return t.keys!==null};j.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!H.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(zf("generateKeyPair"))return No.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,u){if(a)return n(a);n(null,{privateKey:j.privateKeyFromPem(u),publicKey:j.publicKeyFromPem(f)})});if(Hf("generateKey")&&Hf("exportKey"))return ft.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Wf(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return ft.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=j.privateKeyFromAsn1(w.fromDer(H.util.createBuffer(a)));n(null,{privateKey:f,publicKey:j.setRsaPublicKey(f.n,f.e)})}});if(Gf("generateKey")&&Gf("exportKey")){var s=ft.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Wf(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);s.oncomplete=function(a){var f=a.target.result,u=ft.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);u.oncomplete=function(c){var h=c.target.result,l=j.privateKeyFromAsn1(w.fromDer(H.util.createBuffer(h)));n(null,{privateKey:l,publicKey:j.setRsaPublicKey(l.n,l.e)})},u.onerror=function(c){n(c)}},s.onerror=function(a){n(a)};return}}else if(zf("generateKeyPairSync")){var i=No.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:j.privateKeyFromPem(i.privateKey),publicKey:j.publicKeyFromPem(i.publicKey)}}}var o=j.rsa.createKeyPairGenerationState(t,e,r);if(!n)return j.rsa.stepKeyPairGenerationState(o,0),o.keys;sy(o,r,n)};j.setRsaPublicKey=j.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,s,i){if(typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSAES-PKCS1-V1_5"),s==="RSAES-PKCS1-V1_5")s={encode:function(a,f,u){return $f(a,f,2).getBytes()}};else if(s==="RSA-OAEP"||s==="RSAES-OAEP")s={encode:function(a,f){return H.pkcs1.encode_rsa_oaep(f,a,i)}};else if(["RAW","NONE","NULL",null].indexOf(s)!==-1)s={encode:function(a){return a}};else if(typeof s=="string")throw new Error('Unsupported encryption scheme: "'+s+'".');var o=s.encode(n,r,!0);return j.rsa.encrypt(o,r,!0)},r.verify=function(n,s,i,o){typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),i==="RSASSA-PKCS1-V1_5"?i={verify:function(f,u){u=Hs(u,r,!0);var c=w.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!w.validate(c,ry,h,l)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=l,g}var p=w.derToOid(h.algorithmIdentifier);if(!(p===H.oids.md2||p===H.oids.md5||p===H.oids.sha1||p===H.oids.sha224||p===H.oids.sha256||p===H.oids.sha384||p===H.oids.sha512||p===H.oids["sha512-224"]||p===H.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=p,g}if((p===H.oids.md2||p===H.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(i==="NONE"||i==="NULL"||i===null)&&(i={verify:function(f,u){return u=Hs(u,r,!0),f===u}});var a=j.rsa.decrypt(s,r,!0,!1);return i.verify(n,a,r.n.bitLength())},r};j.setRsaPrivateKey=j.rsa.setPrivateKey=function(t,e,r,n,s,i,o,a){var f={n:t,e,d:r,p:n,q:s,dP:i,dQ:o,qInv:a};return f.decrypt=function(u,c,h){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var l=j.rsa.decrypt(u,f,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:Hs};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(g,p){return H.pkcs1.decode_rsa_oaep(p,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(l,f,!1)},f.sign=function(u,c){var h=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:ny},h=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return u}},h=1);var l=c.encode(u,f.n.bitLength());return j.rsa.encrypt(l,f,h)},f};j.wrapRsaPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(j.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,w.toDer(t).getBytes())])};j.privateKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,Xg,e,r)&&(t=w.fromDer(H.util.createBuffer(e.privateKey))),e={},r=[],!w.validate(t,Jg,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var s,i,o,a,f,u,c,h;return s=H.util.createBuffer(e.privateKeyModulus).toHex(),i=H.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=H.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=H.util.createBuffer(e.privateKeyPrime1).toHex(),f=H.util.createBuffer(e.privateKeyPrime2).toHex(),u=H.util.createBuffer(e.privateKeyExponent1).toHex(),c=H.util.createBuffer(e.privateKeyExponent2).toHex(),h=H.util.createBuffer(e.privateKeyCoefficient).toHex(),j.setRsaPrivateKey(new te(s,16),new te(i,16),new te(o,16),new te(a,16),new te(f,16),new te(u,16),new te(c,16),new te(h,16))};j.privateKeyToAsn1=j.privateKeyToRSAPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.e)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.d)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.p)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.q)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.dP)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.dQ)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.qInv))])};j.publicKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,ty,e,r)){var n=w.derToOid(e.publicKeyOid);if(n!==j.oids.rsaEncryption){var s=new Error("Cannot read public key. Unknown OID.");throw s.oid=n,s}t=e.rsaPublicKey}if(r=[],!w.validate(t,ey,e,r)){var s=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw s.errors=r,s}var i=H.util.createBuffer(e.publicKeyModulus).toHex(),o=H.util.createBuffer(e.publicKeyExponent).toHex();return j.setRsaPublicKey(new te(i,16),new te(o,16))};j.publicKeyToAsn1=j.publicKeyToSubjectPublicKeyInfo=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(j.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,[j.publicKeyToRSAPublicKey(t)])])};j.publicKeyToRSAPublicKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Dt(t.e))])};function $f(t,e,r){var n=H.util.createBuffer(),s=Math.ceil(e.n.bitLength()/8);if(t.length>s-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=t.length,i.max=s-11,i}n.putByte(0),n.putByte(r);var o=s-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<o;++f)n.putByte(a)}else for(;o>0;){for(var u=0,c=H.random.getBytes(o),f=0;f<o;++f)a=c.charCodeAt(f),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(t),n}function Hs(t,e,r,n){var s=Math.ceil(e.n.bitLength()/8),i=H.util.createBuffer(t),o=i.getByte(),a=i.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=s-3-n;for(var u=0;u<f;++u)if(i.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;i.length()>1;){if(i.getByte()!==255){--i.read;break}++f}else if(a===2)for(f=0;i.length()>1;){if(i.getByte()===0){--i.read;break}++f}var c=i.getByte();if(c!==0||f!==s-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function sy(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),s();function s(){i(t.pBits,function(a,f){if(a)return r(a);if(t.p=f,t.q!==null)return o(a,t.q);i(t.qBits,o)})}function i(a,f){H.prime.generateProbablePrime(a,n,f)}function o(a,f){if(a)return r(a);if(t.q=f,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(te.ONE).gcd(t.e).compareTo(te.ONE)!==0){t.p=null,s();return}if(t.q.subtract(te.ONE).gcd(t.e).compareTo(te.ONE)!==0){t.q=null,i(t.qBits,o);return}if(t.p1=t.p.subtract(te.ONE),t.q1=t.q.subtract(te.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(te.ONE)!==0){t.p=t.q=null,s();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,i(t.qBits,o);return}var c=t.e.modInverse(t.phi);t.keys={privateKey:j.rsa.setPrivateKey(t.n,t.e,c,t.p,t.q,c.mod(t.p1),c.mod(t.q1),t.q.modInverse(t.p)),publicKey:j.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Dt(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=H.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function iy(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function zf(t){return H.util.isNodejs&&typeof No[t]=="function"}function Hf(t){return typeof ft.globalScope<"u"&&typeof ft.globalScope.crypto=="object"&&typeof ft.globalScope.crypto.subtle=="object"&&typeof ft.globalScope.crypto.subtle[t]=="function"}function Gf(t){return typeof ft.globalScope<"u"&&typeof ft.globalScope.msCrypto=="object"&&typeof ft.globalScope.msCrypto.subtle=="object"&&typeof ft.globalScope.msCrypto.subtle[t]=="function"}function Wf(t){for(var e=H.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var th=W((cw,eh)=>{var L=ce();Ps();Kn();of();Cr();Ds();Bo();pf();qn();If();Gs();Be();typeof Zf>"u"&&(Zf=L.jsbn.BigInteger);var Zf,_=L.asn1,$=L.pki=L.pki||{};eh.exports=$.pbe=L.pbe=L.pbe||{};var Dr=$.oids,oy={name:"EncryptedPrivateKeyInfo",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},ay={name:"PBES2Algorithms",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},cy={name:"pkcs-12PbeParams",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"iterations"}]};$.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=L.random.getBytesSync(r.saltSize),s=r.count,i=_.integerToDer(s),o,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,c,h;switch(r.algorithm){case"aes128":o=16,u=16,c=Dr["aes128-CBC"],h=L.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,c=Dr["aes192-CBC"],h=L.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,c=Dr["aes256-CBC"],h=L.aes.createEncryptionCipher;break;case"des":o=8,u=8,c=Dr.desCBC,h=L.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Jf(g),d=L.pkcs5.pbkdf2(e,n,s,o,p),y=L.random.getBytesSync(u),m=h(d);m.start(y),m.update(_.toDer(t)),m.finish(),f=m.output.getBytes();var E=uy(n,i,o,g);a=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(Dr.pkcs5PBES2).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(Dr.pkcs5PBKDF2).getBytes()),E]),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(c).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var v=new L.util.ByteBuffer(n),d=$.pbe.generatePkcs12Key(e,v,1,s,o),y=$.pbe.generatePkcs12Key(e,v,2,s,o),m=L.des.createEncryptionCipher(d);m.start(y),m.update(_.toDer(t)),m.finish(),f=m.output.getBytes(),a=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(Dr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,n),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,i.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var T=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[a,_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,f)]);return T};$.decryptPrivateKeyInfo=function(t,e){var r=null,n={},s=[];if(!_.validate(t,oy,n,s)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}var o=_.derToOid(n.encryptionOid),a=$.pbe.getCipher(o,n.encryptionParams,e),f=L.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=_.fromDer(a.output)),r};$.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:_.toDer(t).getBytes()};return L.pem.encode(r,{maxline:e})};$.encryptedPrivateKeyFromPem=function(t){var e=L.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return _.fromDer(e.body)};$.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=$.wrapRsaPrivateKey($.privateKeyToAsn1(t));return n=$.encryptPrivateKeyInfo(n,e,r),$.encryptedPrivateKeyToPem(n)}var s,i,o,a;switch(r.algorithm){case"aes128":s="AES-128-CBC",o=16,i=L.random.getBytesSync(16),a=L.aes.createEncryptionCipher;break;case"aes192":s="AES-192-CBC",o=24,i=L.random.getBytesSync(16),a=L.aes.createEncryptionCipher;break;case"aes256":s="AES-256-CBC",o=32,i=L.random.getBytesSync(16),a=L.aes.createEncryptionCipher;break;case"3des":s="DES-EDE3-CBC",o=24,i=L.random.getBytesSync(8),a=L.des.createEncryptionCipher;break;case"des":s="DES-CBC",o=8,i=L.random.getBytesSync(8),a=L.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var u=L.pbe.opensslDeriveBytes(e,i.substr(0,8),o),c=a(u);c.start(i),c.update(_.toDer($.privateKeyToAsn1(t))),c.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:s,parameters:L.util.bytesToHex(i).toUpperCase()},body:c.output.getBytes()};return L.pem.encode(h)};$.decryptRsaPrivateKey=function(t,e){var r=null,n=L.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var s=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw s.headerType=s,s}if(n.procType&&n.procType.type==="ENCRYPTED"){var i,o;switch(n.dekInfo.algorithm){case"DES-CBC":i=8,o=L.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,o=L.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,o=L.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,o=L.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,o=L.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,o=function(h){return L.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":i=8,o=function(h){return L.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":i=16,o=function(h){return L.rc2.createDecryptionCipher(h,128)};break;default:var s=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw s.algorithm=n.dekInfo.algorithm,s}var a=L.util.hexToBytes(n.dekInfo.parameters),f=L.pbe.opensslDeriveBytes(e,a.substr(0,8),i),u=o(f);if(u.start(a),u.update(L.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=$.decryptPrivateKeyInfo(_.fromDer(r),e):r=_.fromDer(r),r!==null&&(r=$.privateKeyFromAsn1(r)),r};$.pbe.generatePkcs12Key=function(t,e,r,n,s,i){var o,a;if(typeof i>"u"||i===null){if(!("sha1"in L.md))throw new Error('"sha1" hash algorithm unavailable.');i=L.md.sha1.create()}var f=i.digestLength,u=i.blockLength,c=new L.util.ByteBuffer,h=new L.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),g=e.length(),p=new L.util.ByteBuffer;p.fillWithByte(r,u);var d=u*Math.ceil(g/u),y=new L.util.ByteBuffer;for(a=0;a<d;a++)y.putByte(e.at(a%g));var m=u*Math.ceil(l/u),E=new L.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(h.at(a%l));var v=y;v.putBuffer(E);for(var T=Math.ceil(s/f),b=1;b<=T;b++){var S=new L.util.ByteBuffer;S.putBytes(p.bytes()),S.putBytes(v.bytes());for(var I=0;I<n;I++)i.start(),i.update(S.getBytes()),S=i.digest();var C=new L.util.ByteBuffer;for(a=0;a<u;a++)C.putByte(S.at(a%f));var F=Math.ceil(g/u)+Math.ceil(l/u),K=new L.util.ByteBuffer;for(o=0;o<F;o++){var q=new L.util.ByteBuffer(v.getBytes(u)),X=511;for(a=C.length()-1;a>=0;a--)X=X>>8,X+=C.at(a)+q.at(a),q.setAt(a,X&255);K.putBuffer(q)}v=K,c.putBuffer(S)}return c.truncate(c.length()-s),c};$.pbe.getCipher=function(t,e,r){switch(t){case $.oids.pkcs5PBES2:return $.pbe.getCipherForPBES2(t,e,r);case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case $.oids["pbewithSHAAnd40BitRC2-CBC"]:return $.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};$.pbe.getCipherForPBES2=function(t,e,r){var n={},s=[];if(!_.validate(e,ay,n,s)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}if(t=_.derToOid(n.kdfOid),t!==$.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=t,i.supportedOids=["pkcs5PBKDF2"],i}if(t=_.derToOid(n.encOid),t!==$.oids["aes128-CBC"]&&t!==$.oids["aes192-CBC"]&&t!==$.oids["aes256-CBC"]&&t!==$.oids["des-EDE3-CBC"]&&t!==$.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=t,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var o=n.kdfSalt,a=L.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,u;switch($.oids[t]){case"aes128-CBC":f=16,u=L.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,u=L.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,u=L.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,u=L.des.createDecryptionCipher;break;case"desCBC":f=8,u=L.des.createDecryptionCipher;break}var c=Xf(n.prfOid),h=L.pkcs5.pbkdf2(r,o,a,f,c),l=n.encIv,g=u(h);return g.start(l),g};$.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},s=[];if(!_.validate(e,cy,n,s)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}var o=L.util.createBuffer(n.salt),a=L.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,u,c;switch(t){case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,u=8,c=L.des.startDecrypting;break;case $.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,u=8,c=function(d,y){var m=L.rc2.createDecryptionCipher(d,40);return m.start(y,null),m};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=t,i}var h=Xf(n.prfOid),l=$.pbe.generatePkcs12Key(r,o,1,a,f,h);h.start();var g=$.pbe.generatePkcs12Key(r,o,2,a,u,h);return c(l,g)};$.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in L.md))throw new Error('"md5" hash algorithm unavailable.');n=L.md.md5.create()}e===null&&(e="");for(var s=[Qf(n,t+e)],i=16,o=1;i<r;++o,i+=16)s.push(Qf(n,s[o-1]+t+e));return s.join("").substr(0,r)};function Qf(t,e){return t.start().update(e).digest().getBytes()}function Xf(t){var e;if(!t)e="hmacWithSHA1";else if(e=$.oids[_.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Jf(e)}function Jf(t){var e=L.md;switch(t){case"hmacWithSHA224":e=L.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function uy(t,e,r,n){var s=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,t),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&s.value.push(_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,L.util.hexToBytes(r.toString(16))),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer($.oids[n]).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")])),s}});var qh=W((aE,Kh)=>{var ge=ce();Cr();Be();var Zn=Kh.exports=ge.sha512=ge.sha512||{};ge.md.sha512=ge.md.algorithms.sha512=Zn;var Uh=ge.sha384=ge.sha512.sha384=ge.sha512.sha384||{};Uh.create=function(){return Zn.create("SHA-384")};ge.md.sha384=ge.md.algorithms.sha384=Uh;ge.sha512.sha256=ge.sha512.sha256||{create:function(){return Zn.create("SHA-512/256")}};ge.md["sha512/256"]=ge.md.algorithms["sha512/256"]=ge.sha512.sha256;ge.sha512.sha224=ge.sha512.sha224||{create:function(){return Zn.create("SHA-512/224")}};ge.md["sha512/224"]=ge.md.algorithms["sha512/224"]=ge.sha512.sha224;Zn.create=function(t){if(Fh||Tm(),typeof t>"u"&&(t="SHA-512"),!(t in Fr))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Fr[t],r=null,n=ge.util.createBuffer(),s=new Array(80),i=0;i<80;++i)s[i]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,u=0;u<f;++u)a.fullMessageLength.push(0);n=ge.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(f,u){u==="utf8"&&(f=ge.util.encodeUtf8(f));var c=f.length;a.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=c[1],c[1]=c[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,c[0]=c[1]/4294967296>>>0;return n.putBytes(f),Oh(r,s,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=ge.util.createBuffer();f.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,c=u&a.blockLength-1;f.putBytes(da.substr(0,a.blockLength-c));for(var h,l,g=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,g+=l,f.putInt32(g>>>0),g=h>>>0;f.putInt32(g);for(var d=new Array(r.length),p=0;p<r.length;++p)d[p]=r[p].slice(0);Oh(d,s,f);var y=ge.util.createBuffer(),m;t==="SHA-512"?m=d.length:t==="SHA-384"?m=d.length-2:m=d.length-4;for(var p=0;p<m;++p)y.putInt32(d[p][0]),(p!==m-1||t!=="SHA-512/224")&&y.putInt32(d[p][1]);return y},a};var da=null,Fh=!1,ga=null,Fr=null;function Tm(){da=String.fromCharCode(128),da+=ge.util.fillString(String.fromCharCode(0),128),ga=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Fr={},Fr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Fr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Fr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Fr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Fh=!0}function Oh(t,e,r){for(var n,s,i,o,a,f,u,c,h,l,g,p,d,y,m,E,v,T,b,S,I,C,F,K,q,X,ue,Oe,P,M,D,k,B,O,V,G=r.length();G>=128;){for(P=0;P<16;++P)e[P][0]=r.getInt32()>>>0,e[P][1]=r.getInt32()>>>0;for(;P<80;++P)k=e[P-2],M=k[0],D=k[1],n=((M>>>19|D<<13)^(D>>>29|M<<3)^M>>>6)>>>0,s=((M<<13|D>>>19)^(D<<3|M>>>29)^(M<<26|D>>>6))>>>0,O=e[P-15],M=O[0],D=O[1],i=((M>>>1|D<<31)^(M>>>8|D<<24)^M>>>7)>>>0,o=((M<<31|D>>>1)^(M<<24|D>>>8)^(M<<25|D>>>7))>>>0,B=e[P-7],V=e[P-16],D=s+B[1]+o+V[1],e[P][0]=n+B[0]+i+V[0]+(D/4294967296>>>0)>>>0,e[P][1]=D>>>0;for(d=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],v=t[2][0],T=t[2][1],b=t[3][0],S=t[3][1],I=t[4][0],C=t[4][1],F=t[5][0],K=t[5][1],q=t[6][0],X=t[6][1],ue=t[7][0],Oe=t[7][1],P=0;P<80;++P)u=((I>>>14|C<<18)^(I>>>18|C<<14)^(C>>>9|I<<23))>>>0,c=((I<<18|C>>>14)^(I<<14|C>>>18)^(C<<23|I>>>9))>>>0,h=(q^I&(F^q))>>>0,l=(X^C&(K^X))>>>0,a=((d>>>28|y<<4)^(y>>>2|d<<30)^(y>>>7|d<<25))>>>0,f=((d<<4|y>>>28)^(y<<30|d>>>2)^(y<<25|d>>>7))>>>0,g=(d&m|v&(d^m))>>>0,p=(y&E|T&(y^E))>>>0,D=Oe+c+l+ga[P][1]+e[P][1],n=ue+u+h+ga[P][0]+e[P][0]+(D/4294967296>>>0)>>>0,s=D>>>0,D=f+p,i=a+g+(D/4294967296>>>0)>>>0,o=D>>>0,ue=q,Oe=X,q=F,X=K,F=I,K=C,D=S+s,I=b+n+(D/4294967296>>>0)>>>0,C=D>>>0,b=v,S=T,v=m,T=E,m=d,E=y,D=s+o,d=n+i+(D/4294967296>>>0)>>>0,y=D>>>0;D=t[0][1]+y,t[0][0]=t[0][0]+d+(D/4294967296>>>0)>>>0,t[0][1]=D>>>0,D=t[1][1]+E,t[1][0]=t[1][0]+m+(D/4294967296>>>0)>>>0,t[1][1]=D>>>0,D=t[2][1]+T,t[2][0]=t[2][0]+v+(D/4294967296>>>0)>>>0,t[2][1]=D>>>0,D=t[3][1]+S,t[3][0]=t[3][0]+b+(D/4294967296>>>0)>>>0,t[3][1]=D>>>0,D=t[4][1]+C,t[4][0]=t[4][0]+I+(D/4294967296>>>0)>>>0,t[4][1]=D>>>0,D=t[5][1]+K,t[5][0]=t[5][0]+F+(D/4294967296>>>0)>>>0,t[5][1]=D>>>0,D=t[6][1]+X,t[6][0]=t[6][0]+q+(D/4294967296>>>0)>>>0,t[6][1]=D>>>0,D=t[7][1]+Oe,t[7][0]=t[7][0]+ue+(D/4294967296>>>0)>>>0,t[7][1]=D>>>0,G-=128}}});var $1={};De($1,{GossipSub:()=>mi,gossipsub:()=>j1,multicodec:()=>W1});var Z1=Symbol.for("@libp2p/connection");var X1=Symbol.for("@libp2p/content-routing");var tb=Symbol.for("@libp2p/peer-discovery");var Va=Symbol.for("@libp2p/peer-id");var sb=Symbol.for("@libp2p/peer-routing");var br="StrictSign",Vr="StrictNoSign",$e;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})($e||($e={}));var cb=Symbol.for("@libp2p/transport");var za;(function(t){t[t.FATAL_ALL=0]="FATAL_ALL",t[t.NO_FATAL=1]="NO_FATAL"})(za||(za={}));var U=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var ss=class extends EventTarget{#e=new Map;listenerCount(e){let r=this.#e.get(e);return r==null?0:r.length}addEventListener(e,r,n){super.addEventListener(e,r,n);let s=this.#e.get(e);s==null&&(s=[],this.#e.set(e,s)),s.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(e,r,n){super.removeEventListener(e.toString(),r??null,n);let s=this.#e.get(e);s!=null&&(s=s.filter(({callback:i})=>i!==r),this.#e.set(e,s))}dispatchEvent(e){let r=super.dispatchEvent(e),n=this.#e.get(e.type);return n==null||(n=n.filter(({once:s})=>!s),this.#e.set(e.type,n)),r}safeDispatchEvent(e,r){return this.dispatchEvent(new xr(e,r))}},xi=class extends Event{detail;constructor(e,r){super(e,r),this.detail=r?.detail}},xr=globalThis.CustomEvent??xi;var _i={};De(_i,{base58btc:()=>Ve,base58flickr:()=>Yl});function Hl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,f=t.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,E=p.length;m!==E&&p[m]===0;)m++,d++;for(var v=(E-m)*c+1>>>0,T=new Uint8Array(v);m!==E;){for(var b=p[m],S=0,I=v-1;(b!==0||S<y)&&I!==-1;I--,S++)b+=256*T[I]>>>0,T[I]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=S,m++}for(var C=v-y;C!==v&&T[C]===0;)C++;for(var F=f.repeat(d);C<v;++C)F+=t.charAt(T[C]);return F}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===f;)y++,d++;for(var E=(p.length-d)*u+1>>>0,v=new Uint8Array(E);p[d];){var T=r[p.charCodeAt(d)];if(T===255)return;for(var b=0,S=E-1;(T!==0||b<m)&&S!==-1;S--,b++)T+=a*v[S]>>>0,v[S]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var I=E-m;I!==E&&v[I]===0;)I++;for(var C=new Uint8Array(y+(E-I)),F=y;I!==E;)C[F++]=v[I++];return C}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var Gl=Hl,Wl=Gl,Ha=Wl;var Fb=new Uint8Array(0);var Ga=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Ut=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Wa=t=>new TextEncoder().encode(t),ja=t=>new TextDecoder().decode(t);var vi=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},wi=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ya(this,e)}},Si=class{constructor(e){this.decoders=e}or(e){return Ya(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ya=(t,e)=>new Si({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ei=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new vi(e,r,n),this.decoder=new wi(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},zr=({name:t,prefix:e,encode:r,decode:n})=>new Ei(t,e,r,n),Zt=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:s}=Ha(r,e);return zr({prefix:t,name:e,encode:n,decode:i=>Ut(s(i))})},jl=(t,e,r,n)=>{let s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,f=0,u=0;for(let c=0;c<i;++c){let h=s[t[c]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,a+=r,a>=8&&(a-=8,o[u++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},$l=(t,e,r)=>{let n=e[e.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Se=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>zr({prefix:e,name:t,encode(s){return $l(s,n,r)},decode(s){return jl(s,n,r,t)}});var Ve=Zt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Yl=Zt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ii={};De(Ii,{base10:()=>Zl});var Zl=Zt({prefix:"9",name:"base10",alphabet:"0123456789"});var Bi={};De(Bi,{base16:()=>Ql,base16upper:()=>Xl});var Ql=Se({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Xl=Se({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ti={};De(Ti,{base2:()=>Jl});var Jl=Se({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ai={};De(Ai,{base256emoji:()=>s0});var Za=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),e0=Za.reduce((t,e,r)=>(t[r]=e,t),[]),t0=Za.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function r0(t){return t.reduce((e,r)=>(e+=e0[r],e),"")}function n0(t){let e=[];for(let r of t){let n=t0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var s0=zr({prefix:"\u{1F680}",name:"base256emoji",encode:r0,decode:n0});var Ci={};De(Ci,{base32:()=>vr,base32hex:()=>c0,base32hexpad:()=>f0,base32hexpadupper:()=>h0,base32hexupper:()=>u0,base32pad:()=>o0,base32padupper:()=>a0,base32upper:()=>i0,base32z:()=>l0});var vr=Se({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i0=Se({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o0=Se({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a0=Se({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c0=Se({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u0=Se({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),f0=Se({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h0=Se({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),l0=Se({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Pi={};De(Pi,{base36:()=>p0,base36upper:()=>d0});var p0=Zt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),d0=Zt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ri={};De(Ri,{base64:()=>is,base64pad:()=>g0,base64url:()=>y0,base64urlpad:()=>m0});var is=Se({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),g0=Se({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),y0=Se({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),m0=Se({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Di={};De(Di,{base8:()=>b0});var b0=Se({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ki={};De(ki,{identity:()=>x0});var x0=zr({prefix:"\0",name:"identity",encode:t=>ja(t),decode:t=>Wa(t)});var e2=new TextEncoder,t2=new TextDecoder;var Ni={};De(Ni,{identity:()=>$r});var S0=Ja,Qa=128,E0=127,_0=~E0,I0=Math.pow(2,31);function Ja(t,e,r){e=e||[],r=r||0;for(var n=r;t>=I0;)e[r++]=t&255|Qa,t/=128;for(;t&_0;)e[r++]=t&255|Qa,t>>>=7;return e[r]=t|0,Ja.bytes=r-n+1,e}var B0=Mi,T0=128,Xa=127;function Mi(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Mi.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&Xa)<<s:(o&Xa)*Math.pow(2,s),s+=7}while(o>=T0);return Mi.bytes=i-n,r}var A0=Math.pow(2,7),C0=Math.pow(2,14),P0=Math.pow(2,21),R0=Math.pow(2,28),D0=Math.pow(2,35),k0=Math.pow(2,42),M0=Math.pow(2,49),N0=Math.pow(2,56),L0=Math.pow(2,63),O0=function(t){return t<A0?1:t<C0?2:t<P0?3:t<R0?4:t<D0?5:t<k0?6:t<M0?7:t<N0?8:t<L0?9:10},U0={encode:S0,decode:B0,encodingLength:O0},F0=U0,_n=F0;var In=(t,e=0)=>[_n.decode(t,e),_n.decode.bytes],Hr=(t,e,r=0)=>(_n.encode(t,e,r),e),Gr=t=>_n.encodingLength(t);var Qt=(t,e)=>{let r=e.byteLength,n=Gr(t),s=n+Gr(r),i=new Uint8Array(s+r);return Hr(t,i,0),Hr(r,i,n),i.set(e,s),new Wr(t,r,e,i)},jr=t=>{let e=Ut(t),[r,n]=In(e),[s,i]=In(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new Wr(r,s,o,e)},ec=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Ga(t.bytes,r.bytes)}},Wr=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};var tc=0,K0="identity",rc=Ut,q0=t=>Qt(tc,rc(t)),$r={code:tc,name:K0,encode:rc,digest:q0};var Ui={};De(Ui,{sha256:()=>Pe,sha512:()=>V0});var Oi=({name:t,code:e,encode:r})=>new Li(t,e,r),Li=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Qt(this.code,r):r.then(n=>Qt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var sc=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Pe=Oi({name:"sha2-256",code:18,encode:sc("SHA-256")}),V0=Oi({name:"sha2-512",code:19,encode:sc("SHA-512")});var ic=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return H0(r,Fi(t),e||Ve.encoder);default:return G0(r,Fi(t),e||vr.encoder)}};var oc=new WeakMap,Fi=t=>{let e=oc.get(t);if(e==null){let r=new Map;return oc.set(t,r),r}return e},Xt=class t{constructor(e,r,n,s){this.code=r,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Bn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==W0)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Qt(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&ec(e.multihash,n.multihash)}toString(e){return ic(this,e)}toJSON(){return{"/":ic(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:s,multihash:i,bytes:o}=r;return new t(n,s,i,o||ac(n,s,i.bytes))}else if(r[j0]===!0){let{version:n,multihash:s,code:i}=r,o=jr(s);return t.create(n,i,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Bn)throw new Error(`Version 0 CID must use dag-pb (code: ${Bn}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let s=ac(e,r,n.bytes);return new t(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Bn,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,s=Ut(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=s.subarray(r.multihashSize-r.digestSize),o=new Wr(r.multihashCode,r.digestSize,i,s);return[r.version===0?t.createV0(o):t.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=In(e.subarray(r));return r+=l,h},s=n(),i=Bn;if(s===18?(s=0,r=0):i=n(),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=n(),f=n(),u=r+f,c=u-o;return{version:s,codec:i,multihashCode:a,digestSize:f,multihashSize:c,size:u}}static parse(e,r){let[n,s]=z0(e,r),i=t.decode(s);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Fi(i).set(n,e),i}},z0=(t,e)=>{switch(t[0]){case"Q":{let r=e||Ve;return[Ve.prefix,r.decode(`${Ve.prefix}${t}`)]}case Ve.prefix:{let r=e||Ve;return[Ve.prefix,r.decode(t)]}case vr.prefix:{let r=e||vr;return[vr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},H0=(t,e,r)=>{let{prefix:n}=r;if(n!==Ve.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=e.get(n);if(s==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return s},G0=(t,e,r)=>{let{prefix:n}=r,s=e.get(n);if(s==null){let i=r.encode(t);return e.set(n,i),i}else return s},Bn=112,W0=18,ac=(t,e,r)=>{let n=Gr(t),s=n+Gr(e),i=new Uint8Array(s+r.byteLength);return Hr(t,i,0),Hr(e,i,n),i.set(r,s),i},j0=Symbol.for("@ipld/js-cid/CID");var Jt={...ki,...Ti,...Di,...Ii,...Bi,...Ci,...Pi,..._i,...Ri,...Ai},m2={...Ui,...Ni};function Ke(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var $0=Symbol.for("nodejs.util.inspect.custom"),cc=Object.values(Jt).map(t=>t.decoder).reduce((t,e)=>t.or(e),Jt.identity.decoder),uc=114,fc=36,hc=37,Tn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Va]=!0;toString(){return this.string==null&&(this.string=Ve.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Xt.createV1(uc,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Ke(this.multihash.bytes,e);if(typeof e=="string")return Sr(e).equals(this);if(e?.multihash?.bytes!=null)return Ke(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[$0](){return`PeerId(${this.toString()})`}},An=class extends Tn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Cn=class extends Tn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Pn=class extends Tn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function Sr(t,e){if(e=e??cc,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=jr(Ve.decode(`z${t}`));return t.startsWith("12D")?new Cn({multihash:r}):t.startsWith("16U")?new Pn({multihash:r}):new An({multihash:r})}return Yr(cc.decode(t))}function Yr(t){try{let e=jr(t);if(e.code===$r.code){if(e.digest.length===fc)return new Cn({multihash:e});if(e.digest.length===hc)return new Pn({multihash:e})}if(e.code===Pe.code)return new An({multihash:e})}catch{return Y0(Xt.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Y0(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==uc)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Pe.code)return new An({multihash:t.multihash});if(e.code===$r.code){if(e.digest.length===fc)return new Cn({multihash:t.multihash});if(e.digest.length===hc)return new Pn({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}function Er(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Ft(t=0){return globalThis.Buffer?.alloc!=null?Er(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function ze(t=0){return globalThis.Buffer?.allocUnsafe!=null?Er(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}var Z0=Math.pow(2,7),Q0=Math.pow(2,14),X0=Math.pow(2,21),Ki=Math.pow(2,28),qi=Math.pow(2,35),Vi=Math.pow(2,42),zi=Math.pow(2,49),ie=128,He=127;function pt(t){if(t<Z0)return 1;if(t<Q0)return 2;if(t<X0)return 3;if(t<Ki)return 4;if(t<qi)return 5;if(t<Vi)return 6;if(t<zi)return 7;if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function J0(t,e,r=0){switch(pt(t)){case 8:e[r++]=t&255|ie,t/=128;case 7:e[r++]=t&255|ie,t/=128;case 6:e[r++]=t&255|ie,t/=128;case 5:e[r++]=t&255|ie,t/=128;case 4:e[r++]=t&255|ie,t>>>=7;case 3:e[r++]=t&255|ie,t>>>=7;case 2:e[r++]=t&255|ie,t>>>=7;case 1:{e[r++]=t&255,t>>>=7;break}default:throw new Error("unreachable")}return e}function ep(t,e,r=0){switch(pt(t)){case 8:e.set(r++,t&255|ie),t/=128;case 7:e.set(r++,t&255|ie),t/=128;case 6:e.set(r++,t&255|ie),t/=128;case 5:e.set(r++,t&255|ie),t/=128;case 4:e.set(r++,t&255|ie),t>>>=7;case 3:e.set(r++,t&255|ie),t>>>=7;case 2:e.set(r++,t&255|ie),t>>>=7;case 1:{e.set(r++,t&255),t>>>=7;break}default:throw new Error("unreachable")}return e}function tp(t,e){let r=t[e],n=0;if(n+=r&He,r<ie||(r=t[e+1],n+=(r&He)<<7,r<ie)||(r=t[e+2],n+=(r&He)<<14,r<ie)||(r=t[e+3],n+=(r&He)<<21,r<ie)||(r=t[e+4],n+=(r&He)*Ki,r<ie)||(r=t[e+5],n+=(r&He)*qi,r<ie)||(r=t[e+6],n+=(r&He)*Vi,r<ie)||(r=t[e+7],n+=(r&He)*zi,r<ie))return n;throw new RangeError("Could not decode varint")}function rp(t,e){let r=t.get(e),n=0;if(n+=r&He,r<ie||(r=t.get(e+1),n+=(r&He)<<7,r<ie)||(r=t.get(e+2),n+=(r&He)<<14,r<ie)||(r=t.get(e+3),n+=(r&He)<<21,r<ie)||(r=t.get(e+4),n+=(r&He)*Ki,r<ie)||(r=t.get(e+5),n+=(r&He)*qi,r<ie)||(r=t.get(e+6),n+=(r&He)*Vi,r<ie)||(r=t.get(e+7),n+=(r&He)*zi,r<ie))return n;throw new RangeError("Could not decode varint")}function Hi(t,e,r=0){return e==null&&(e=ze(pt(t))),e instanceof Uint8Array?J0(t,e,r):ep(t,e,r)}function Zr(t,e=0){return t instanceof Uint8Array?tp(t,e):rp(t,e)}function et(t,e){e==null&&(e=t.reduce((s,i)=>s+i.length,0));let r=ze(e),n=0;for(let s of t)r.set(s,n),n+=s.length;return Er(r)}var pc=Symbol.for("@achingbrain/uint8arraylist");function lc(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let s=r+n.byteLength;if(e<s)return{buf:n,index:e-r};r=s}throw new RangeError("index is out of bounds")}function as(t){return!!t?.[pc]}var Qr=class t{constructor(...e){Object.defineProperty(this,pc,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(as(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(as(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=lc(this.bufs,e);return r.buf[r.index]}set(e,r){let n=lc(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(as(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:s}=this._subList(e,r);return et(n,s)}subarray(e,r){let{bufs:n,length:s}=this._subList(e,r);return n.length===1?n[0]:et(n,s)}sublist(e,r){let{bufs:n,length:s}=this._subList(e,r),i=new t;return i.length=s,i.bufs=n,i}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],s=0;for(let i=0;i<this.bufs.length;i++){let o=this.bufs[i],a=s,f=a+o.byteLength;if(s=f,e>=f)continue;let u=e>=a&&e<f,c=r>a&&r<=f;if(u&&c){if(e===a&&r===f){n.push(o);break}let h=e-a;n.push(o.subarray(h,h+(r-e)));break}if(u){if(e===0){n.push(o);continue}n.push(o.subarray(e-a));continue}if(c){if(r===f){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!as(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let s=n.byteLength;if(s===0)throw new TypeError("search must be at least 1 byte long");let i=256,o=new Int32Array(i);for(let h=0;h<i;h++)o[h]=-1;for(let h=0;h<s;h++)o[n[h]]=h;let a=o,f=this.byteLength-n.byteLength,u=n.byteLength-1,c;for(let h=r;h<=f;h+=c){c=0;for(let l=u;l>=0;l--){let g=this.get(h+l);if(n[l]!==g){c=Math.max(1,l-a[g]);break}}if(c===0)return h}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=ze(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let s=Ft(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt16(0,r,n),this.write(s,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let s=Ft(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt32(0,r,n),this.write(s,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let s=Ft(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigInt64(0,r,n),this.write(s,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=ze(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let s=Ft(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint16(0,r,n),this.write(s,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let s=Ft(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint32(0,r,n),this.write(s,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let s=Ft(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigUint64(0,r,n),this.write(s,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let s=Ft(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat32(0,r,n),this.write(s,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let s=Ft(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat64(0,r,n),this.write(s,e)}equals(e){if(e==null||!(e instanceof t)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Ke(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new t;return n.bufs=e,r==null&&(r=e.reduce((s,i)=>s+i.byteLength,0)),n.length=r,n}};function cs(t){return t[Symbol.asyncIterator]!=null}var us=t=>{let e=pt(t),r=ze(e);return Hi(t,r),us.bytes=e,r};us.bytes=0;function Xr(t,e){e=e??{};let r=e.lengthEncoder??us;function*n(s){let i=r(s.byteLength);i instanceof Uint8Array?yield i:yield*i,s instanceof Uint8Array?yield s:yield*s}return cs(t)?async function*(){for await(let s of t)yield*n(s)}():function*(){for(let s of t)yield*n(s)}()}Xr.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??us;return new Qr(r(t.byteLength),t)};var Jr=_e(yc(),1);var sp=8,ip=1024*1024*4,_r;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(_r||(_r={}));var Wi=t=>{let e=Zr(t);return Wi.bytes=pt(e),e};Wi.bytes=0;function Rn(t,e){let r=new Qr,n=_r.LENGTH,s=-1,i=e?.lengthDecoder??Wi,o=e?.maxLengthLength??sp,a=e?.maxDataLength??ip;function*f(){for(;r.byteLength>0;){if(n===_r.LENGTH)try{if(s=i(r),s<0)throw(0,Jr.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>a)throw(0,Jr.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=i.bytes;r.consume(u),e?.onLength!=null&&e.onLength(s),n=_r.DATA}catch(u){if(u instanceof RangeError){if(r.byteLength>o)throw(0,Jr.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(n===_r.DATA){if(r.byteLength<s)break;let u=r.sublist(0,s);r.consume(s),e?.onData!=null&&e.onData(u),yield u,n=_r.LENGTH}}}return cs(t)?async function*(){for await(let u of t)r.append(u),yield*f();if(r.byteLength>0)throw(0,Jr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let u of t)r.append(u),yield*f();if(r.byteLength>0)throw(0,Jr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Rn.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:i,value:o}=await t.next(r);if(i===!0)return;o!=null&&(yield o)}catch(i){if(i.code==="ERR_UNDER_READ")return{done:!0,value:null};throw i}finally{r=1}}();return Rn(n,{...e??{},onLength:i=>{r=i}})};function fs(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}var hs=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},en=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new hs(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new hs(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var ji=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function It(t={}){return op(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function op(t,e){e=e??{};let r=e.onEnd,n=new en,s,i,o,a=fs(),f=async()=>{try{return n.isEmpty()?o?{done:!0}:await new Promise((y,m)=>{i=E=>{i=null,n.push(E);try{y(t(n))}catch(v){m(v)}return s}}):t(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=fs()})}},u=y=>i!=null?i(y):(n.push(y),s),c=y=>(n=new en,i!=null?i({error:y}):(n.push({error:y}),s)),h=y=>{if(o)return s;if(e?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:y})},l=y=>o?s:(o=!0,y!=null?c(y):u({done:!0})),g=()=>(n=new en,l(),{done:!0}),p=y=>(l(y),{done:!0});if(s={[Symbol.asyncIterator](){return this},next:f,return:g,throw:p,push:h,end:l,get readableLength(){return n.size},onEmpty:async y=>{let m=y?.signal;if(m?.throwIfAborted(),n.isEmpty())return;let E,v;m!=null&&(E=new Promise((T,b)=>{v=()=>{b(new ji)},m.addEventListener("abort",v)}));try{await Promise.race([a.promise,E])}finally{v!=null&&m!=null&&m?.removeEventListener("abort",v)}}},r==null)return s;let d=s;return s={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(y){return d.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return d.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(y){return d.end(y),r!=null&&(r(y),r=void 0),s},get readableLength(){return d.readableLength}},s}function ap(t){return t[Symbol.asyncIterator]!=null}function cp(...t){let e=[];for(let r of t)ap(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=It({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let s of n)r.push(s)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var mc=cp;function Ir(t,...e){if(t==null)throw new Error("Empty pipeline");if($i(t)){let n=t;t=()=>n.source}else if(xc(t)||bc(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&$i(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)$i(r[n])&&(r[n]=fp(r[n]));return up(...r)}var up=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},bc=t=>t?.[Symbol.asyncIterator]!=null,xc=t=>t?.[Symbol.iterator]!=null,$i=t=>t==null?!1:t.sink!=null&&t.source!=null,fp=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=It({objectMode:!0});r.then(()=>{n.end()},o=>{n.end(o)});let s,i=t.source;if(bc(i))s=async function*(){yield*i,n.end()};else if(xc(i))s=function*(){yield*i,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return mc(n,s())}return t.source};var Yi="/floodsub/1.0.0",Zi="/meshsub/1.0.0",ls="/meshsub/1.1.0";var vc="ERR_TOPIC_VALIDATOR_REJECT",wc="ERR_TOPIC_VALIDATOR_IGNORE";var bu=_e(fo(),1),xu={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function vu(t,e){e={...e};let r=bu.default.Reader.create(t),n=t.length,s=n===void 0?r.len:r.pos+n,i={};for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.subscriptions!=null&&i.subscriptions.length>0||(i.subscriptions=[]),i.subscriptions.length<e.maxSubscriptions?i.subscriptions.push(wp(r,r.uint32())):r.skipType(o&7);break;case 2:i.messages!=null&&i.messages.length>0||(i.messages=[]),i.messages.length<e.maxMessages?i.messages.push(Sp(r,r.uint32())):r.skipType(o&7);break;case 3:i.control=Ep(r,r.uint32(),e);break;default:r.skipType(o&7);break}}return i}function wp(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.subscribe=t.bool();break;case 2:n.topic=t.string();break;default:t.skipType(s&7);break}}return n}function Sp(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.from=t.bytes();break;case 2:n.data=t.bytes();break;case 3:n.seqno=t.bytes();break;case 4:n.topic=t.string();break;case 5:n.signature=t.bytes();break;case 6:n.key=t.bytes();break;default:t.skipType(s&7);break}}if(!n.topic)throw Error("missing required 'topic'");return n}function Ep(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.ihave!=null&&s.ihave.length>0||(s.ihave=[]),s.ihave.length<r.maxControlMessages?s.ihave.push(_p(t,t.uint32(),r)):t.skipType(i&7);break;case 2:s.iwant!=null&&s.iwant.length>0||(s.iwant=[]),s.iwant.length<r.maxControlMessages?s.iwant.push(Ip(t,t.uint32(),r)):t.skipType(i&7);break;case 3:s.graft!=null&&s.graft.length>0||(s.graft=[]),s.graft.length<r.maxControlMessages?s.graft.push(Bp(t,t.uint32())):t.skipType(i&7);break;case 4:s.prune!=null&&s.prune.length>0||(s.prune=[]),s.prune.length<r.maxControlMessages?s.prune.push(Tp(t,t.uint32(),r)):t.skipType(i&7);break;default:t.skipType(i&7);break}}return s}function _p(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.topicID=t.string();break;case 2:s.messageIDs!=null&&s.messageIDs.length>0||(s.messageIDs=[]),r.maxIhaveMessageIDs-- >0?s.messageIDs.push(t.bytes()):t.skipType(i&7);break;default:t.skipType(i&7);break}}return s}function Ip(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.messageIDs!=null&&s.messageIDs.length>0||(s.messageIDs=[]),r.maxIwantMessageIDs-- >0?s.messageIDs.push(t.bytes()):t.skipType(i&7);break;default:t.skipType(i&7);break}}return s}function Bp(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.topicID=t.string();break;default:t.skipType(s&7);break}}return n}function Tp(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.topicID=t.string();break;case 2:s.peers!=null&&s.peers.length>0||(s.peers=[]),r.maxPeerInfos-- >0?s.peers.push(Ap(t,t.uint32())):t.skipType(i&7);break;case 3:s.backoff=t.uint64();break;default:t.skipType(i&7);break}}return s}function Ap(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.peerID=t.bytes();break;case 2:n.signedPeerRecord=t.bytes();break;default:t.skipType(s&7);break}}return n}var Eu=_e(Su(),1),{RPC:rn}=Eu.default;var ms=class{gossip;msgs=new Map;msgIdToStrFn;history=[];notValidatedCount=0;constructor(e,r,n){this.gossip=e,this.msgIdToStrFn=n;for(let s=0;s<r;s++)this.history[s]=[]}get size(){return this.msgs.size}put(e,r,n=!1){let{msgIdStr:s}=e;return this.msgs.has(s)?!1:(this.msgs.set(s,{message:r,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:r.topic}),n||this.notValidatedCount++,!0)}observeDuplicate(e,r){let n=this.msgs.get(e);n!=null&&!n.validated&&n.originatingPeers.add(r)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,r){let n=this.msgs.get(e);if(n==null)return null;let s=(n.iwantCounts.get(r)??0)+1;return n.iwantCounts.set(r,s),{msg:n.message,count:s}}getGossipIDs(e){let r=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach(s=>{if((this.msgs.get(s.msgIdStr)?.validated??!1)&&e.has(s.topic)){let o=r.get(s.topic);o==null&&(o=[],r.set(s.topic,o)),o.push(s.msgId)}});return r}validate(e){let r=this.msgs.get(e);if(r==null)return null;r.validated||this.notValidatedCount--;let{message:n,originatingPeers:s}=r;return r.validated=!0,r.originatingPeers=new Set,{message:n,originatingPeers:s}}shift(){this.history[this.history.length-1].forEach(r=>{let n=this.msgs.get(r.msgIdStr);n!=null&&(this.msgs.delete(r.msgIdStr),n.validated||this.notValidatedCount--)}),this.history.pop(),this.history.unshift([])}remove(e){let r=this.msgs.get(e);return r==null?null:(this.msgs.delete(e),r)}};var _u;(function(t){t.StrictSign="StrictSign",t.StrictNoSign="StrictNoSign"})(_u||(_u={}));var nr;(function(t){t[t.Signing=0]="Signing",t[t.Anonymous=1]="Anonymous"})(nr||(nr={}));var Ye;(function(t){t.Error="error",t.Ignore="ignore",t.Reject="reject",t.Blacklisted="blacklisted"})(Ye||(Ye={}));var Ge;(function(t){t.InvalidSignature="invalid_signature",t.InvalidSeqno="invalid_seqno",t.InvalidPeerId="invalid_peerid",t.SignaturePresent="signature_present",t.SeqnoPresent="seqno_present",t.FromPresent="from_present",t.TransformFailed="transform_failed"})(Ge||(Ge={}));var We;(function(t){t.duplicate="duplicate",t.invalid="invalid",t.valid="valid"})(We||(We={}));function ho(t){switch(t){case $e.Ignore:return Ye.Ignore;case $e.Reject:return Ye.Reject;default:throw new Error("Unreachable")}}var Iu;(function(t){t.forward="forward",t.publish="publish"})(Iu||(Iu={}));var Ze;(function(t){t.Fanout="fanout",t.Random="random",t.Subscribed="subscribed",t.Outbound="outbound",t.NotEnough="not_enough",t.Opportunistic="opportunistic"})(Ze||(Ze={}));var mt;(function(t){t.Dc="disconnected",t.BadScore="bad_score",t.Prune="prune",t.Excess="excess"})(mt||(mt={}));var sn;(function(t){t.GraftBackoff="graft_backoff",t.BrokenPromise="broken_promise",t.MessageDeficit="message_deficit",t.IPColocation="IP_colocation"})(sn||(sn={}));var on;(function(t){t.LowScore="low_score",t.MaxIhave="max_ihave",t.MaxIasked="max_iasked"})(on||(on={}));var nn;(function(t){t.graylist="graylist",t.publish="publish",t.gossip="gossip",t.mesh="mesh"})(nn||(nn={}));function Bu(t,e,r){return{protocolsEnabled:t.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:t.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:t.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:t.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEventsFanout:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_fanout_total",help:"Number of times we include peers in a topic mesh for fanout reasons",labelNames:["topic"]}),meshPeerInclusionEventsRandom:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_random_total",help:"Number of times we include peers in a topic mesh for random reasons",labelNames:["topic"]}),meshPeerInclusionEventsSubscribed:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_subscribed_total",help:"Number of times we include peers in a topic mesh for subscribed reasons",labelNames:["topic"]}),meshPeerInclusionEventsOutbound:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_outbound_total",help:"Number of times we include peers in a topic mesh for outbound reasons",labelNames:["topic"]}),meshPeerInclusionEventsNotEnough:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_not_enough_total",help:"Number of times we include peers in a topic mesh for not_enough reasons",labelNames:["topic"]}),meshPeerInclusionEventsOpportunistic:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_opportunistic_total",help:"Number of times we include peers in a topic mesh for opportunistic reasons",labelNames:["topic"]}),meshPeerInclusionEventsUnknown:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_unknown_total",help:"Number of times we include peers in a topic mesh for unknown reasons",labelNames:["topic"]}),meshPeerChurnEventsDisconnected:t.gauge({name:"gossipsub_peer_churn_events_disconnected_total",help:"Number of times we remove peers in a topic mesh for disconnected reasons",labelNames:["topic"]}),meshPeerChurnEventsBadScore:t.gauge({name:"gossipsub_peer_churn_events_bad_score_total",help:"Number of times we remove peers in a topic mesh for bad_score reasons",labelNames:["topic"]}),meshPeerChurnEventsPrune:t.gauge({name:"gossipsub_peer_churn_events_prune_total",help:"Number of times we remove peers in a topic mesh for prune reasons",labelNames:["topic"]}),meshPeerChurnEventsExcess:t.gauge({name:"gossipsub_peer_churn_events_excess_total",help:"Number of times we remove peers in a topic mesh for excess reasons",labelNames:["topic"]}),meshPeerChurnEventsUnknown:t.gauge({name:"gossipsub_peer_churn_events_unknown_total",help:"Number of times we remove peers in a topic mesh for unknown reasons",labelNames:["topic"]}),peersPerProtocol:t.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:t.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:t.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),acceptedMessagesTotal:t.gauge({name:"gossipsub_accepted_messages_total",help:"Total accepted messages for each topic",labelNames:["topic"]}),ignoredMessagesTotal:t.gauge({name:"gossipsub_ignored_messages_total",help:"Total ignored messages for each topic",labelNames:["topic"]}),rejectedMessagesTotal:t.gauge({name:"gossipsub_rejected_messages_total",help:"Total rejected messages for each topic",labelNames:["topic"]}),unknownValidationResultsTotal:t.gauge({name:"gossipsub_unknown_validation_results_total",help:"Total unknown validation results for each topic",labelNames:["topic"]}),asyncValidationMcacheHit:t.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),asyncValidationDelayFromFirstSeenSec:t.histogram({name:"gossipsub_async_validation_delay_from_first_seen",help:"Async validation report delay from first seen in second",buckets:[.01,.03,.1,.3,1,3,10]}),asyncValidationUnknownFirstSeen:t.gauge({name:"gossipsub_async_validation_unknown_first_seen_count_total",help:"Async validation report unknown first seen value for message"}),peerReadStreamError:t.gauge({name:"gossipsub_peer_read_stream_err_count_total",help:"Peer read stream error"}),rpcRecvBytes:t.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:t.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:t.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:t.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:t.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:t.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:t.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:t.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:t.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcDataError:t.gauge({name:"gossipsub_rpc_data_err_count_total",help:"RPC data error"}),rpcRecvError:t.gauge({name:"gossipsub_rpc_recv_err_count_total",help:"RPC recv error"}),rpcRecvNotAccepted:t.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:t.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:t.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:t.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:t.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:t.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:t.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:t.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:t.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:t.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:t.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeersByTopic:t.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),directPeersPublishedTotal:t.gauge({name:"gossipsub_direct_peers_published_total",help:"Total direct peers that we publish a msg to",labelNames:["topic"]}),floodsubPeersPublishedTotal:t.gauge({name:"gossipsub_floodsub_peers_published_total",help:"Total floodsub peers that we publish a msg to",labelNames:["topic"]}),meshPeersPublishedTotal:t.gauge({name:"gossipsub_mesh_peers_published_total",help:"Total mesh peers that we publish a msg to",labelNames:["topic"]}),fanoutPeersPublishedTotal:t.gauge({name:"gossipsub_fanout_peers_published_total",help:"Total fanout peers that we publish a msg to",labelNames:["topic"]}),msgPublishBytes:t.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgPublishTime:t.histogram({name:"gossipsub_msg_publish_seconds",help:"Total time in seconds to publish a message",buckets:[.001,.002,.005,.01,.1,.5,1],labelNames:["topic"]}),msgForwardCount:t.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:t.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:t.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedError:t.gauge({name:"gossipsub_msg_received_error_total",help:"Total count of recv msgs error",labelNames:["topic"]}),prevalidationInvalidTotal:t.gauge({name:"gossipsub_pre_validation_invalid_total",help:"Total count of invalid messages received",labelNames:["topic"]}),prevalidationValidTotal:t.gauge({name:"gossipsub_pre_validation_valid_total",help:"Total count of valid messages received",labelNames:["topic"]}),prevalidationDuplicateTotal:t.gauge({name:"gossipsub_pre_validation_duplicate_total",help:"Total count of duplicate messages received",labelNames:["topic"]}),prevalidationUnknownTotal:t.gauge({name:"gossipsub_pre_validation_unknown_status_total",help:"Total count of unknown_status messages received",labelNames:["topic"]}),msgReceivedInvalid:t.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["error"]}),msgReceivedInvalidByTopic:t.gauge({name:"gossipsub_msg_received_invalid_by_topic_total",help:"Tracks specific invalid message by topic",labelNames:["topic"]}),duplicateMsgDeliveryDelay:t.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,Number(r.maxMeshMessageDeliveriesWindowSec),2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:t.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:t.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:t.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:t.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:t.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:t.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:t.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores"}),scoreWeights:t.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:t.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:t.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:t.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,Number(r.behaviourPenaltyThreshold),2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:t.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:t.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:t.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:t.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:t.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:t.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:t.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:t.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:t.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:t.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:t.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:t.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,Number(r.gossipPromiseExpireSec),2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),iwantPromiseUntracked:t.gauge({name:"gossip_iwant_promise_untracked",help:"Total count of untracked IWANT promise"}),connectedPeersBackoffSec:t.histogram({name:"gossipsub_connected_peers_backoff_seconds",help:"Backoff time in seconds",buckets:[1,2,4,10,20,60,120]}),cacheSize:t.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:t.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:t.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:t.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:t.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:e,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,s,i){let o=this.toTopic(n);switch(s){case Ze.Fanout:this.meshPeerInclusionEventsFanout.inc({topic:o},i);break;case Ze.Random:this.meshPeerInclusionEventsRandom.inc({topic:o},i);break;case Ze.Subscribed:this.meshPeerInclusionEventsSubscribed.inc({topic:o},i);break;case Ze.Outbound:this.meshPeerInclusionEventsOutbound.inc({topic:o},i);break;case Ze.NotEnough:this.meshPeerInclusionEventsNotEnough.inc({topic:o},i);break;case Ze.Opportunistic:this.meshPeerInclusionEventsOpportunistic.inc({topic:o},i);break;default:this.meshPeerInclusionEventsUnknown.inc({topic:o},i);break}},onRemoveFromMesh(n,s,i){let o=this.toTopic(n);switch(s){case mt.Dc:this.meshPeerChurnEventsDisconnected.inc({topic:o},i);break;case mt.BadScore:this.meshPeerChurnEventsBadScore.inc({topic:o},i);break;case mt.Prune:this.meshPeerChurnEventsPrune.inc({topic:o},i);break;case mt.Excess:this.meshPeerChurnEventsExcess.inc({topic:o},i);break;default:this.meshPeerChurnEventsUnknown.inc({topic:o},i);break}},onReportValidation(n,s,i){if(this.asyncValidationMcacheHit.inc({hit:n!=null?"hit":"miss"}),n!=null){let o=this.toTopic(n.message.topic);switch(s){case $e.Accept:this.acceptedMessagesTotal.inc({topic:o});break;case $e.Ignore:this.ignoredMessagesTotal.inc({topic:o});break;case $e.Reject:this.rejectedMessagesTotal.inc({topic:o});break;default:this.unknownValidationResultsTotal.inc({topic:o});break}}i!=null?this.asyncValidationDelayFromFirstSeenSec.observe((Date.now()-i)/1e3):this.asyncValidationUnknownFirstSeen.inc()},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,s,i){let o=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:o},s),this.ihaveRcvNotSeenMsgids.inc({topic:o},i)},onIwantRcv(n,s){for(let[i,o]of n){let a=this.toTopic(i);this.iwantRcvMsgids.inc({topic:a},o)}this.iwantRcvDonthaveMsgids.inc(s)},onForwardMsg(n,s){let i=this.toTopic(n);this.msgForwardCount.inc({topic:i},1),this.msgForwardPeers.inc({topic:i},s)},onPublishMsg(n,s,i,o,a){let f=this.toTopic(n);this.msgPublishCount.inc({topic:f},1),this.msgPublishBytes.inc({topic:f},i*o),this.msgPublishPeersByTopic.inc({topic:f},i),this.directPeersPublishedTotal.inc({topic:f},s.direct),this.floodsubPeersPublishedTotal.inc({topic:f},s.floodsub),this.meshPeersPublishedTotal.inc({topic:f},s.mesh),this.fanoutPeersPublishedTotal.inc({topic:f},s.fanout),this.msgPublishTime.observe({topic:f},a/1e3)},onMsgRecvPreValidation(n){let s=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:s},1)},onMsgRecvError(n){let s=this.toTopic(n);this.msgReceivedError.inc({topic:s},1)},onPrevalidationResult(n,s){let i=this.toTopic(n);switch(s){case We.duplicate:this.prevalidationDuplicateTotal.inc({topic:i});break;case We.invalid:this.prevalidationInvalidTotal.inc({topic:i});break;case We.valid:this.prevalidationValidTotal.inc({topic:i});break;default:this.prevalidationUnknownTotal.inc({topic:i});break}},onMsgRecvInvalid(n,s){let i=this.toTopic(n),o=s.reason===Ye.Error?s.error:s.reason;this.msgReceivedInvalid.inc({error:o},1),this.msgReceivedInvalidByTopic.inc({topic:i},1)},onDuplicateMsgDelivery(n,s,i){let o=this.toTopic(n);this.duplicateMsgDeliveryDelay.observe({topic:o},s/1e3),i&&this.duplicateMsgLateDelivery.inc({topic:o},1)},onPublishDuplicateMsg(n){let s=this.toTopic(n);this.duplicateMsgIgnored.inc({topic:s},1)},onPeerReadStreamError(){this.peerReadStreamError.inc(1)},onRpcRecvError(){this.rpcRecvError.inc(1)},onRpcDataError(){this.rpcDataError.inc(1)},onRpcRecv(n,s){this.rpcRecvBytes.inc(s),this.rpcRecvCount.inc(1),n.subscriptions!=null&&this.rpcRecvSubscription.inc(n.subscriptions.length),n.messages!=null&&this.rpcRecvMessage.inc(n.messages.length),n.control!=null&&(this.rpcRecvControl.inc(1),n.control.ihave!=null&&this.rpcRecvIHave.inc(n.control.ihave.length),n.control.iwant!=null&&this.rpcRecvIWant.inc(n.control.iwant.length),n.control.graft!=null&&this.rpcRecvGraft.inc(n.control.graft.length),n.control.prune!=null&&this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,s){if(this.rpcSentBytes.inc(s),this.rpcSentCount.inc(1),n.subscriptions!=null&&this.rpcSentSubscription.inc(n.subscriptions.length),n.messages!=null&&this.rpcSentMessage.inc(n.messages.length),n.control!=null){let i=n.control.ihave?.length??0,o=n.control.iwant?.length??0,a=n.control.graft?.length??0,f=n.control.prune?.length??0;i>0&&this.rpcSentIHave.inc(i),o>0&&this.rpcSentIWant.inc(o),a>0&&this.rpcSentGraft.inc(a),f>0&&this.rpcSentPrune.inc(f),(i>0||o>0||a>0||f>0)&&this.rpcSentControl.inc(1)}},registerScores(n,s){let i=0,o=0,a=0,f=0;for(let u of n)u>=s.graylistThreshold&&i++,u>=s.publishThreshold&&o++,u>=s.gossipThreshold&&a++,u>=0&&f++;this.peersByScoreThreshold.set({threshold:nn.graylist},i),this.peersByScoreThreshold.set({threshold:nn.publish},o),this.peersByScoreThreshold.set({threshold:nn.gossip},a),this.peersByScoreThreshold.set({threshold:nn.mesh},f),this.score.set(n)},registerScoreWeights(n){for(let[s,i]of n.byTopic)this.scoreWeights.set({topic:s,p:"p1"},i.p1w),this.scoreWeights.set({topic:s,p:"p2"},i.p2w),this.scoreWeights.set({topic:s,p:"p3"},i.p3w),this.scoreWeights.set({topic:s,p:"p3b"},i.p3bw),this.scoreWeights.set({topic:s,p:"p4"},i.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,s){let i=new Map;n.forEach((o,a)=>{let f=this.topicStrToLabel.get(a)??"unknown",u=i.get(f);u==null&&(u=new Set,i.set(f,u)),o.forEach(c=>u?.add(c))});for(let[o,a]of i){let f=[];a.forEach(u=>{f.push(s.get(u)??0)}),this.scorePerMesh.set({topic:o},f)}}}}var fe="ERR_INVALID_PEER_SCORE_PARAMS";var Cp={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},Pp={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function Tu(t={}){return{...Cp,...t,topics:t.topics!=null?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=Rp(n),e),{}):{}}}function Rp(t={}){return{...Pp,...t}}function Au(t){for(let[e,r]of Object.entries(t.topics))try{Dp(r)}catch(n){throw new U(`invalid score parameters for topic ${e}: ${n.message}`,fe)}if(t.topicScoreCap<0)throw new U("invalid topic score cap; must be positive (or 0 for no cap)",fe);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw new U("missing application specific score function",fe);if(t.IPColocationFactorWeight>0)throw new U("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",fe);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw new U("invalid IPColocationFactorThreshold; must be at least 1",fe);if(t.behaviourPenaltyWeight>0)throw new U("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",fe);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw new U("invalid BehaviourPenaltyDecay; must be between 0 and 1",fe);if(t.decayInterval<1e3)throw new U("invalid DecayInterval; must be at least 1s",fe);if(t.decayToZero<=0||t.decayToZero>=1)throw new U("invalid DecayToZero; must be between 0 and 1",fe)}function Dp(t){if(t.topicWeight<0)throw new U("invalid topic weight; must be >= 0",fe);if(t.timeInMeshQuantum===0)throw new U("invalid TimeInMeshQuantum; must be non zero",fe);if(t.timeInMeshWeight<0)throw new U("invalid TimeInMeshWeight; must be positive (or 0 to disable)",fe);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw new U("invalid TimeInMeshQuantum; must be positive",fe);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw new U("invalid TimeInMeshCap; must be positive",fe);if(t.firstMessageDeliveriesWeight<0)throw new U("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",fe);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw new U("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",fe);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw new U("invalid FirstMessageDeliveriesCap; must be positive",fe);if(t.meshMessageDeliveriesWeight>0)throw new U("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",fe);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw new U("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",fe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw new U("invalid MeshMessageDeliveriesCap; must be positive",fe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw new U("invalid MeshMessageDeliveriesThreshold; must be positive",fe);if(t.meshMessageDeliveriesWindow<0)throw new U("invalid MeshMessageDeliveriesWindow; must be non-negative",fe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw new U("invalid MeshMessageDeliveriesActivation; must be at least 1s",fe);if(t.meshFailurePenaltyWeight>0)throw new U("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",fe);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw new U("invalid MeshFailurePenaltyDecay; must be between 0 and 1",fe);if(t.invalidMessageDeliveriesWeight>0)throw new U("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",fe);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw new U("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",fe)}var kp={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function Cu(t={}){return{...kp,...t}}function xs(t,e,r=()=>!0){let n=new Set;if(e<=0)return n;for(let s of t){if(n.size>=e)break;r(s)&&(n.add(s),t.delete(s))}return n}function Pu(t,e){return xs(t,e,()=>!0)}var bs=class extends Map{getDefault;constructor(e){super(),this.getDefault=e}getOrDefault(e){let r=super.get(e);return r===void 0&&(r=this.getDefault(),this.set(e,r)),r}};function Ru(t,e,r,n){let s=0;Object.entries(e.topics).forEach(([o,a])=>{let f=r.topics[o];if(f===void 0)return;let u=0;if(a.inMesh){let g=a.meshTime/f.timeInMeshQuantum;g>f.timeInMeshCap&&(g=f.timeInMeshCap),u+=g*f.timeInMeshWeight}let c=a.firstMessageDeliveries;if(c>f.firstMessageDeliveriesCap&&(c=f.firstMessageDeliveriesCap),u+=c*f.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<f.meshMessageDeliveriesThreshold){let g=f.meshMessageDeliveriesThreshold-a.meshMessageDeliveries,p=g*g;u+=p*f.meshMessageDeliveriesWeight}let h=a.meshFailurePenalty;u+=h*f.meshFailurePenaltyWeight;let l=a.invalidMessageDeliveries*a.invalidMessageDeliveries;u+=l*f.invalidMessageDeliveriesWeight,s+=u*f.topicWeight}),r.topicScoreCap>0&&s>r.topicScoreCap&&(s=r.topicScoreCap);let i=r.appSpecificScore(t);if(s+=i*r.appSpecificWeight,e.knownIPs.forEach(o=>{if(r.IPColocationFactorWhitelist.has(o))return;let a=n.get(o),f=a!=null?a.size:0;if(f>r.IPColocationFactorThreshold){let u=f-r.IPColocationFactorThreshold,c=u*u;s+=c*r.IPColocationFactorWeight}}),e.behaviourPenalty>r.behaviourPenaltyThreshold){let o=e.behaviourPenalty-r.behaviourPenaltyThreshold,a=o*o;s+=a*r.behaviourPenaltyWeight}return s}var Mu=_e(ku(),1);var Qe;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(Qe||(Qe={}));var vs=class{records;queue;constructor(){this.records=new Map,this.queue=new Mu.default}getRecord(e){return this.records.get(e)}ensureRecord(e){let r=this.records.get(e);if(r!=null)return r;r={status:Qe.unknown,firstSeenTsMs:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r!=null&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};var ws=class{params;metrics;peerStats=new Map;peerIPs=new bs(()=>new Set);scoreCache=new Map;deliveryRecords=new vs;_backgroundInterval;scoreCacheValidityMs;computeScore;log;constructor(e,r,n,s){this.params=e,this.metrics=r,Au(e),this.scoreCacheValidityMs=s.scoreCacheValidityMs,this.computeScore=s.computeScore??Ru,this.log=n.forComponent("libp2p:gossipsub:score")}get size(){return this.peerStats.size}start(){if(this._backgroundInterval!=null){this.log("Peer score already running");return}this._backgroundInterval=setInterval(()=>{this.background()},this.params.decayInterval),this.log("started")}stop(){if(this._backgroundInterval==null){this.log("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),this.log("stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,r])=>[e,r]))}messageFirstSeenTimestampMs(e){let r=this.deliveryRecords.getRecord(e);return r!=null?r.firstSeenTsMs:null}refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,s)=>{if(!n.connected){e>n.expire&&(this.removeIPsForPeer(s,n.knownIPs),this.peerStats.delete(s),this.scoreCache.delete(s));return}Object.entries(n.topics).forEach(([i,o])=>{let a=this.params.topics[i];a!==void 0&&(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(e);if(r==null)return 0;let n=Date.now(),s=this.scoreCache.get(e);if(s!=null&&s.cacheUntil>n)return s.score;this.metrics?.scoreFnRuns.inc();let i=this.computeScore(e,r,this.params,this.peerIPs),o=n+this.scoreCacheValidityMs;return s!=null?(this.metrics?.scoreCachedDelta.observe(Math.abs(i-s.score)),s.score=i,s.cacheUntil=o):this.scoreCache.set(e,{score:i,cacheUntil:o}),i}addPenalty(e,r,n){let s=this.peerStats.get(e);s!=null&&(s.behaviourPenalty+=r,this.metrics?.onScorePenalty(n))}addPeer(e){let r={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,r)}addIP(e,r){let n=this.peerStats.get(e);n?.knownIPs.add(r),this.peerIPs.getOrDefault(r).add(e)}removeIP(e,r){let n=this.peerStats.get(e);n?.knownIPs.delete(r);let s=this.peerIPs.get(r);s!=null&&(s.delete(e),s.size===0&&this.peerIPs.delete(r))}removePeer(e){let r=this.peerStats.get(e);if(r!=null){if(this.score(e)>0){this.removeIPsForPeer(e,r.knownIPs),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([n,s])=>{s.firstMessageDeliveries=0;let i=this.params.topics[n].meshMessageDeliveriesThreshold;if(s.inMesh&&s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){let o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.inMesh=!1,s.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(n!=null){let s=this.getPtopicStats(n,r);s!=null&&(s.inMesh=!0,s.graftTime=Date.now(),s.meshTime=0,s.meshMessageDeliveriesActive=!1)}}prune(e,r){let n=this.peerStats.get(e);if(n!=null){let s=this.getPtopicStats(n,r);if(s!=null){let i=this.params.topics[r].meshMessageDeliveriesThreshold;if(s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){let o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.meshMessageDeliveriesActive=!1,s.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,r,n){this.markFirstMessageDelivery(e,n);let s=this.deliveryRecords.ensureRecord(r),i=Date.now();if(s.status!==Qe.unknown){this.log("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,i-s.firstSeenTsMs,Qe[s.status]);return}s.status=Qe.valid,s.validated=i,s.peers.forEach(o=>{o!==e.toString()&&this.markDuplicateMessageDelivery(o,n)})}rejectInvalidMessage(e,r){this.markInvalidMessageDelivery(e,r)}rejectMessage(e,r,n,s){switch(s){case Ye.Error:this.markInvalidMessageDelivery(e,n);return;case Ye.Blacklisted:return}let i=this.deliveryRecords.ensureRecord(r);if(i.status!==Qe.unknown){this.log("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-i.firstSeenTsMs,Qe[i.status]);return}if(s===Ye.Ignore){i.status=Qe.ignored,i.peers.clear();return}i.status=Qe.invalid,this.markInvalidMessageDelivery(e,n),i.peers.forEach(o=>{this.markInvalidMessageDelivery(o,n)}),i.peers.clear()}duplicateMessage(e,r,n){let s=this.deliveryRecords.ensureRecord(r);if(!s.peers.has(e))switch(s.status){case Qe.unknown:s.peers.add(e);break;case Qe.valid:s.peers.add(e),this.markDuplicateMessageDelivery(e,n,s.validated);break;case Qe.invalid:this.markInvalidMessageDelivery(e,n);break;case Qe.ignored:break}}markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);if(n!=null){let s=this.getPtopicStats(n,r);s!=null&&(s.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);if(n!=null){let s=this.getPtopicStats(n,r);if(s!=null){let i=this.params.topics[r].firstMessageDeliveriesCap;s.firstMessageDeliveries=Math.min(i,s.firstMessageDeliveries+1),s.inMesh&&(i=this.params.topics[r].meshMessageDeliveriesCap,s.meshMessageDeliveries=Math.min(i,s.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,r,n){let s=this.peerStats.get(e);if(s!=null){let i=n!==void 0?Date.now():0,o=this.getPtopicStats(s,r);if(o!=null&&o.inMesh){let a=this.params.topics[r];if(n!==void 0){let u=i-n,c=u>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,u,c),c)return}let f=a.meshMessageDeliveriesCap;o.meshMessageDeliveries=Math.min(f,o.meshMessageDeliveries+1)}}}removeIPsForPeer(e,r){for(let n of r){let s=this.peerIPs.get(n);s!=null&&(s.delete(e),s.size===0&&this.peerIPs.delete(n))}}getPtopicStats(e,r){let n=e.topics[r];return n!==void 0?n:this.params.topics[r]!==void 0?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[r]=n,n):null}};function Np(t,e,r,n,s){let i=0,o=new Map;if(Object.entries(e.topics).forEach(([l,g])=>{let p=s.get(l)??"unknown",d=r.topics[l];if(d===void 0)return;let y=o.get(p);y==null&&(y={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(p,y));let m=0,E=0,v=0,T=0,b=0;if(g.inMesh){let F=Math.max(g.meshTime/d.timeInMeshQuantum,d.timeInMeshCap);m+=F*d.timeInMeshWeight}let S=g.firstMessageDeliveries;if(S>d.firstMessageDeliveriesCap&&(S=d.firstMessageDeliveriesCap),E+=S*d.firstMessageDeliveriesWeight,g.meshMessageDeliveriesActive&&g.meshMessageDeliveries<d.meshMessageDeliveriesThreshold){let F=d.meshMessageDeliveriesThreshold-g.meshMessageDeliveries,K=F*F;v+=K*d.meshMessageDeliveriesWeight}let I=g.meshFailurePenalty;T+=I*d.meshFailurePenaltyWeight;let C=g.invalidMessageDeliveries*g.invalidMessageDeliveries;b+=C*d.invalidMessageDeliveriesWeight,i+=(m+E+v+T+b)*d.topicWeight,y.p1w+=m,y.p2w+=E,y.p3w+=v,y.p3bw+=T,y.p4w+=b}),r.topicScoreCap>0&&i>r.topicScoreCap){i=r.topicScoreCap;let l=r.topicScoreCap/i;for(let g of o.values())g.p1w*=l,g.p2w*=l,g.p3w*=l,g.p3bw*=l,g.p4w*=l}let a=0,f=0,u=0,c=r.appSpecificScore(t);a+=c*r.appSpecificWeight,e.knownIPs.forEach(l=>{if(r.IPColocationFactorWhitelist.has(l))return;let g=n.get(l),p=g!=null?g.size:0;if(p>r.IPColocationFactorThreshold){let d=p-r.IPColocationFactorThreshold,y=d*d;f+=y*r.IPColocationFactorWeight}});let h=e.behaviourPenalty*e.behaviourPenalty;return u+=h*r.behaviourPenaltyWeight,i+=a+f+u,{byTopic:o,p5w:a,p6w:f,p7w:u,score:i}}function Nu(t,e,r,n,s){let i={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let o of t){let a=e.get(o);if(a!=null){let f=Np(o,a,r,n,s);for(let[u,c]of f.byTopic){let h=i.byTopic.get(u);h==null&&(h={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},i.byTopic.set(u,h)),h.p1w.push(c.p1w),h.p2w.push(c.p2w),h.p3w.push(c.p3w),h.p3bw.push(c.p3bw),h.p4w.push(c.p4w)}i.p5w.push(f.p5w),i.p6w.push(f.p6w),i.p7w.push(f.p7w),i.score.push(f.score)}else i.p5w.push(0),i.p6w.push(0),i.p7w.push(0),i.score.push(0)}return i}var Ln=class extends Error{constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Lu(t){if(t!=null){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}function Ss(t,e,r){let n=r??{},s=Lu(t);async function*i(){let o,a=()=>{o?.()};for(e.addEventListener("abort",a);;){let f;try{if(e.aborted){let{abortMessage:c,abortCode:h}=n;throw new Ln(c,h)}let u=new Promise((c,h)=>{o=()=>{let{abortMessage:l,abortCode:g}=n;h(new Ln(l,g))}});f=await Promise.race([u,s.next()]),o=null}catch(u){e.removeEventListener("abort",a);let c=u.type==="aborted"&&e.aborted;if(c&&n.onAbort!=null&&n.onAbort(t),typeof s.return=="function")try{let h=s.return();h instanceof Promise&&h.catch(l=>{n.onReturnError!=null&&n.onReturnError(l)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(c&&n.returnOnAbort===!0)return;throw u}if(f.done===!0)break;yield f.value}e.removeEventListener("abort",a)}return i()}var Es=class{rawStream;pushable;lpPushable;closeController;maxBufferSize;constructor(e,r,n){this.rawStream=e,this.pushable=It({objectMode:!1}),this.lpPushable=It({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=n.maxBufferSize??1/0,Ir(Ss(this.pushable,this.closeController.signal,{returnOnAbort:!0}),s=>Xr(s),this.rawStream).catch(r),Ir(Ss(this.lpPushable,this.closeController.signal,{returnOnAbort:!0}),this.rawStream).catch(r)}get protocol(){return this.rawStream.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}pushPrefixed(e){if(this.lpPushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.lpPushable.push(e)}async close(){this.closeController.abort(),await this.pushable.return(),await this.lpPushable.return(),await this.rawStream.close()}},_s=class{source;rawStream;closeController;constructor(e,r={}){this.rawStream=e,this.closeController=new AbortController,this.source=Ss(Ir(this.rawStream,n=>Rn(n,r)),this.closeController.signal,{returnOnAbort:!0})}async close(){this.closeController.abort(),await this.rawStream.close()}};var Is=class{gossipsubIWantFollowupMs;msgIdToStrFn;metrics;promises=new Map;requestMsByMsg=new Map;requestMsByMsgExpire;constructor(e,r,n){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=r,this.metrics=n,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,r){let n=Math.floor(Math.random()*r.length),s=r[n],i=this.msgIdToStrFn(s),o=this.promises.get(i);o==null&&(o=new Map,this.promises.set(i,o));let a=Date.now();o.has(e)||(o.set(e,a+this.gossipsubIWantFollowupMs),this.metrics!=null&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(i)||this.requestMsByMsg.set(i,a)))}getBrokenPromises(){let e=Date.now(),r=new Map,n=0;return this.promises.forEach((s,i)=>{s.forEach((o,a)=>{o<e&&(r.set(a,(r.get(a)??0)+1),s.delete(a),n++)}),s.size===0&&this.promises.delete(i)}),this.metrics?.iwantPromiseBroken.inc(n),r}deliverMessage(e,r=!1){this.trackMessage(e);let n=this.promises.get(e);n!=null&&(this.promises.delete(e),this.metrics!=null&&(this.metrics.iwantPromiseResolved.inc(1),r&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(n.size)))}rejectMessage(e,r){switch(this.trackMessage(e),r){case Ye.Error:return;default:break}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire,r=0;for(let[n,s]of this.requestMsByMsg.entries())if(s<e)this.requestMsByMsg.delete(n),r++;else break;this.metrics?.iwantMessagePruned.inc(r)}trackMessage(e){if(this.metrics!=null){let r=this.requestMsByMsg.get(e);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(e))}}};var Dv=_e(Ps(),1),Hp=_e(ce(),1);function Xu(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Qu=Xu("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),_o=Xu("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=ze(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),zp={utf8:Qu,"utf-8":Qu,hex:Jt.base16,latin1:_o,ascii:_o,binary:_o,...Jt},Rs=zp;function Te(t,e="utf8"){let r=Rs[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Er(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function le(t,e="utf8"){let r=Rs[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var rt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var d4=_e(Kn(),1),g4=_e(th(),1);var Jm=_e(ce(),1);var pa={};De(pa,{Ed25519PrivateKey:()=>Ur,Ed25519PublicKey:()=>Yn,generateKeyPair:()=>_m,generateKeyPairFromSeed:()=>Lh,unmarshalEd25519PrivateKey:()=>Sm,unmarshalEd25519PublicKey:()=>Em});var uw=_e(Be(),1),fw=_e(Vs(),1),rh=_e(ce(),1);function vt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=et([new Uint8Array(e-r.length),r])}return le(r,"base64url")}function it(t){let e=nh(t);return new rh.default.jsbn.BigInteger(le(e,"base16"),16)}function nh(t,e){let r=Te(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=et([new Uint8Array(e-r.length),r])}return r}function ht(t){return t==null?!1:typeof t.then=="function"&&typeof t.catch=="function"&&typeof t.finally=="function"}function sh(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Lo(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function ih(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");sh(t.outputLen),sh(t.blockLen)}function hn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function oh(t,e){Lo(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Ws=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var ah=t=>t instanceof Uint8Array;var js=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),wt=(t,e)=>t<<32-e|t>>>e,fy=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!fy)throw new Error("Non little-endian hardware is not supported");function Oo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function zn(t){if(typeof t=="string"&&(t=Oo(t)),!ah(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function $s(...t){let e=new Uint8Array(t.reduce((n,s)=>n+s.length,0)),r=0;return t.forEach(n=>{if(!ah(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var ln=class{clone(){return this._cloneInto()}},bw={}.toString;function Ys(t){let e=n=>t().update(zn(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function pn(t=32){if(Ws&&typeof Ws.getRandomValues=="function")return Ws.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function hy(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),f=n?4:0,u=n?0:4;t.setUint32(e+f,o,n),t.setUint32(e+u,a,n)}var dn=class extends ln{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=js(this.buffer)}update(e){hn(this);let{view:r,buffer:n,blockLen:s}=this;e=zn(e);let i=e.length;for(let o=0;o<i;){let a=Math.min(s-this.pos,i-o);if(a===s){let f=js(e);for(;s<=i-o;o+=s)this.process(f,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){hn(this),oh(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:s,isLE:i}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)r[h]=0;hy(n,s-8,BigInt(this.length*8),i),this.process(n,0);let a=js(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=f/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,c[h],i)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};var Zs=BigInt(4294967295),Uo=BigInt(32);function ch(t,e=!1){return e?{h:Number(t&Zs),l:Number(t>>Uo&Zs)}:{h:Number(t>>Uo&Zs)|0,l:Number(t&Zs)|0}}function ly(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){let{h:i,l:o}=ch(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}var py=(t,e)=>BigInt(t>>>0)<<Uo|BigInt(e>>>0),dy=(t,e,r)=>t>>>r,gy=(t,e,r)=>t<<32-r|e>>>r,yy=(t,e,r)=>t>>>r|e<<32-r,my=(t,e,r)=>t<<32-r|e>>>r,by=(t,e,r)=>t<<64-r|e>>>r-32,xy=(t,e,r)=>t>>>r-32|e<<64-r,vy=(t,e)=>e,wy=(t,e)=>t,Sy=(t,e,r)=>t<<r|e>>>32-r,Ey=(t,e,r)=>e<<r|t>>>32-r,_y=(t,e,r)=>e<<r-32|t>>>64-r,Iy=(t,e,r)=>t<<r-32|e>>>64-r;function By(t,e,r,n){let s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}var Ty=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Ay=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Cy=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Py=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,Ry=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),Dy=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0;var ky={fromBig:ch,split:ly,toBig:py,shrSH:dy,shrSL:gy,rotrSH:yy,rotrSL:my,rotrBH:by,rotrBL:xy,rotr32H:vy,rotr32L:wy,rotlSH:Sy,rotlSL:Ey,rotlBH:_y,rotlBL:Iy,add:By,add3L:Ty,add3H:Ay,add4L:Cy,add4H:Py,add5H:Dy,add5L:Ry},Y=ky;var[My,Ny]=(()=>Y.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),cr=new Uint32Array(80),ur=new Uint32Array(80),Fo=class extends dn{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:f,Eh:u,El:c,Fh:h,Fl:l,Gh:g,Gl:p,Hh:d,Hl:y}=this;return[e,r,n,s,i,o,a,f,u,c,h,l,g,p,d,y]}set(e,r,n,s,i,o,a,f,u,c,h,l,g,p,d,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=f|0,this.Eh=u|0,this.El=c|0,this.Fh=h|0,this.Fl=l|0,this.Gh=g|0,this.Gl=p|0,this.Hh=d|0,this.Hl=y|0}process(e,r){for(let v=0;v<16;v++,r+=4)cr[v]=e.getUint32(r),ur[v]=e.getUint32(r+=4);for(let v=16;v<80;v++){let T=cr[v-15]|0,b=ur[v-15]|0,S=Y.rotrSH(T,b,1)^Y.rotrSH(T,b,8)^Y.shrSH(T,b,7),I=Y.rotrSL(T,b,1)^Y.rotrSL(T,b,8)^Y.shrSL(T,b,7),C=cr[v-2]|0,F=ur[v-2]|0,K=Y.rotrSH(C,F,19)^Y.rotrBH(C,F,61)^Y.shrSH(C,F,6),q=Y.rotrSL(C,F,19)^Y.rotrBL(C,F,61)^Y.shrSL(C,F,6),X=Y.add4L(I,q,ur[v-7],ur[v-16]),ue=Y.add4H(X,S,K,cr[v-7],cr[v-16]);cr[v]=ue|0,ur[v]=X|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:f,Dh:u,Dl:c,Eh:h,El:l,Fh:g,Fl:p,Gh:d,Gl:y,Hh:m,Hl:E}=this;for(let v=0;v<80;v++){let T=Y.rotrSH(h,l,14)^Y.rotrSH(h,l,18)^Y.rotrBH(h,l,41),b=Y.rotrSL(h,l,14)^Y.rotrSL(h,l,18)^Y.rotrBL(h,l,41),S=h&g^~h&d,I=l&p^~l&y,C=Y.add5L(E,b,I,Ny[v],ur[v]),F=Y.add5H(C,m,T,S,My[v],cr[v]),K=C|0,q=Y.rotrSH(n,s,28)^Y.rotrBH(n,s,34)^Y.rotrBH(n,s,39),X=Y.rotrSL(n,s,28)^Y.rotrBL(n,s,34)^Y.rotrBL(n,s,39),ue=n&i^n&a^i&a,Oe=s&o^s&f^o&f;m=d|0,E=y|0,d=g|0,y=p|0,g=h|0,p=l|0,{h,l}=Y.add(u|0,c|0,F|0,K|0),u=a|0,c=f|0,a=i|0,f=o|0,i=n|0,o=s|0;let P=Y.add3L(K,X,Oe);n=Y.add3H(P,F,q,ue),s=P|0}({h:n,l:s}=Y.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Y.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:f}=Y.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:u,l:c}=Y.add(this.Dh|0,this.Dl|0,u|0,c|0),{h,l}=Y.add(this.Eh|0,this.El|0,h|0,l|0),{h:g,l:p}=Y.add(this.Fh|0,this.Fl|0,g|0,p|0),{h:d,l:y}=Y.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:m,l:E}=Y.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,s,i,o,a,f,u,c,h,l,g,p,d,y,m,E)}roundClean(){cr.fill(0),ur.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Ko=Ys(()=>new Fo);var Js={};De(Js,{bitGet:()=>Vy,bitLen:()=>qy,bitMask:()=>Hn,bitSet:()=>zy,bytesToHex:()=>zt,bytesToNumberBE:()=>Ht,bytesToNumberLE:()=>fr,concatBytes:()=>Gt,createHmacDrbg:()=>zo,ensureBytes:()=>Ee,equalBytes:()=>Fy,hexToBytes:()=>kr,hexToNumber:()=>Vo,numberToBytesBE:()=>hr,numberToBytesLE:()=>Mr,numberToHexUnpadded:()=>hh,numberToVarBytesBE:()=>Uy,utf8ToBytes:()=>Ky,validateObject:()=>kt});var fh=BigInt(0),Qs=BigInt(1),Ly=BigInt(2),Xs=t=>t instanceof Uint8Array,Oy=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function zt(t){if(!Xs(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Oy[t[r]];return e}function hh(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Vo(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function kr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let s=n*2,i=t.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function Ht(t){return Vo(zt(t))}function fr(t){if(!Xs(t))throw new Error("Uint8Array expected");return Vo(zt(Uint8Array.from(t).reverse()))}function hr(t,e){return kr(t.toString(16).padStart(e*2,"0"))}function Mr(t,e){return hr(t,e).reverse()}function Uy(t){return kr(hh(t))}function Ee(t,e,r){let n;if(typeof e=="string")try{n=kr(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Xs(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let s=n.length;if(typeof r=="number"&&s!==r)throw new Error(`${t} expected ${r} bytes, got ${s}`);return n}function Gt(...t){let e=new Uint8Array(t.reduce((n,s)=>n+s.length,0)),r=0;return t.forEach(n=>{if(!Xs(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function Fy(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ky(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function qy(t){let e;for(e=0;t>fh;t>>=Qs,e+=1);return e}function Vy(t,e){return t>>BigInt(e)&Qs}var zy=(t,e,r)=>t|(r?Qs:fh)<<BigInt(e),Hn=t=>(Ly<<BigInt(t-1))-Qs,qo=t=>new Uint8Array(t),uh=t=>Uint8Array.from(t);function zo(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=qo(t),s=qo(t),i=0,o=()=>{n.fill(1),s.fill(0),i=0},a=(...h)=>r(s,n,...h),f=(h=qo())=>{s=a(uh([0]),h),n=a(),h.length!==0&&(s=a(uh([1]),h),n=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<e;){n=a();let g=n.slice();l.push(g),h+=n.length}return Gt(...l)};return(h,l)=>{o(),f(h);let g;for(;!(g=l(u()));)f();return o(),g}}var Hy={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function kt(t,e,r={}){let n=(s,i,o)=>{let a=Hy[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);let f=t[s];if(!(o&&f===void 0)&&!a(f,t))throw new Error(`Invalid param ${String(s)}=${f} (${typeof f}), expected ${i}`)};for(let[s,i]of Object.entries(e))n(s,i,!1);for(let[s,i]of Object.entries(r))n(s,i,!0);return t}var Re=BigInt(0),me=BigInt(1),Nr=BigInt(2),Gy=BigInt(3),Ho=BigInt(4),lh=BigInt(5),ph=BigInt(8),Wy=BigInt(9),jy=BigInt(16);function he(t,e){let r=t%e;return r>=Re?r:e+r}function $y(t,e,r){if(r<=Re||e<Re)throw new Error("Expected power/modulo > 0");if(r===me)return Re;let n=me;for(;e>Re;)e&me&&(n=n*t%r),t=t*t%r,e>>=me;return n}function be(t,e,r){let n=t;for(;e-- >Re;)n*=n,n%=r;return n}function ei(t,e){if(t===Re||e<=Re)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=he(t,e),n=e,s=Re,i=me,o=me,a=Re;for(;r!==Re;){let u=n/r,c=n%r,h=s-o*u,l=i-a*u;n=r,r=c,s=o,i=a,o=h,a=l}if(n!==me)throw new Error("invert: does not exist");return he(s,e)}function Yy(t){let e=(t-me)/Nr,r,n,s;for(r=t-me,n=0;r%Nr===Re;r/=Nr,n++);for(s=Nr;s<t&&$y(s,e,t)!==t-me;s++);if(n===1){let o=(t+me)/Ho;return function(f,u){let c=f.pow(u,o);if(!f.eql(f.sqr(c),u))throw new Error("Cannot find square root");return c}}let i=(r+me)/Nr;return function(a,f){if(a.pow(f,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,c=a.pow(a.mul(a.ONE,s),r),h=a.pow(f,i),l=a.pow(f,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let g=1;for(let d=a.sqr(l);g<u&&!a.eql(d,a.ONE);g++)d=a.sqr(d);let p=a.pow(c,me<<BigInt(u-g-1));c=a.sqr(p),h=a.mul(h,p),l=a.mul(l,c),u=g}return h}}function Zy(t){if(t%Ho===Gy){let e=(t+me)/Ho;return function(n,s){let i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%ph===lh){let e=(t-lh)/ph;return function(n,s){let i=n.mul(s,Nr),o=n.pow(i,e),a=n.mul(s,o),f=n.mul(n.mul(a,Nr),o),u=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(u),s))throw new Error("Cannot find square root");return u}}return t%jy,Yy(t)}var dh=(t,e)=>(he(t,e)&me)===me,Qy=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Go(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Qy.reduce((n,s)=>(n[s]="function",n),e);return kt(t,r)}function Xy(t,e,r){if(r<Re)throw new Error("Expected power > 0");if(r===Re)return t.ONE;if(r===me)return e;let n=t.ONE,s=e;for(;r>Re;)r&me&&(n=t.mul(n,s)),s=t.sqr(s),r>>=me;return n}function Jy(t,e){let r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function Wo(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ti(t,e,r=!1,n={}){if(t<=Re)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:s,nByteLength:i}=Wo(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Zy(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:Hn(s),ZERO:Re,ONE:me,create:f=>he(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return Re<=f&&f<t},is0:f=>f===Re,isOdd:f=>(f&me)===me,neg:f=>he(-f,t),eql:(f,u)=>f===u,sqr:f=>he(f*f,t),add:(f,u)=>he(f+u,t),sub:(f,u)=>he(f-u,t),mul:(f,u)=>he(f*u,t),pow:(f,u)=>Xy(a,f,u),div:(f,u)=>he(f*ei(u,t),t),sqrN:f=>f*f,addN:(f,u)=>f+u,subN:(f,u)=>f-u,mulN:(f,u)=>f*u,inv:f=>ei(f,t),sqrt:n.sqrt||(f=>o(a,f)),invertBatch:f=>Jy(a,f),cmov:(f,u,c)=>c?u:f,toBytes:f=>r?Mr(f,i):hr(f,i),fromBytes:f=>{if(f.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${f.length}`);return r?fr(f):Ht(f)}});return Object.freeze(a)}function gh(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function yh(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function jo(t){let e=yh(t);return e+Math.ceil(e/2)}function mh(t,e,r=!1){let n=t.length,s=yh(e),i=jo(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);let o=r?Ht(t):fr(t),a=he(o,e-me)+me;return r?Mr(a,s):hr(a,s)}var tm=BigInt(0),$o=BigInt(1);function ri(t,e){let r=(s,i)=>{let o=i.negate();return s?o:i},n=s=>{let i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:r,unsafeLadder(s,i){let o=t.ZERO,a=s;for(;i>tm;)i&$o&&(o=o.add(a)),a=a.double(),i>>=$o;return o},precomputeWindow(s,i){let{windows:o,windowSize:a}=n(i),f=[],u=s,c=u;for(let h=0;h<o;h++){c=u,f.push(c);for(let l=1;l<a;l++)c=c.add(u),f.push(c);u=c.double()}return f},wNAF(s,i,o){let{windows:a,windowSize:f}=n(s),u=t.ZERO,c=t.BASE,h=BigInt(2**s-1),l=2**s,g=BigInt(s);for(let p=0;p<a;p++){let d=p*f,y=Number(o&h);o>>=g,y>f&&(y-=l,o+=$o);let m=d,E=d+Math.abs(y)-1,v=p%2!==0,T=y<0;y===0?c=c.add(r(v,i[m])):u=u.add(r(T,i[E]))}return{p:u,f:c}},wNAFCached(s,i,o,a){let f=s._WINDOW_SIZE||1,u=i.get(s);return u||(u=this.precomputeWindow(s,f),f!==1&&i.set(s,a(u))),this.wNAF(f,u,o)}}}function Gn(t){return Go(t.Fp),kt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Wo(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var St=BigInt(0),ot=BigInt(1),ni=BigInt(2),rm=BigInt(8),nm={zip215:!0};function sm(t){let e=Gn(t);return kt(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function si(t){let e=sm(t),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:f}=e,u=ni<<BigInt(a*8)-ot,c=r.create,h=e.uvRatio||((k,B)=>{try{return{isValid:!0,value:r.sqrt(k*r.inv(B))}}catch{return{isValid:!1,value:St}}}),l=e.adjustScalarBytes||(k=>k),g=e.domain||((k,B,O)=>{if(B.length||O)throw new Error("Contexts/pre-hash are not supported");return k}),p=k=>typeof k=="bigint"&&St<k,d=(k,B)=>p(k)&&p(B)&&k<B,y=k=>k===St||d(k,u);function m(k,B){if(d(k,B))return k;throw new Error(`Expected valid scalar < ${B}, got ${typeof k} ${k}`)}function E(k){return k===St?k:m(k,n)}let v=new Map;function T(k){if(!(k instanceof b))throw new Error("ExtendedPoint expected")}class b{constructor(B,O,V,G){if(this.ex=B,this.ey=O,this.ez=V,this.et=G,!y(B))throw new Error("x required");if(!y(O))throw new Error("y required");if(!y(V))throw new Error("z required");if(!y(G))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(B){if(B instanceof b)throw new Error("extended point not allowed");let{x:O,y:V}=B||{};if(!y(O)||!y(V))throw new Error("invalid affine point");return new b(O,V,ot,c(O*V))}static normalizeZ(B){let O=r.invertBatch(B.map(V=>V.ez));return B.map((V,G)=>V.toAffine(O[G])).map(b.fromAffine)}_setWindowSize(B){this._WINDOW_SIZE=B,v.delete(this)}assertValidity(){let{a:B,d:O}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:V,ey:G,ez:Z,et:J}=this,ae=c(V*V),ee=c(G*G),se=c(Z*Z),Ae=c(se*se),we=c(ae*B),Ue=c(se*c(we+ee)),Fe=c(Ae+c(O*c(ae*ee)));if(Ue!==Fe)throw new Error("bad point: equation left != right (1)");let Ce=c(V*G),qe=c(Z*J);if(Ce!==qe)throw new Error("bad point: equation left != right (2)")}equals(B){T(B);let{ex:O,ey:V,ez:G}=this,{ex:Z,ey:J,ez:ae}=B,ee=c(O*ae),se=c(Z*G),Ae=c(V*ae),we=c(J*G);return ee===se&&Ae===we}is0(){return this.equals(b.ZERO)}negate(){return new b(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){let{a:B}=e,{ex:O,ey:V,ez:G}=this,Z=c(O*O),J=c(V*V),ae=c(ni*c(G*G)),ee=c(B*Z),se=O+V,Ae=c(c(se*se)-Z-J),we=ee+J,Ue=we-ae,Fe=ee-J,Ce=c(Ae*Ue),qe=c(we*Fe),Ot=c(Ae*Fe),mr=c(Ue*we);return new b(Ce,qe,mr,Ot)}add(B){T(B);let{a:O,d:V}=e,{ex:G,ey:Z,ez:J,et:ae}=this,{ex:ee,ey:se,ez:Ae,et:we}=B;if(O===BigInt(-1)){let ka=c((Z-G)*(se+ee)),Ma=c((Z+G)*(se-ee)),bi=c(Ma-ka);if(bi===St)return this.double();let Na=c(J*ni*we),La=c(ae*ni*Ae),Oa=La+Na,Ua=Ma+ka,Fa=La-Na,Ml=c(Oa*bi),Nl=c(Ua*Fa),Ll=c(Oa*Fa),Ol=c(bi*Ua);return new b(Ml,Nl,Ol,Ll)}let Ue=c(G*ee),Fe=c(Z*se),Ce=c(ae*V*we),qe=c(J*Ae),Ot=c((G+Z)*(ee+se)-Ue-Fe),mr=qe-Ce,En=qe+Ce,Da=c(Fe-O*Ue),Pl=c(Ot*mr),Rl=c(En*Da),Dl=c(Ot*Da),kl=c(mr*En);return new b(Pl,Rl,kl,Dl)}subtract(B){return this.add(B.negate())}wNAF(B){return C.wNAFCached(this,v,B,b.normalizeZ)}multiply(B){let{p:O,f:V}=this.wNAF(m(B,n));return b.normalizeZ([O,V])[0]}multiplyUnsafe(B){let O=E(B);return O===St?I:this.equals(I)||O===ot?this:this.equals(S)?this.wNAF(O).p:C.unsafeLadder(this,O)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return C.unsafeLadder(this,n).is0()}toAffine(B){let{ex:O,ey:V,ez:G}=this,Z=this.is0();B==null&&(B=Z?rm:r.inv(G));let J=c(O*B),ae=c(V*B),ee=c(G*B);if(Z)return{x:St,y:ot};if(ee!==ot)throw new Error("invZ was invalid");return{x:J,y:ae}}clearCofactor(){let{h:B}=e;return B===ot?this:this.multiplyUnsafe(B)}static fromHex(B,O=!1){let{d:V,a:G}=e,Z=r.BYTES;B=Ee("pointHex",B,Z);let J=B.slice(),ae=B[Z-1];J[Z-1]=ae&-129;let ee=fr(J);ee===St||(O?m(ee,u):m(ee,r.ORDER));let se=c(ee*ee),Ae=c(se-ot),we=c(V*se-G),{isValid:Ue,value:Fe}=h(Ae,we);if(!Ue)throw new Error("Point.fromHex: invalid y coordinate");let Ce=(Fe&ot)===ot,qe=(ae&128)!==0;if(!O&&Fe===St&&qe)throw new Error("Point.fromHex: x=0 and x_0=1");return qe!==Ce&&(Fe=c(-Fe)),b.fromAffine({x:Fe,y:ee})}static fromPrivateKey(B){return q(B).point}toRawBytes(){let{x:B,y:O}=this.toAffine(),V=Mr(O,r.BYTES);return V[V.length-1]|=B&ot?128:0,V}toHex(){return zt(this.toRawBytes())}}b.BASE=new b(e.Gx,e.Gy,ot,c(e.Gx*e.Gy)),b.ZERO=new b(St,ot,ot,St);let{BASE:S,ZERO:I}=b,C=ri(b,a*8);function F(k){return he(k,n)}function K(k){return F(fr(k))}function q(k){let B=a;k=Ee("private key",k,B);let O=Ee("hashed private key",i(k),2*B),V=l(O.slice(0,B)),G=O.slice(B,2*B),Z=K(V),J=S.multiply(Z),ae=J.toRawBytes();return{head:V,prefix:G,scalar:Z,point:J,pointBytes:ae}}function X(k){return q(k).pointBytes}function ue(k=new Uint8Array,...B){let O=Gt(...B);return K(i(g(O,Ee("context",k),!!s)))}function Oe(k,B,O={}){k=Ee("message",k),s&&(k=s(k));let{prefix:V,scalar:G,pointBytes:Z}=q(B),J=ue(O.context,V,k),ae=S.multiply(J).toRawBytes(),ee=ue(O.context,ae,Z,k),se=F(J+ee*G);E(se);let Ae=Gt(ae,Mr(se,r.BYTES));return Ee("result",Ae,a*2)}let P=nm;function M(k,B,O,V=P){let{context:G,zip215:Z}=V,J=r.BYTES;k=Ee("signature",k,2*J),B=Ee("message",B),s&&(B=s(B));let ae=fr(k.slice(J,2*J)),ee,se,Ae;try{ee=b.fromHex(O,Z),se=b.fromHex(k.slice(0,J),Z),Ae=S.multiplyUnsafe(ae)}catch{return!1}if(!Z&&ee.isSmallOrder())return!1;let we=ue(G,se.toRawBytes(),ee.toRawBytes(),B);return se.add(ee.multiplyUnsafe(we)).subtract(Ae).clearCofactor().equals(b.ZERO)}return S._setWindowSize(8),{CURVE:e,getPublicKey:X,sign:Oe,verify:M,ExtendedPoint:b,utils:{getExtendedPublicKey:q,randomPrivateKey:()=>o(r.BYTES),precompute(k=8,B=b.BASE){return B._setWindowSize(k),B.multiply(BigInt(3)),B}}}}var Zo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),bh=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Kw=BigInt(0),im=BigInt(1),Yo=BigInt(2),om=BigInt(5),xh=BigInt(10),am=BigInt(20),cm=BigInt(40),vh=BigInt(80);function um(t){let e=Zo,n=t*t%e*t%e,s=be(n,Yo,e)*n%e,i=be(s,im,e)*t%e,o=be(i,om,e)*i%e,a=be(o,xh,e)*o%e,f=be(a,am,e)*a%e,u=be(f,cm,e)*f%e,c=be(u,vh,e)*u%e,h=be(c,vh,e)*u%e,l=be(h,xh,e)*o%e;return{pow_p_5_8:be(l,Yo,e)*t%e,b2:n}}function fm(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function hm(t,e){let r=Zo,n=he(e*e*e,r),s=he(n*n*e,r),i=um(t*s).pow_p_5_8,o=he(t*n*i,r),a=he(e*o*o,r),f=o,u=he(o*bh,r),c=a===t,h=a===he(-t,r),l=a===he(-t*bh,r);return c&&(o=f),(h||l)&&(o=u),dh(o,r)&&(o=he(-o,r)),{isValid:c||h,value:o}}var Wt=ti(Zo,void 0,!0),Qo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Wt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Ko,randomBytes:pn,adjustScalarBytes:fm,uvRatio:hm},gn=si(Qo);function wh(t,e,r){if(e.length>255)throw new Error("Context is too big");return $s(Oo("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var qw=si({...Qo,domain:wh}),Vw=si({...Qo,domain:wh,prehash:Ko});var lm=(Wt.ORDER+BigInt(3))/BigInt(8),zw=Wt.pow(Yo,lm),Hw=Wt.sqrt(Wt.neg(Wt.ONE)),Gw=(Wt.ORDER-BigInt(5))/BigInt(8),Ww=BigInt(486662);var jw=gh(Wt,Wt.neg(BigInt(486664)));var $w=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Yw=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Zw=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Qw=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Xw=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var yn=32,jt=64,ii=32;function Sh(){let t=gn.utils.randomPrivateKey(),e=gn.getPublicKey(t);return{privateKey:Bh(t,e),publicKey:e}}function Eh(t){if(t.length!==ii)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=gn.getPublicKey(e);return{privateKey:Bh(e,r),publicKey:r}}function _h(t,e){let r=t.subarray(0,ii);return gn.sign(e instanceof Uint8Array?e:e.subarray(),r)}function Ih(t,e,r){return gn.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}function Bh(t,e){let r=new Uint8Array(jt);for(let n=0;n<ii;n++)r[n]=t[n],r[ii+n]=e[n];return r}var Xo={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Jo(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,s=t?.digest??"SHA-256",i=t?.saltLength??16,o=t?.iterations??32767,a=rt.get();r*=8;async function f(h,l){let g=a.getRandomValues(new Uint8Array(i)),p=a.getRandomValues(new Uint8Array(n)),d={name:e,iv:p};typeof l=="string"&&(l=Te(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",Xo,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},v=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,v,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",Xo,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},v=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,v,{name:e,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(d,y,h);return et([g,d.iv,new Uint8Array(m)])}async function u(h,l){let g=h.subarray(0,i),p=h.subarray(i,i+n),d=h.subarray(i+n),y={name:e,iv:p};typeof l=="string"&&(l=Te(l));let m;if(l.length===0)try{let v={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},T=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(v,T,{name:e,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",Xo,{name:"AES-GCM"},!0,["decrypt"])}else{let v={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},T=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(v,T,{name:e,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(y,m,d);return new Uint8Array(E)}return{encrypt:f,decrypt:u}}async function mn(t,e){let n=await Jo().encrypt(t,e);return is.encode(n)}var ea=new Float32Array([-0]),lr=new Uint8Array(ea.buffer);function Ah(t,e,r){ea[0]=t,e[r]=lr[0],e[r+1]=lr[1],e[r+2]=lr[2],e[r+3]=lr[3]}function Ch(t,e){return lr[0]=t[e],lr[1]=t[e+1],lr[2]=t[e+2],lr[3]=t[e+3],ea[0]}var ta=new Float64Array([-0]),je=new Uint8Array(ta.buffer);function Ph(t,e,r){ta[0]=t,e[r]=je[0],e[r+1]=je[1],e[r+2]=je[2],e[r+3]=je[3],e[r+4]=je[4],e[r+5]=je[5],e[r+6]=je[6],e[r+7]=je[7]}function Rh(t,e){return je[0]=t[e],je[1]=t[e+1],je[2]=t[e+2],je[3]=t[e+3],je[4]=t[e+4],je[5]=t[e+5],je[6]=t[e+6],je[7]=t[e+7],ta[0]}var dm=BigInt(Number.MAX_SAFE_INTEGER),gm=BigInt(Number.MIN_SAFE_INTEGER),st=class t{lo;hi;constructor(e,r){this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){let e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){let e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){let e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return Lr;if(e<dm&&e>gm)return this.fromNumber(Number(e));let r=e<0n;r&&(e=-e);let n=e>>32n,s=e-(n<<32n);return r&&(n=~n|0n,s=~s|0n,++s>Dh&&(s=0n,++n>Dh&&(n=0n))),new t(Number(s),Number(n))}static fromNumber(e){if(e===0)return Lr;let r=e<0;r&&(e=-e);let n=e>>>0,s=(e-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new t(n,s)}static from(e){return typeof e=="number"?t.fromNumber(e):typeof e=="bigint"?t.fromBigInt(e):typeof e=="string"?t.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new t(e.low>>>0,e.high>>>0):Lr}},Lr=new st(0,0);Lr.toBigInt=function(){return 0n};Lr.zzEncode=Lr.zzDecode=function(){return this};Lr.length=function(){return 1};var Dh=4294967296n;function kh(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function Mh(t,e,r){if(r-e<1)return"";let s,i=[],o=0,a;for(;e<r;)a=t[e++],a<128?i[o++]=a:a>191&&a<224?i[o++]=(a&31)<<6|t[e++]&63:a>239&&a<365?(a=((a&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,i[o++]=55296+(a>>10),i[o++]=56320+(a&1023)):i[o++]=(a&15)<<12|(t[e++]&63)<<6|t[e++]&63,o>8191&&((s??(s=[])).push(String.fromCharCode.apply(String,i)),o=0);return s!=null?(o>0&&s.push(String.fromCharCode.apply(String,i.slice(0,o))),s.join("")):String.fromCharCode.apply(String,i.slice(0,o))}function ra(t,e,r){let n=r,s,i;for(let o=0;o<t.length;++o)s=t.charCodeAt(o),s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&((i=t.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(i&1023),++o,e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128);return r-n}function Et(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function oi(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}var na=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Et(this,10);return e}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Et(this,4);return oi(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Et(this,4);return oi(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Et(this,4);let e=Ch(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw Et(this,4);let e=Rh(this.buf,this.pos);return this.pos+=8,e}bytes(){let e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Et(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let e=this.bytes();return Mh(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Et(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Et(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){let e=new st(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw Et(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw Et(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Et(this,8);let e=oi(this.buf,this.pos+=4),r=oi(this.buf,this.pos+=4);return new st(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function sa(t){return new na(t instanceof Uint8Array?t:t.subarray())}function ai(t,e){let r=sa(t);return e.decode(r)}function ia(t){let e=t??8192,r=e>>>1,n,s=e;return function(o){if(o<1||o>r)return ze(o);s+o>e&&(n=ze(e),s=0);let a=n.subarray(s,s+=o);return s&7&&(s=(s|7)+1),a}}var Or=class{fn;len;next;val;constructor(e,r,n){this.fn=e,this.len=r,this.next=void 0,this.val=n}};function oa(){}var ca=class{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}},ym=ia();function mm(t){return globalThis.Buffer!=null?ze(t):ym(t)}var $n=class{len;head;tail;states;constructor(){this.len=0,this.head=new Or(oa,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new Or(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new ua((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(Wn,10,st.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){let r=st.fromBigInt(e);return this._push(Wn,r.length(),r)}uint64Number(e){let r=st.fromNumber(e);return this._push(Wn,r.length(),r)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){let r=st.fromBigInt(e).zzEncode();return this._push(Wn,r.length(),r)}sint64Number(e){let r=st.fromNumber(e).zzEncode();return this._push(Wn,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(aa,1,e?1:0)}fixed32(e){return this._push(jn,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){let r=st.fromBigInt(e);return this._push(jn,4,r.lo)._push(jn,4,r.hi)}fixed64Number(e){let r=st.fromNumber(e);return this._push(jn,4,r.lo)._push(jn,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(Ah,4,e)}double(e){return this._push(Ph,8,e)}bytes(e){let r=e.length>>>0;return r===0?this._push(aa,1,0):this.uint32(r)._push(xm,r,e)}string(e){let r=kh(e);return r!==0?this.uint32(r)._push(ra,r,e):this._push(aa,1,0)}fork(){return this.states=new ca(this),this.head=this.tail=new Or(oa,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Or(oa,0,0),this.len=0),this}ldelim(){let e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next,r=mm(this.len),n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}};function aa(t,e,r){e[r]=t&255}function bm(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}var ua=class extends Or{next;constructor(e,r){super(bm,e,r),this.next=void 0}};function Wn(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function jn(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function xm(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&($n.prototype.bytes=function(t){let e=t.length>>>0;return this.uint32(e),e>0&&this._push(vm,e,t),this},$n.prototype.string=function(t){let e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(wm,e,t),this});function vm(t,e,r){e.set(t,r)}function wm(t,e,r){t.length<40?ra(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(Te(t),r)}function fa(){return new $n}function ci(t,e){let r=fa();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var bn;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(bn||(bn={}));function ui(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function ha(t){function e(s){if(t[s.toString()]==null)throw new Error("Invalid enum value");return t[s]}let r=function(i,o){let a=e(i);o.int32(a)},n=function(i){let o=i.int32();return e(o)};return ui("enum",bn.VARINT,r,n)}function fi(t,e){return ui("message",bn.LENGTH_DELIMITED,t,e)}var xe;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(xe||(xe={}));var la;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(la||(la={}));(function(t){t.codec=()=>ha(la)})(xe||(xe={}));var Mt;(function(t){let e;t.codec=()=>(e==null&&(e=fi((r,n,s={})=>{s.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),xe.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),s.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let o=r.uint32();switch(o>>>3){case 1:s.Type=xe.codec().decode(r);break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}return s})),e),t.encode=r=>ci(r,t.codec()),t.decode=r=>ai(r,t.codec())})(Mt||(Mt={}));var Nt;(function(t){let e;t.codec=()=>(e==null&&(e=fi((r,n,s={})=>{s.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),xe.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),s.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let o=r.uint32();switch(o>>>3){case 1:s.Type=xe.codec().decode(r);break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}return s})),e),t.encode=r=>ci(r,t.codec()),t.decode=r=>ai(r,t.codec())})(Nt||(Nt={}));var Yn=class{_key;constructor(e){this._key=xn(e,yn)}verify(e,r){return Ih(this._key,r,e)}marshal(){return this._key}get bytes(){return Mt.encode({Type:xe.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ke(this.bytes,e.bytes)}hash(){let e=Pe.digest(this.bytes);return ht(e)?e.then(({bytes:r})=>r):e.bytes}},Ur=class{_key;_publicKey;constructor(e,r){this._key=xn(e,jt),this._publicKey=xn(r,yn)}sign(e){return _h(this._key,e)}get public(){return new Yn(this._publicKey)}marshal(){return this._key}get bytes(){return Nt.encode({Type:xe.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ke(this.bytes,e.bytes)}async hash(){let e=Pe.digest(this.bytes),r;return ht(e)?{bytes:r}=await e:r=e.bytes,r}async id(){let e=$r.digest(this.public.bytes);return Ve.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return mn(this.bytes,e);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Sm(t){if(t.length>jt){t=xn(t,jt+yn);let n=t.subarray(0,jt),s=t.subarray(jt,t.length);return new Ur(n,s)}t=xn(t,jt);let e=t.subarray(0,jt),r=t.subarray(yn);return new Ur(e,r)}function Em(t){return t=xn(t,yn),new Yn(t)}async function _m(){let{privateKey:t,publicKey:e}=Sh();return new Ur(t,e)}async function Lh(t){let{privateKey:e,publicKey:r}=Eh(t);return new Ur(e,r)}function xn(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new U(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var Im={"P-256":256,"P-384":384,"P-521":521},Bm=Object.keys(Im),YS=Bm.join(" / ");var ba={};De(ba,{MAX_KEY_SIZE:()=>Jn,RsaPrivateKey:()=>vn,RsaPublicKey:()=>Xn,fromJwk:()=>Lm,generateKeyPair:()=>Om,unmarshalRsaPrivateKey:()=>Mm,unmarshalRsaPublicKey:()=>Nm});var Qn=_e(ce(),1);var CE=_e(qh(),1);function pr(t){if(isNaN(t)||t<=0)throw new U("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return pn(t)}var hE=_e(Gs(),1),ya=_e(ce(),1);function Vh(t,e){return e.map(r=>it(t[r]))}function zh(t){return ya.default.pki.setRsaPrivateKey(...Vh(t,["n","e","d","p","q","dp","dq","qi"]))}function Hh(t){return ya.default.pki.setRsaPublicKey(...Vh(t,["n","e"]))}var Kr={};De(Kr,{jwkToPkcs1:()=>Cm,jwkToPkix:()=>Rm,pkcs1ToJwk:()=>Am,pkixToJwk:()=>Pm});var dE=_e(Kn(),1),gE=_e(Gs(),1);var $t=_e(ce(),1);function Am(t){let e=$t.default.asn1.fromDer(le(t,"ascii")),r=$t.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:vt(r.n),e:vt(r.e),d:vt(r.d),p:vt(r.p),q:vt(r.q),dp:vt(r.dP),dq:vt(r.dQ),qi:vt(r.qInv),alg:"RS256"}}function Cm(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new U("JWK was missing components","ERR_INVALID_PARAMETERS");let e=$t.default.pki.privateKeyToAsn1({n:it(t.n),e:it(t.e),d:it(t.d),p:it(t.p),q:it(t.q),dP:it(t.dp),dQ:it(t.dq),qInv:it(t.qi)});return Te($t.default.asn1.toDer(e).getBytes(),"ascii")}function Pm(t){let e=$t.default.asn1.fromDer(le(t,"ascii")),r=$t.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:vt(r.n),e:vt(r.e)}}function Rm(t){if(t.n==null||t.e==null)throw new U("JWK was missing components","ERR_INVALID_PARAMETERS");let e=$t.default.pki.publicKeyToAsn1({n:it(t.n),e:it(t.e)});return Te($t.default.asn1.toDer(e).getBytes(),"ascii")}async function Gh(t){let e=await rt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await $h(e);return{privateKey:r[0],publicKey:r[1]}}async function ma(t){let r=[await rt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Dm(t)],n=await $h({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Wh(t,e){let r=await rt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await rt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(n,0,n.byteLength)}async function jh(t,e,r){let n=await rt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return rt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}async function $h(t){if(t.privateKey==null||t.publicKey==null)throw new U("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([rt.get().subtle.exportKey("jwk",t.privateKey),rt.get().subtle.exportKey("jwk",t.publicKey)])}async function Dm(t){return rt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Yh(t,e,r,n){let s=e?Hh(t):zh(t),i=le(r instanceof Uint8Array?r:r.subarray(),"ascii"),o=n(i,s);return Te(o,"ascii")}function Zh(t,e){return Yh(t,!0,e,(r,n)=>n.encrypt(r))}function Qh(t,e){return Yh(t,!1,e,(r,n)=>n.decrypt(r))}function li(t){if(t.kty!=="RSA")throw new U("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new U("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Te(t.n,"base64url").length*8}var Jn=8192,Xn=class{_key;constructor(e){this._key=e}verify(e,r){return jh(this._key,r,e)}marshal(){return Kr.jwkToPkix(this._key)}get bytes(){return Mt.encode({Type:xe.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Zh(this._key,e)}equals(e){return Ke(this.bytes,e.bytes)}hash(){let e=Pe.digest(this.bytes);return ht(e)?e.then(({bytes:r})=>r):e.bytes}},vn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return pr(16)}sign(e){return Wh(this._key,e)}get public(){if(this._publicKey==null)throw new U("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Xn(this._publicKey)}decrypt(e){return Qh(this._key,e)}marshal(){return Kr.jwkToPkcs1(this._key)}get bytes(){return Nt.encode({Type:xe.RSA,Data:this.marshal()}).subarray()}equals(e){return Ke(this.bytes,e.bytes)}hash(){let e=Pe.digest(this.bytes);return ht(e)?e.then(({bytes:r})=>r):e.bytes}async id(){let e=await this.public.hash();return le(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Qn.default.util.ByteBuffer(this.marshal()),s=Qn.default.asn1.fromDer(n),i=Qn.default.pki.privateKeyFromAsn1(s),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Qn.default.pki.encryptRsaPrivateKey(i,e,o)}else{if(r==="libp2p-key")return mn(this.bytes,e);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function Mm(t){let e=Kr.pkcs1ToJwk(t);if(li(e)>Jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await ma(e);return new vn(r.privateKey,r.publicKey)}function Nm(t){let e=Kr.pkixToJwk(t);if(li(e)>Jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Xn(e)}async function Lm(t){if(li(t)>Jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await ma(t);return new vn(e.privateKey,e.publicKey)}async function Om(t){if(t>Jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Gh(t);return new vn(e.privateKey,e.publicKey)}var _a={};De(_a,{Secp256k1PrivateKey:()=>ts,Secp256k1PublicKey:()=>es,generateKeyPair:()=>Xm,unmarshalSecp256k1PrivateKey:()=>Zm,unmarshalSecp256k1PublicKey:()=>Qm});var Um=(t,e,r)=>t&e^~t&r,Fm=(t,e,r)=>t&e^t&r^e&r,Km=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),dr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),gr=new Uint32Array(64),xa=class extends dn{constructor(){super(64,32,8,!1),this.A=dr[0]|0,this.B=dr[1]|0,this.C=dr[2]|0,this.D=dr[3]|0,this.E=dr[4]|0,this.F=dr[5]|0,this.G=dr[6]|0,this.H=dr[7]|0}get(){let{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:f}=this;return[e,r,n,s,i,o,a,f]}set(e,r,n,s,i,o,a,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=f|0}process(e,r){for(let h=0;h<16;h++,r+=4)gr[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=gr[h-15],g=gr[h-2],p=wt(l,7)^wt(l,18)^l>>>3,d=wt(g,17)^wt(g,19)^g>>>10;gr[h]=d+gr[h-7]+p+gr[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:f,G:u,H:c}=this;for(let h=0;h<64;h++){let l=wt(a,6)^wt(a,11)^wt(a,25),g=c+l+Um(a,f,u)+Km[h]+gr[h]|0,d=(wt(n,2)^wt(n,13)^wt(n,22))+Fm(n,s,i)|0;c=u,u=f,f=a,a=o+g|0,o=i,i=s,s=n,n=g+d|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,f=f+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,s,i,o,a,f,u,c)}roundClean(){gr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Xh=Ys(()=>new xa);function qm(t){let e=Gn(t);kt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:Vm,hexToBytes:zm}=Js,qr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=qr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Vm(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=qr,r=typeof t=="string"?zm(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:s,l:i}=qr._parseInt(r.subarray(2)),{d:o,l:a}=qr._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){let e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let c=u.toString(16);return c.length&1?`0${c}`:c},n=e(r(t.s)),s=e(r(t.r)),i=n.length/2,o=s.length/2,a=r(i),f=r(o);return`30${r(o+i+4)}02${f}${s}02${a}${n}`}},Yt=BigInt(0),lt=BigInt(1),FE=BigInt(2),Jh=BigInt(3),KE=BigInt(4);function Hm(t){let e=qm(t),{Fp:r}=e,n=e.toBytes||((p,d,y)=>{let m=d.toAffine();return Gt(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),s=e.fromBytes||(p=>{let d=p.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),m=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function i(p){let{a:d,b:y}=e,m=r.sqr(p),E=r.mul(m,p);return r.add(r.add(E,r.mul(p,d)),y)}if(!r.eql(r.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Yt<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(p){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(d&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=zt(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let v;try{v=typeof p=="bigint"?p:Ht(Ee("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return m&&(v=he(v,E)),a(v),v}let u=new Map;function c(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(d,y,m){if(this.px=d,this.py=y,this.pz=m,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(d){let{x:y,y:m}=d||{};if(!d||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(d instanceof h)throw new Error("projective point not allowed");let E=v=>r.eql(v,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(m=>m.pz));return d.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(d){let y=h.fromAffine(s(Ee("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return h.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=i(d);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){c(d);let{px:y,py:m,pz:E}=this,{px:v,py:T,pz:b}=d,S=r.eql(r.mul(y,b),r.mul(v,E)),I=r.eql(r.mul(m,b),r.mul(T,E));return S&&I}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=e,m=r.mul(y,Jh),{px:E,py:v,pz:T}=this,b=r.ZERO,S=r.ZERO,I=r.ZERO,C=r.mul(E,E),F=r.mul(v,v),K=r.mul(T,T),q=r.mul(E,v);return q=r.add(q,q),I=r.mul(E,T),I=r.add(I,I),b=r.mul(d,I),S=r.mul(m,K),S=r.add(b,S),b=r.sub(F,S),S=r.add(F,S),S=r.mul(b,S),b=r.mul(q,b),I=r.mul(m,I),K=r.mul(d,K),q=r.sub(C,K),q=r.mul(d,q),q=r.add(q,I),I=r.add(C,C),C=r.add(I,C),C=r.add(C,K),C=r.mul(C,q),S=r.add(S,C),K=r.mul(v,T),K=r.add(K,K),C=r.mul(K,q),b=r.sub(b,C),I=r.mul(K,F),I=r.add(I,I),I=r.add(I,I),new h(b,S,I)}add(d){c(d);let{px:y,py:m,pz:E}=this,{px:v,py:T,pz:b}=d,S=r.ZERO,I=r.ZERO,C=r.ZERO,F=e.a,K=r.mul(e.b,Jh),q=r.mul(y,v),X=r.mul(m,T),ue=r.mul(E,b),Oe=r.add(y,m),P=r.add(v,T);Oe=r.mul(Oe,P),P=r.add(q,X),Oe=r.sub(Oe,P),P=r.add(y,E);let M=r.add(v,b);return P=r.mul(P,M),M=r.add(q,ue),P=r.sub(P,M),M=r.add(m,E),S=r.add(T,b),M=r.mul(M,S),S=r.add(X,ue),M=r.sub(M,S),C=r.mul(F,P),S=r.mul(K,ue),C=r.add(S,C),S=r.sub(X,C),C=r.add(X,C),I=r.mul(S,C),X=r.add(q,q),X=r.add(X,q),ue=r.mul(F,ue),P=r.mul(K,P),X=r.add(X,ue),ue=r.sub(q,ue),ue=r.mul(F,ue),P=r.add(P,ue),q=r.mul(X,P),I=r.add(I,q),q=r.mul(M,P),S=r.mul(Oe,S),S=r.sub(S,q),q=r.mul(Oe,X),C=r.mul(M,C),C=r.add(C,q),new h(S,I,C)}subtract(d){return this.add(d.negate())}is0(){return this.equals(h.ZERO)}wNAF(d){return g.wNAFCached(this,u,d,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,v)=>E.toAffine(m[v])).map(h.fromAffine)})}multiplyUnsafe(d){let y=h.ZERO;if(d===Yt)return y;if(a(d),d===lt)return this;let{endo:m}=e;if(!m)return g.unsafeLadder(this,d);let{k1neg:E,k1:v,k2neg:T,k2:b}=m.splitScalar(d),S=y,I=y,C=this;for(;v>Yt||b>Yt;)v&lt&&(S=S.add(C)),b&lt&&(I=I.add(C)),C=C.double(),v>>=lt,b>>=lt;return E&&(S=S.negate()),T&&(I=I.negate()),I=new h(r.mul(I.px,m.beta),I.py,I.pz),S.add(I)}multiply(d){a(d);let y=d,m,E,{endo:v}=e;if(v){let{k1neg:T,k1:b,k2neg:S,k2:I}=v.splitScalar(y),{p:C,f:F}=this.wNAF(b),{p:K,f:q}=this.wNAF(I);C=g.constTimeNegate(T,C),K=g.constTimeNegate(S,K),K=new h(r.mul(K.px,v.beta),K.py,K.pz),m=C.add(K),E=F.add(q)}else{let{p:T,f:b}=this.wNAF(y);m=T,E=b}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(d,y,m){let E=h.BASE,v=(b,S)=>S===Yt||S===lt||!b.equals(E)?b.multiplyUnsafe(S):b.multiply(S),T=v(this,y).add(v(d,m));return T.is0()?void 0:T}toAffine(d){let{px:y,py:m,pz:E}=this,v=this.is0();d==null&&(d=v?r.ONE:r.inv(E));let T=r.mul(y,d),b=r.mul(m,d),S=r.mul(E,d);if(v)return{x:r.ZERO,y:r.ZERO};if(!r.eql(S,r.ONE))throw new Error("invZ was invalid");return{x:T,y:b}}isTorsionFree(){let{h:d,isTorsionFree:y}=e;if(d===lt)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=e;return d===lt?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),n(h,this,d)}toHex(d=!0){return zt(this.toRawBytes(d))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=e.nBitLength,g=ri(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:i,isWithinCurveOrder:o}}function Gm(t){let e=Gn(t);return kt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function el(t){let e=Gm(t),{Fp:r,n}=e,s=r.BYTES+1,i=2*r.BYTES+1;function o(P){return Yt<P&&P<r.ORDER}function a(P){return he(P,n)}function f(P){return ei(P,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:h,isWithinCurveOrder:l}=Hm({...e,toBytes(P,M,D){let k=M.toAffine(),B=r.toBytes(k.x),O=Gt;return D?O(Uint8Array.from([M.hasEvenY()?2:3]),B):O(Uint8Array.from([4]),B,r.toBytes(k.y))},fromBytes(P){let M=P.length,D=P[0],k=P.subarray(1);if(M===s&&(D===2||D===3)){let B=Ht(k);if(!o(B))throw new Error("Point is not on curve");let O=h(B),V=r.sqrt(O),G=(V&lt)===lt;return(D&1)===1!==G&&(V=r.neg(V)),{x:B,y:V}}else if(M===i&&D===4){let B=r.fromBytes(k.subarray(0,r.BYTES)),O=r.fromBytes(k.subarray(r.BYTES,2*r.BYTES));return{x:B,y:O}}else throw new Error(`Point of length ${M} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),g=P=>zt(hr(P,e.nByteLength));function p(P){let M=n>>lt;return P>M}function d(P){return p(P)?a(-P):P}let y=(P,M,D)=>Ht(P.slice(M,D));class m{constructor(M,D,k){this.r=M,this.s=D,this.recovery=k,this.assertValidity()}static fromCompact(M){let D=e.nByteLength;return M=Ee("compactSignature",M,D*2),new m(y(M,0,D),y(M,D,2*D))}static fromDER(M){let{r:D,s:k}=qr.toSig(Ee("DER",M));return new m(D,k)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(M){return new m(this.r,this.s,M)}recoverPublicKey(M){let{r:D,s:k,recovery:B}=this,O=I(Ee("msgHash",M));if(B==null||![0,1,2,3].includes(B))throw new Error("recovery id invalid");let V=B===2||B===3?D+e.n:D;if(V>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let G=B&1?"03":"02",Z=u.fromHex(G+g(V)),J=f(V),ae=a(-O*J),ee=a(k*J),se=u.BASE.multiplyAndAddUnsafe(Z,ae,ee);if(!se)throw new Error("point at infinify");return se.assertValidity(),se}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return kr(this.toDERHex())}toDERHex(){return qr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return kr(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}let E={isValidPrivateKey(P){try{return c(P),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let P=jo(e.n);return mh(e.randomBytes(P),e.n)},precompute(P=8,M=u.BASE){return M._setWindowSize(P),M.multiply(BigInt(3)),M}};function v(P,M=!0){return u.fromPrivateKey(P).toRawBytes(M)}function T(P){let M=P instanceof Uint8Array,D=typeof P=="string",k=(M||D)&&P.length;return M?k===s||k===i:D?k===2*s||k===2*i:P instanceof u}function b(P,M,D=!0){if(T(P))throw new Error("first arg must be private key");if(!T(M))throw new Error("second arg must be public key");return u.fromHex(M).multiply(c(P)).toRawBytes(D)}let S=e.bits2int||function(P){let M=Ht(P),D=P.length*8-e.nBitLength;return D>0?M>>BigInt(D):M},I=e.bits2int_modN||function(P){return a(S(P))},C=Hn(e.nBitLength);function F(P){if(typeof P!="bigint")throw new Error("bigint expected");if(!(Yt<=P&&P<C))throw new Error(`bigint expected < 2^${e.nBitLength}`);return hr(P,e.nByteLength)}function K(P,M,D=q){if(["recovered","canonical"].some(we=>we in D))throw new Error("sign() legacy options not supported");let{hash:k,randomBytes:B}=e,{lowS:O,prehash:V,extraEntropy:G}=D;O==null&&(O=!0),P=Ee("msgHash",P),V&&(P=Ee("prehashed msgHash",k(P)));let Z=I(P),J=c(M),ae=[F(J),F(Z)];if(G!=null){let we=G===!0?B(r.BYTES):G;ae.push(Ee("extraEntropy",we))}let ee=Gt(...ae),se=Z;function Ae(we){let Ue=S(we);if(!l(Ue))return;let Fe=f(Ue),Ce=u.BASE.multiply(Ue).toAffine(),qe=a(Ce.x);if(qe===Yt)return;let Ot=a(Fe*a(se+qe*J));if(Ot===Yt)return;let mr=(Ce.x===qe?0:2)|Number(Ce.y&lt),En=Ot;return O&&p(Ot)&&(En=d(Ot),mr^=1),new m(qe,En,mr)}return{seed:ee,k2sig:Ae}}let q={lowS:e.lowS,prehash:!1},X={lowS:e.lowS,prehash:!1};function ue(P,M,D=q){let{seed:k,k2sig:B}=K(P,M,D),O=e;return zo(O.hash.outputLen,O.nByteLength,O.hmac)(k,B)}u.BASE._setWindowSize(8);function Oe(P,M,D,k=X){let B=P;if(M=Ee("msgHash",M),D=Ee("publicKey",D),"strict"in k)throw new Error("options.strict was renamed to lowS");let{lowS:O,prehash:V}=k,G,Z;try{if(typeof B=="string"||B instanceof Uint8Array)try{G=m.fromDER(B)}catch(Ce){if(!(Ce instanceof qr.Err))throw Ce;G=m.fromCompact(B)}else if(typeof B=="object"&&typeof B.r=="bigint"&&typeof B.s=="bigint"){let{r:Ce,s:qe}=B;G=new m(Ce,qe)}else throw new Error("PARSE");Z=u.fromHex(D)}catch(Ce){if(Ce.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(O&&G.hasHighS())return!1;V&&(M=e.hash(M));let{r:J,s:ae}=G,ee=I(M),se=f(ae),Ae=a(ee*se),we=a(J*se),Ue=u.BASE.multiplyAndAddUnsafe(Z,Ae,we)?.toAffine();return Ue?a(Ue.x)===J:!1}return{CURVE:e,getPublicKey:v,getSharedSecret:b,sign:ue,verify:Oe,ProjectivePoint:u,Signature:m,utils:E}}var pi=class extends ln{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,ih(e);let n=zn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return hn(this),this.iHash.update(e),this}digestInto(e){hn(this),Lo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},va=(t,e,r)=>new pi(t,e).update(r).digest();va.create=(t,e)=>new pi(t,e);function Wm(t){return{hash:t,hmac:(e,...r)=>va(t,e,$s(...r)),randomBytes:pn}}function tl(t,e){let r=n=>el({...t,...Wm(n)});return Object.freeze({...r(e),create:r})}var sl=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),rl=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),jm=BigInt(1),wa=BigInt(2),nl=(t,e)=>(t+e/wa)/e;function $m(t){let e=sl,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),f=BigInt(88),u=t*t*t%e,c=u*u*t%e,h=be(c,r,e)*c%e,l=be(h,r,e)*c%e,g=be(l,wa,e)*u%e,p=be(g,s,e)*g%e,d=be(p,i,e)*p%e,y=be(d,a,e)*d%e,m=be(y,f,e)*y%e,E=be(m,a,e)*d%e,v=be(E,r,e)*c%e,T=be(v,o,e)*p%e,b=be(T,n,e)*u%e,S=be(b,wa,e);if(!Sa.eql(Sa.sqr(S),t))throw new Error("Cannot find square root");return S}var Sa=ti(sl,void 0,void 0,{sqrt:$m}),_t=tl({a:BigInt(0),b:BigInt(7),Fp:Sa,n:rl,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=rl,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-jm*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=nl(i*t,e),f=nl(-n*t,e),u=he(t-a*r-f*s,e),c=he(-a*n-f*i,e),h=u>o,l=c>o;if(h&&(u=e-u),l&&(c=e-c),u>o||c>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:u,k2neg:l,k2:c}}}},Xh),XE=BigInt(0);var JE=_t.ProjectivePoint;function il(){return _t.utils.randomPrivateKey()}function ol(t,e){let r=Pe.digest(e instanceof Uint8Array?e:e.subarray());if(ht(r))return r.then(({digest:n})=>_t.sign(n,t).toDERRawBytes()).catch(n=>{throw new U(String(n),"ERR_INVALID_INPUT")});try{return _t.sign(r.digest,t).toDERRawBytes()}catch(n){throw new U(String(n),"ERR_INVALID_INPUT")}}function al(t,e,r){let n=Pe.digest(r instanceof Uint8Array?r:r.subarray());if(ht(n))return n.then(({digest:s})=>_t.verify(e,s,t)).catch(s=>{throw new U(String(s),"ERR_INVALID_INPUT")});try{return _t.verify(e,n.digest,t)}catch(s){throw new U(String(s),"ERR_INVALID_INPUT")}}function cl(t){return _t.ProjectivePoint.fromHex(t).toRawBytes(!0)}function ul(t){try{_t.getPublicKey(t,!0)}catch(e){throw new U(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Ea(t){try{_t.ProjectivePoint.fromHex(t)}catch(e){throw new U(String(e),"ERR_INVALID_PUBLIC_KEY")}}function fl(t){try{return _t.getPublicKey(t,!0)}catch(e){throw new U(String(e),"ERR_INVALID_PRIVATE_KEY")}}var es=class{_key;constructor(e){Ea(e),this._key=e}verify(e,r){return al(this._key,r,e)}marshal(){return cl(this._key)}get bytes(){return Mt.encode({Type:xe.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ke(this.bytes,e.bytes)}async hash(){let e=Pe.digest(this.bytes),r;return ht(e)?{bytes:r}=await e:r=e.bytes,r}},ts=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??fl(e),ul(this._key),Ea(this._publicKey)}sign(e){return ol(this._key,e)}get public(){return new es(this._publicKey)}marshal(){return this._key}get bytes(){return Nt.encode({Type:xe.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ke(this.bytes,e.bytes)}hash(){let e=Pe.digest(this.bytes);return ht(e)?e.then(({bytes:r})=>r):e.bytes}async id(){let e=await this.public.hash();return le(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return mn(this.bytes,e);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Zm(t){return new ts(t)}function Qm(t){return new es(t)}async function Xm(){let t=il();return new ts(t)}var yr={rsa:ba,ed25519:pa,secp256k1:_a};function Ia(t){let e=Object.keys(yr).join(" / ");return new U(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function e1(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return yr[t];throw Ia(t)}function Ba(t){let e=Mt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case xe.RSA:return yr.rsa.unmarshalRsaPublicKey(r);case xe.Ed25519:return yr.ed25519.unmarshalEd25519PublicKey(r);case xe.Secp256k1:return yr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Ia(e.Type??"unknown")}}function hl(t,e){return e=(e??"rsa").toLowerCase(),e1(e),t.bytes}async function ll(t){let e=Nt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case xe.RSA:return yr.rsa.unmarshalRsaPrivateKey(r);case xe.Ed25519:return yr.ed25519.unmarshalEd25519PrivateKey(r);case xe.Secp256k1:return yr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Ia(e.Type??"RSA")}}var r1=_e(Bo(),1),n1=_e(Be(),1);var pl=Te("libp2p-pubsub:");async function dl(t,e,r,n){switch(t.type){case nr.Signing:{let s={from:t.author.toBytes(),data:n,seqno:pr(8),topic:e,signature:void 0,key:void 0},i=et([pl,rn.Message.encode(s).finish()]);s.signature=await t.privateKey.sign(i),s.key=t.key;let o={type:"signed",from:t.author,data:r,sequenceNumber:BigInt(`0x${le(s.seqno,"base16")}`),topic:e,signature:s.signature,key:s.key};return{raw:s,msg:o}}case nr.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:e,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:e}};default:throw new Error("Unreachable")}}async function gl(t,e){switch(t){case Vr:return e.signature!=null?{valid:!1,error:Ge.SignaturePresent}:e.seqno!=null?{valid:!1,error:Ge.SeqnoPresent}:e.key!=null?{valid:!1,error:Ge.FromPresent}:{valid:!0,message:{type:"unsigned",topic:e.topic,data:e.data??new Uint8Array(0)}};case br:{if(e.seqno==null)return{valid:!1,error:Ge.InvalidSeqno};if(e.seqno.length!==8)return{valid:!1,error:Ge.InvalidSeqno};if(e.signature==null)return{valid:!1,error:Ge.InvalidSignature};if(e.from==null)return{valid:!1,error:Ge.InvalidPeerId};let r;try{r=Yr(e.from)}catch{return{valid:!1,error:Ge.InvalidPeerId}}let n;if(e.key!=null){if(n=Ba(e.key),r.publicKey!==void 0&&!Ke(n.bytes,r.publicKey))return{valid:!1,error:Ge.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:Ge.InvalidPeerId};n=Ba(r.publicKey)}let s={from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0},i=et([pl,rn.Message.encode(s).finish()]);return await n.verify(i,e.signature)?{valid:!0,message:{type:"signed",from:r,data:e.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${le(e.seqno,"base16")}`),topic:e.topic,signature:e.signature,key:e.key??hl(n)}}:{valid:!1,error:Ge.InvalidSignature}}default:throw new Error("Unreachable")}}function Lt(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),s=t[r];t[r]=t[n],t[n]=s}return t}function yl(t){return le(t,"base64")}async function Ta(t,e){switch(t){case br:{if(e==null)throw Error("Must provide PeerId");if(e.privateKey==null)throw Error("Cannot sign message, no private key present");if(e.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await ll(e.privateKey);return{type:nr.Signing,author:e,key:e.publicKey,privateKey:r}}case Vr:return{type:nr.Anonymous};default:throw new Error(`Unknown signature policy "${t}"`)}}var ml=(t,e)=>{let r=Te(e.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(t.length+r.length);return n.set(t,0),n.set(r,t.length),n};function bl(t){if(t.type!=="signed")throw new Error("expected signed message type");if(t.sequenceNumber==null)throw Error("missing seqno field");return ml(t.from.toBytes(),t.sequenceNumber)}async function xl(t){return Pe.encode(t.data)}var di=class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){let r=this.index,n=e();return n===void 0&&(this.index=r),n}parseWith(e){let r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{let r=this.readChar();if(r===e)return r})}readSeparator(e,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(e)===void 0))return n()})}readNumber(e,r,n,s){return this.readAtomically(()=>{let i=0,o=0,a=this.peekChar();if(a===void 0)return;let f=a==="0",u=2**(8*s)-1;for(;;){let c=this.readAtomically(()=>{let h=this.readChar();if(h===void 0)return;let l=Number.parseInt(h,e);if(!Number.isNaN(l))return l});if(c===void 0)break;if(i*=e,i+=c,i>u||(o+=1,r!==void 0&&o>r))return}if(o!==0)return!n&&f&&o>1?void 0:i})}readIPv4Addr(){return this.readAtomically(()=>{let e=new Uint8Array(4);for(let r=0;r<e.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;e[r]=n}return e})}readIPv6Addr(){let e=r=>{for(let n=0;n<r.length/2;n++){let s=n*2;if(n<r.length-3){let o=this.readSeparator(":",n,()=>this.readIPv4Addr());if(o!==void 0)return r[s]=o[0],r[s+1]=o[1],r[s+2]=o[2],r[s+3]=o[3],[s+4,!0]}let i=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(i===void 0)return[s,!1];r[s]=i>>8,r[s+1]=i&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,s]=e(r);if(n===16)return r;if(s||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let i=new Uint8Array(14),o=16-(n+2),[a]=e(i.subarray(0,o));return r.set(i.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var s1=45;var vl=new di;function gi(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>s1))return vl.new(t).parseWith(()=>vl.readIPAddr())}var b8=parseInt("0xFFFF",16),x8=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function Aa(t){return!!gi(t)}var El=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let s=[];for(let i=0;i<r;i++)s.push(t[e+i]);return s.join(".")}if(r===16){let s=[];for(let i=0;i<r;i+=2)s.push(n.getUint16(e+i).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ca={},Pa={},l1=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];l1.forEach(t=>{let e=p1(...t);Pa[e.code]=e,Ca[e.name]=e});function p1(t,e,r,n,s){return{code:t,size:e,name:r,resolvable:!!n,path:!!s}}function rs(t){if(typeof t=="number"){if(Pa[t]!=null)return Pa[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(Ca[t]!=null)return Ca[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var i_=rs("ip4"),o_=rs("ip6"),a_=rs("ipcidr");function Bl(t,e){switch(rs(t).code){case 4:case 41:return d1(e);case 42:return _l(e);case 6:case 273:case 33:case 132:return Tl(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return _l(e);case 421:return y1(e);case 444:return Il(e);case 445:return Il(e);case 466:return g1(e);default:return le(e,"base16")}}var Ra=Object.values(Jt).map(t=>t.decoder),c_=function(){let t=Ra[0].or(Ra[1]);return Ra.slice(2).forEach(e=>t=t.or(e)),t}();function d1(t){let e=El(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!Aa(e))throw new Error("invalid ip address");return e}function Tl(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function _l(t){let e=Zr(t);if(t=t.slice(pt(e)),t.length!==e)throw new Error("inconsistent lengths");return le(t)}function g1(t){let e=Zr(t),r=t.slice(pt(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+le(r,"base64url")}function y1(t){let e=Zr(t),r=t.slice(pt(e));if(r.length!==e)throw new Error("inconsistent lengths");return le(r,"base58btc")}function Il(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=le(e,"base32"),s=Tl(r);return`${n}:${s}`}var yi;(function(t){t[t.ip4=4]="ip4",t[t.ip6=41]="ip6"})(yi||(yi={}));function Al(t){for(let e of t.tuples())switch(e[0]){case yi.ip4:case yi.ip6:return Bl(e[0],e[1]);default:break}return null}var wn=class{entries=new Map;validityMs;constructor(e){this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,r){return this.entries.has(e)?!0:(this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){let e=Date.now();for(let[r,n]of this.entries.entries())if(n.validUntilMs<e)this.entries.delete(r);else break}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r!=null&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};var W1=ls,at;(function(t){t[t.started=0]="started",t[t.stopped=1]="stopped"})(at||(at={}));var mi=class extends ss{globalSignaturePolicy;multicodecs=[ls,Zi];publishConfig;dataTransform;peers=new Set;streamsInbound=new Map;streamsOutbound=new Map;outboundInflightQueue=It({objectMode:!0});direct=new Set;floodsubPeers=new Set;seenCache;acceptFromWhitelist=new Map;topics=new Map;subscriptions=new Set;mesh=new Map;fanout=new Map;fanoutLastpub=new Map;gossip=new Map;control=new Map;peerhave=new Map;iasked=new Map;backoff=new Map;outbound=new Map;msgIdFn;fastMsgIdFn;msgIdToStrFn;fastMsgIdCache;publishedMessageIds;mcache;score;topicValidators=new Map;log;heartbeatTicks=0;gossipTracer;components;directPeerInitial=null;static multicodec=ls;opts;decodeRpcLimits;metrics;status={code:at.stopped};maxInboundStreams;maxOutboundStreams;allowedTopics;heartbeatTimer=null;constructor(e,r={}){super();let n={fallbackToFloodsub:!0,floodPublish:!0,batchPublish:!1,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,unsubcribeBackoff:1e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...r,scoreParams:Tu(r.scoreParams),scoreThresholds:Cu(r.scoreThresholds)};if(this.components=e,this.decodeRpcLimits=n.decodeRpcLimits??xu,this.globalSignaturePolicy=n.globalSignaturePolicy??br,n.fallbackToFloodsub&&this.multicodecs.push(Yi),this.log=e.logger.forComponent(n.debugName??"libp2p:gossipsub"),this.opts=n,this.direct=new Set(n.directPeers.map(s=>s.id.toString())),this.seenCache=new wn({validityMs:n.seenTTL}),this.publishedMessageIds=new wn({validityMs:n.seenTTL}),r.msgIdFn!=null)this.msgIdFn=r.msgIdFn;else switch(this.globalSignaturePolicy){case br:this.msgIdFn=bl;break;case Vr:this.msgIdFn=xl;break;default:throw new Error(`Invalid globalSignaturePolicy: ${this.globalSignaturePolicy}`)}if(r.fastMsgIdFn!=null&&(this.fastMsgIdFn=r.fastMsgIdFn,this.fastMsgIdCache=new wn({validityMs:n.seenTTL})),this.msgIdToStrFn=r.msgIdToStrFn??yl,this.mcache=r.messageCache??new ms(n.mcacheGossip,n.mcacheLength,this.msgIdToStrFn),r.dataTransform!=null&&(this.dataTransform=r.dataTransform),r.metricsRegister!=null){if(r.metricsTopicStrToLabel==null)throw Error("Must set metricsTopicStrToLabel with metrics");let s=Math.max(...Object.values(n.scoreParams.topics).map(o=>o.meshMessageDeliveriesWindow),1e3),i=Bu(r.metricsRegister,r.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:n.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:s/1e3});i.mcacheSize.addCollect(()=>{this.onScrapeMetrics(i)});for(let o of this.multicodecs)i.protocolsEnabled.set({protocol:o},1);this.metrics=i}else this.metrics=null;this.gossipTracer=new Is(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new ws(this.opts.scoreParams,this.metrics,this.components.logger,{scoreCacheValidityMs:n.heartbeatInterval}),this.maxInboundStreams=r.maxInboundStreams,this.maxOutboundStreams=r.maxOutboundStreams,this.allowedTopics=n.allowedTopics!=null?new Set(n.allowedTopics):null}getPeers(){return[...this.peers.keys()].map(e=>Sr(e))}isStarted(){return this.status.code===at.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await Ta(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=It({objectMode:!0}),Ir(this.outboundInflightQueue,async i=>{for await(let{peerId:o,connection:a}of i)await this.createOutboundStream(o,a)}).catch(i=>{this.log.error("outbound inflight queue error",i)}),await Promise.all(this.opts.directPeers.map(async i=>{await this.components.peerStore.merge(i.id,{multiaddrs:i.addrs})}));let e=this.components.registrar;await Promise.all(this.multicodecs.map(async i=>e.handle(i,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));let r={onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)},n=await Promise.all(this.multicodecs.map(async i=>e.register(i,r))),s=setTimeout(this.runHeartbeat,100);this.status={code:at.started,registrarTopologyIds:n,heartbeatTimeout:s,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async i=>this.connect(i)))}).catch(i=>{this.log(i)})},1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==at.started)return;let{registrarTopologyIds:e}=this.status;this.status={code:at.stopped};let r=this.components.registrar;await Promise.all(this.multicodecs.map(async s=>r.unhandle(s))),e.forEach(s=>{r.unregister(s)}),this.outboundInflightQueue.end();let n=[];for(let s of this.streamsOutbound.values())n.push(s.close());this.streamsOutbound.clear();for(let s of this.streamsInbound.values())n.push(s.close());this.streamsInbound.clear(),await Promise.all(n),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer!=null&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache!=null&&this.fastMsgIdCache.clear(),this.directPeerInitial!=null&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:r}){if(!this.isStarted())return;let n=r.remotePeer;this.addPeer(n,r.direction,r.remoteAddr),this.createInboundStream(n,e),this.outboundInflightQueue.push({peerId:n,connection:r})}onPeerConnected(e,r){this.metrics?.newConnectionCount.inc({status:r.status}),!(!this.isStarted()||r.status!=="open")&&(this.addPeer(e,r.direction,r.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:r}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(this.peers.has(n)&&!this.streamsOutbound.has(n))try{let s=new Es(await r.newStream(this.multicodecs),o=>{this.log.error("outbound pipe error",o)},{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(n,s);let i=s.protocol;i===Yi&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:i},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(s){this.log.error("createOutboundStream error",s)}}createInboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!this.peers.has(n))return;let s=this.streamsInbound.get(n);s!==void 0&&(this.log("replacing existing inbound steam %s",n),s.close().catch(o=>{this.log.error(o)})),this.log("create inbound stream %s",n);let i=new _s(r,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(n,i),this.pipePeerReadStream(e,i.source).catch(o=>{this.log(o)})}addPeer(e,r,n){let s=e.toString();if(!this.peers.has(s)){this.log("new peer %p",e),this.peers.add(s),this.score.addPeer(s);let i=Al(n);i!==null?this.score.addIP(s,i):this.log("Added peer has no IP in current address %s %s",s,n.toString()),this.outbound.has(s)||this.outbound.set(s,r==="outbound")}}removePeer(e){let r=e.toString();if(!this.peers.has(r))return;this.log("delete peer %p",e),this.peers.delete(r);let n=this.streamsOutbound.get(r),s=this.streamsInbound.get(r);n!=null&&this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),n?.close().catch(i=>{this.log.error(i)}),s?.close().catch(i=>{this.log.error(i)}),this.streamsOutbound.delete(r),this.streamsInbound.delete(r);for(let i of this.topics.values())i.delete(r);for(let[i,o]of this.mesh)o.delete(r)&&this.metrics?.onRemoveFromMesh(i,mt.Dc,1);for(let i of this.fanout.values())i.delete(r);this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r)}get started(){return this.status.code===at.started}getMeshPeers(e){let r=this.mesh.get(e);return r!=null?Array.from(r):[]}getSubscribers(e){let r=this.topics.get(e);return(r!=null?Array.from(r):[]).map(n=>Sr(n))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,r){try{await Ir(r,async n=>{for await(let s of n)try{let i=s.subarray(),o=vu(i,this.decodeRpcLimits);if(this.metrics?.onRpcRecv(o,i.length),this.opts.awaitRpcHandler)try{await this.handleReceivedRpc(e,o)}catch(a){this.metrics?.onRpcRecvError(),this.log(a)}else this.handleReceivedRpc(e,o).catch(a=>{this.metrics?.onRpcRecvError(),this.log(a)})}catch(i){this.metrics?.onRpcDataError(),this.log(i)}})}catch(n){this.metrics?.onPeerReadStreamError(),this.handlePeerReadStreamError(n,e)}}handlePeerReadStreamError(e,r){this.log.error(e),this.onPeerDisconnected(r)}async handleReceivedRpc(e,r){if(!this.acceptFrom(e.toString())){this.log("received message from unacceptable peer %p",e),this.metrics?.rpcRecvNotAccepted.inc();return}let n=r.subscriptions!=null?r.subscriptions.length:0,s=r.messages!=null?r.messages.length:0,i=0,o=0,a=0,f=0;if(r.control!=null&&(r.control.ihave!=null&&(i=r.control.ihave.length),r.control.iwant!=null&&(o=r.control.iwant.length),r.control.graft!=null&&(a=r.control.graft.length),r.control.prune!=null&&(f=r.control.prune.length)),this.log(`rpc.from ${e.toString()} subscriptions ${n} messages ${s} ihave ${i} iwant ${o} graft ${a} prune ${f}`),r.subscriptions!=null&&r.subscriptions.length>0){let u=[];r.subscriptions.forEach(c=>{let h=c.topic,l=c.subscribe===!0;if(h!=null){if(this.allowedTopics!=null&&!this.allowedTopics.has(h))return;this.handleReceivedSubscription(e,h,l),u.push({topic:h,subscribe:l})}}),this.safeDispatchEvent("subscription-change",{detail:{peerId:e,subscriptions:u}})}if(r.messages!=null)for(let u of r.messages){if(this.allowedTopics!=null&&!this.allowedTopics.has(u.topic))continue;let c=this.handleReceivedMessage(e,u).catch(h=>{this.metrics?.onMsgRecvError(u.topic),this.log(h)});this.opts.awaitRpcMessageHandler&&await c}r.control!=null&&await this.handleControlMessage(e.toString(),r.control)}handleReceivedSubscription(e,r,n){this.log("subscription update from %p topic %s",e,r);let s=this.topics.get(r);s==null&&(s=new Set,this.topics.set(r,s)),n?s.add(e.toString()):s.delete(e.toString())}async handleReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let n=await this.validateReceivedMessage(e,r);this.metrics?.onPrevalidationResult(r.topic,n.code);let s=n.code;switch(s){case We.duplicate:this.score.duplicateMessage(e.toString(),n.msgIdStr,r.topic),this.gossipTracer.deliverMessage(n.msgIdStr,!0),this.mcache.observeDuplicate(n.msgIdStr,e.toString());return;case We.invalid:if(n.msgIdStr!=null){let i=n.msgIdStr;this.score.rejectMessage(e.toString(),i,r.topic,n.reason),this.gossipTracer.rejectMessage(i,n.reason)}else this.score.rejectInvalidMessage(e.toString(),r.topic);this.metrics?.onMsgRecvInvalid(r.topic,n);return;case We.valid:this.score.validateMessage(n.messageId.msgIdStr),this.gossipTracer.deliverMessage(n.messageId.msgIdStr),this.mcache.put(n.messageId,r,!this.opts.asyncValidation),this.subscriptions.has(r.topic)&&(!this.components.peerId.equals(e)||this.opts.emitSelf)&&(super.dispatchEvent(new xr("gossipsub:message",{detail:{propagationSource:e,msgId:n.messageId.msgIdStr,msg:n.msg}})),super.dispatchEvent(new xr("message",{detail:n.msg}))),this.opts.asyncValidation||this.forwardMessage(n.messageId.msgIdStr,r,e.toString());break;default:throw new Error(`Invalid validation result: ${s}`)}}async validateReceivedMessage(e,r){let n=this.fastMsgIdFn?.(r),s=n!==void 0?this.fastMsgIdCache?.get(n):void 0;if(s!=null)return{code:We.duplicate,msgIdStr:s};let i=await gl(this.globalSignaturePolicy,r);if(!i.valid)return{code:We.invalid,reason:Ye.Error,error:i.error};let o=i.message;try{this.dataTransform!=null&&(o.data=this.dataTransform.inboundTransform(r.topic,o.data))}catch(h){return this.log("Invalid message, transform failed",h),{code:We.invalid,reason:Ye.Error,error:Ge.TransformFailed}}let a=await this.msgIdFn(o),f=this.msgIdToStrFn(a),u={msgId:a,msgIdStr:f};if(n!==void 0&&this.fastMsgIdCache!=null&&this.fastMsgIdCache.put(n,f)&&this.metrics?.fastMsgIdCacheCollision.inc(),this.seenCache.has(f))return{code:We.duplicate,msgIdStr:f};this.seenCache.put(f);let c=this.topicValidators.get(r.topic);if(c!=null){let h;try{h=await c(e,o)}catch(l){let g=l.code;g===wc&&(h=$e.Ignore),g===vc?h=$e.Reject:h=$e.Ignore}if(h!==$e.Accept)return{code:We.invalid,reason:ho(h),msgIdStr:f}}return{code:We.valid,messageId:u,msg:o}}getScore(e){return this.score.score(e)}sendSubscriptions(e,r,n){this.sendRpc(e,{subscriptions:r.map(s=>({topic:s,subscribe:n}))})}async handleControlMessage(e,r){if(r===void 0)return;let n=r.ihave!=null?this.handleIHave(e,r.ihave):[],s=r.iwant!=null?this.handleIWant(e,r.iwant):[],i=r.graft!=null?await this.handleGraft(e,r.graft):[];if(r.prune!=null&&await this.handlePrune(e,r.prune),n.length===0&&s.length===0&&i.length===0)return;let o=this.sendRpc(e,{messages:s,control:{iwant:n,prune:i}}),a=n[0]?.messageIDs;a!=null&&(o?this.gossipTracer.addPromise(e,a):this.metrics?.iwantPromiseUntracked.inc(1))}acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(e);if(n!=null&&n.messagesAccepted<128&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let s=this.score.score(e);return s>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+1e3}):this.acceptFromWhitelist.delete(e),s>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,r){if(r.length===0)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:on.LowScore}),[];let s=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,s),s>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:on.MaxIhave}),[];let i=this.iasked.get(e)??0;if(i>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:on.MaxIasked}),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:c})=>{if(u==null||c==null||!this.mesh.has(u))return;let h=0;c.forEach(l=>{let g=this.msgIdToStrFn(l);this.seenCache.has(g)||(o.set(g,l),h++)}),this.metrics?.onIhaveRcv(u,c.length,h)}),o.size===0)return[];let a=o.size;a+i>5e3&&(a=5e3-i),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let f=Array.from(o.values());return Lt(f),f=f.slice(0,a),this.iasked.set(e,i+a),[{messageIDs:f}]}handleIWant(e,r){if(r.length===0)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let s=new Map,i=new Map,o=0;return r.forEach(({messageIDs:a})=>{a?.forEach(f=>{let u=this.msgIdToStrFn(f),c=this.mcache.getWithIWantCount(u,e);if(c==null){o++;return}if(i.set(c.msg.topic,1+(i.get(c.msg.topic)??0)),c.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,f);return}s.set(u,c.msg)})}),this.metrics?.onIwantRcv(i,o),s.size===0?(this.log("IWANT: Could not provide any wanted messages to %s",e),[]):(this.log("IWANT: Sending %d messages to %s",s.size,e),Array.from(s.values()))}async handleGraft(e,r){let n=[],s=this.score.score(e),i=Date.now(),o=this.opts.doPX;if(r.forEach(({topicID:f})=>{if(f==null)return;let u=this.mesh.get(f);if(u==null){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(f),o=!1;return}let c=this.backoff.get(f)?.get(e);if(typeof c=="number"&&i<c){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,sn.GraftBackoff),o=!1;let h=c+this.opts.graftFloodThreshold-this.opts.pruneBackoff;i<h&&this.score.addPenalty(e,1,sn.GraftBackoff),this.addBackoff(e,f),n.push(f);return}if(s<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,s,f),n.push(f),o=!1,this.addBackoff(e,f);return}if(u.size>=this.opts.Dhi&&!(this.outbound.get(e)??!1)){n.push(f),this.addBackoff(e,f);return}this.log("GRAFT: Add mesh link from %s in %s",e,f),this.score.graft(e,f),u.add(e),this.metrics?.onAddToMesh(f,Ze.Subscribed,1)}),n.length===0)return[];let a=!1;return Promise.all(n.map(async f=>this.makePrune(e,f,o,a)))}async handlePrune(e,r){let n=this.score.score(e);for(let{topicID:s,backoff:i,peers:o}of r){if(s==null)continue;let a=this.mesh.get(s);if(a==null)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,s),this.score.prune(e,s),a.has(e)&&(a.delete(e),this.metrics?.onRemoveFromMesh(s,mt.Prune,1)),typeof i=="number"&&i>0?this.doAddBackoff(e,s,i*1e3):this.addBackoff(e,s),o!=null&&o.length>0){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,s);continue}await this.pxConnect(o)}}}addBackoff(e,r){this.doAddBackoff(e,r,this.opts.pruneBackoff)}doAddBackoff(e,r,n){let s=this.backoff.get(r);s==null&&(s=new Map,this.backoff.set(r,s));let i=Date.now()+n;(s.get(e)??0)<i&&s.set(e,i)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e,sn.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let e=Date.now();this.backoff.forEach((r,n)=>{r.forEach((s,i)=>{s+1*this.opts.heartbeatInterval<e&&r.delete(i)}),r.size===0&&this.backoff.delete(n)})}async directConnect(){let e=[];this.direct.forEach(r=>{this.streamsOutbound.has(r)||e.push(r)}),await Promise.all(e.map(async r=>this.connect(r)))}async pxConnect(e){e.length>this.opts.prunePeers&&(Lt(e),e=e.slice(0,this.opts.prunePeers));let r=[];await Promise.all(e.map(async n=>{if(n.peerID==null)return;let s=Yr(n.peerID),i=s.toString();if(!this.peers.has(i)){if(n.signedPeerRecord==null){r.push(i);return}try{if(!await this.components.peerStore.consumePeerRecord(n.signedPeerRecord,s)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(i)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),r.length!==0&&await Promise.all(r.map(async n=>this.connect(n)))}async connect(e){this.log("Initiating connection with %s",e);let r=Sr(e),n=await this.components.connectionManager.openConnection(r);for(let s of this.multicodecs)for(let i of this.components.registrar.getTopologies(s))i.onConnect?.(r,n)}subscribe(e){if(this.status.code!==at.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==at.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,r),r)for(let n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e)}join(e){if(this.status.code!==at.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let r=new Set,n=this.backoff.get(e),s=this.fanout.get(e);if(s!=null&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),s.forEach(i=>{!this.direct.has(i)&&this.score.score(i)>=0&&(n==null||!n.has(i))&&r.add(i)}),this.metrics?.onAddToMesh(e,Ze.Fanout,r.size)),r.size<this.opts.D){let i=r.size;this.getRandomGossipPeers(e,this.opts.D,a=>!r.has(a)&&!this.direct.has(a)&&this.score.score(a)>=0&&(n==null||!n.has(a))).forEach(a=>{r.add(a)}),this.metrics?.onAddToMesh(e,Ze.Random,r.size-i)}this.mesh.set(e,r),r.forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this.sendGraft(i,e)})}leave(e){if(this.status.code!==at.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let r=this.mesh.get(e);r!=null&&(Promise.all(Array.from(r).map(async n=>{this.log("LEAVE: Remove mesh link to %s in %s",n,e),await this.sendPrune(n,e)})).catch(n=>{this.log("Error sending prunes to mesh peers",n)}),this.mesh.delete(e))}selectPeersToForward(e,r,n){let s=new Set,i=this.topics.get(e);i!=null&&(this.direct.forEach(a=>{i.has(a)&&r!==a&&!(n?.has(a)??!1)&&s.add(a)}),this.floodsubPeers.forEach(a=>{i.has(a)&&r!==a&&!(n?.has(a)??!1)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&s.add(a)}));let o=this.mesh.get(e);return o!=null&&o.size>0&&o.forEach(a=>{r!==a&&!(n?.has(a)??!1)&&s.add(a)}),s}selectPeersToPublish(e){let r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},s=this.topics.get(e);if(s!=null)if(this.opts.floodPublish)s.forEach(i=>{this.direct.has(i)?(r.add(i),n.direct++):this.score.score(i)>=this.opts.scoreThresholds.publishThreshold&&(r.add(i),n.floodsub++)});else{this.direct.forEach(o=>{s.has(o)&&(r.add(o),n.direct++)}),this.floodsubPeers.forEach(o=>{s.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(r.add(o),n.floodsub++)});let i=this.mesh.get(e);if(i!=null&&i.size>0)i.forEach(o=>{r.add(o),n.mesh++});else{let o=this.fanout.get(e);if(o!=null&&o.size>0)o.forEach(a=>{r.add(a),n.fanout++});else{let a=this.getRandomGossipPeers(e,this.opts.D,f=>this.score.score(f)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(f=>{r.add(f),n.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:r,tosendCount:n}}forwardMessage(e,r,n,s){n!=null&&this.score.deliverMessage(n,e,r.topic);let i=this.selectPeersToForward(r.topic,n,s);i.forEach(o=>{this.sendRpc(o,{messages:[r]})}),this.metrics?.onForwardMsg(r.topic,i.size)}async publish(e,r,n){let s=Date.now(),i=this.dataTransform!=null?this.dataTransform.outboundTransform(e,r):r;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let{raw:o,msg:a}=await dl(this.publishConfig,e,r,i),f=await this.msgIdFn(a),u=this.msgIdToStrFn(f),c=n?.ignoreDuplicatePublishError??this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(u)){if(c)return this.metrics?.onPublishDuplicateMsg(e),{recipients:[]};throw Error("PublishError.Duplicate")}let{tosend:h,tosendCount:l}=this.selectPeersToPublish(e),g=this.opts.emitSelf&&this.subscriptions.has(e),p=n?.allowPublishToZeroPeers??this.opts.allowPublishToZeroPeers;if(h.size===0&&!p&&!g)throw Error("PublishError.InsufficientPeers");this.seenCache.put(u),this.mcache.put({msgId:f,msgIdStr:u},o,!0),this.publishedMessageIds.put(u);let d=n?.batchPublish??this.opts.batchPublish,y={messages:[o]};if(d)this.sendRpcInBatch(h,y);else for(let E of h)this.sendRpc(E,y)||h.delete(E);let m=Date.now()-s;return this.metrics?.onPublishMsg(e,l,h.size,o.data!=null?o.data.length:0,m),g&&(h.add(this.components.peerId.toString()),super.dispatchEvent(new xr("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:u,msg:a}})),super.dispatchEvent(new xr("message",{detail:a}))),{recipients:Array.from(h.values()).map(E=>Sr(E))}}sendRpcInBatch(e,r){let n=rn.encode(r).finish(),s=Xr.single(n);for(let i of e){let o=this.streamsOutbound.get(i);if(o==null){this.log(`Cannot send RPC to ${i} as there is no open stream to it available`),e.delete(i);continue}try{o.pushPrefixed(s)}catch(a){e.delete(i),this.log.error(`Cannot send rpc to ${i}`,a)}this.metrics?.onRpcSent(r,n.length)}}reportMessageValidationResult(e,r,n){let s;if(n===$e.Accept){if(s=this.mcache.validate(e),s!=null){let{message:o,originatingPeers:a}=s;this.score.deliverMessage(r,e,o.topic),this.forwardMessage(e,s.message,r,a)}}else if(s=this.mcache.remove(e),s!=null){let o=ho(n),{message:a,originatingPeers:f}=s;this.score.rejectMessage(r,e,a.topic,o);for(let u of f)this.score.rejectMessage(u,e,a.topic,o)}let i=this.score.messageFirstSeenTimestampMs(e);this.metrics?.onReportValidation(s,n,i)}sendGraft(e,r){let n=[{topicID:r}];this.sendRpc(e,{control:{graft:n}})}async sendPrune(e,r){let s=[await this.makePrune(e,r,this.opts.doPX,!0)];this.sendRpc(e,{control:{prune:s}})}sendRpc(e,r){let n=this.streamsOutbound.get(e);if(n==null)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;let s=this.control.get(e);s!=null&&(this.piggybackControl(e,r,s),this.control.delete(e));let i=this.gossip.get(e);i!=null&&(this.piggybackGossip(e,r,i),this.gossip.delete(e));let o=rn.encode(r).finish();try{n.push(o)}catch(a){return this.log.error(`Cannot send rpc to ${e}`,a),s!=null&&this.control.set(e,s),i!=null&&this.gossip.set(e,i),!1}return this.metrics?.onRpcSent(r,o.length),!0}piggybackControl(e,r,n){if(n.graft!=null){r.control==null&&(r.control={}),r.control.graft==null&&(r.control.graft=[]);for(let s of n.graft)s.topicID!=null&&(this.mesh.get(s.topicID)?.has(e)??!1)&&r.control.graft.push(s)}if(n.prune!=null){r.control==null&&(r.control={}),r.control.prune==null&&(r.control.prune=[]);for(let s of n.prune)s.topicID!=null&&!(this.mesh.get(s.topicID)?.has(e)??!1)&&r.control.prune.push(s)}}piggybackGossip(e,r,n){r.control==null&&(r.control={}),r.control.ihave=n}async sendGraftPrune(e,r,n){let s=this.opts.doPX,i=!1;for(let[o,a]of e){let f=a.map(h=>({topicID:h})),u=[],c=r.get(o);c!=null&&(u=await Promise.all(c.map(async h=>this.makePrune(o,h,s&&!(n.get(o)??!1),i))),r.delete(o)),this.sendRpc(o,{control:{graft:f,prune:u}})}for(let[o,a]of r){let f=await Promise.all(a.map(async u=>this.makePrune(o,u,s&&!(n.get(o)??!1),i)));this.sendRpc(o,{control:{prune:f}})}}emitGossip(e){let r=this.mcache.getGossipIDs(new Set(e.keys()));for(let[n,s]of e)this.doEmitGossip(n,s,r.get(n)??[])}doEmitGossip(e,r,n){if(n.length===0||(Lt(n),n.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),r.size===0))return;let s=this.opts.Dlazy,i=.25*r.size,o=r;i>s&&(s=i),s>o.size?s=o.size:o=Lt(Array.from(o)).slice(0,s),o.forEach(a=>{let f=n;n.length>5e3&&(f=Lt(f.slice()).slice(0,5e3)),this.pushGossip(a,{topicID:e,messageIDs:f})})}flush(){for(let[e,r]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,{control:{ihave:r}});for(let[e,r]of this.control.entries())this.control.delete(e),this.sendRpc(e,{control:{graft:r.graft,prune:r.prune}})}pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)??[];this.gossip.set(e,n.concat(r))}async makePrune(e,r,n,s){if(this.score.prune(e,r),this.streamsOutbound.get(e)?.protocol===Zi)return{topicID:r,peers:[]};let i=s?this.opts.unsubcribeBackoff:this.opts.pruneBackoff,o=i/1e3;if(this.doAddBackoff(e,r,i),!n)return{topicID:r,peers:[],backoff:o};let a=this.getRandomGossipPeers(r,this.opts.prunePeers,u=>u!==e&&this.score.score(u)>=0),f=await Promise.all(Array.from(a).map(async u=>{let c=Sr(u),h;try{h=await this.components.peerStore.get(c)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}return{peerID:c.toBytes(),signedPeerRecord:h?.peerRecordEnvelope}}));return{topicID:r,peers:f,backoff:o}}runHeartbeat=()=>{let e=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(r=>{this.log("Error running heartbeat",r)}).finally(()=>{if(e?.(),this.status.code===at.started){clearTimeout(this.status.heartbeatTimeout);let r=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;r<this.opts.heartbeatInterval*.25&&(r+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,r)}})};async heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:s,Dout:i,fanoutTTL:o}=this.opts;this.heartbeatTicks++;let a=new Map,f=p=>{let d=a.get(p);return d===void 0&&(d=this.score.score(p),a.set(p,d)),d},u=new Map,c=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let l=new Map;this.mesh.forEach((p,d)=>{let y=this.topics.get(d),m=new Set,E=new Set;if(l.set(d,E),y!=null){let b=Lt(Array.from(y)),S=this.backoff.get(d);for(let I of b){let C=this.streamsOutbound.get(I);if(C!=null&&this.multicodecs.includes(C.protocol)&&!p.has(I)&&!this.direct.has(I)){let F=f(I);(S==null||!S.has(I))&&F>=0&&m.add(I),F>=this.opts.scoreThresholds.gossipThreshold&&E.add(I)}}}let v=(b,S)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",b,d),this.addBackoff(b,d),p.delete(b),f(b)>=this.opts.scoreThresholds.gossipThreshold&&E.add(b),this.metrics?.onRemoveFromMesh(d,S,1);let I=c.get(b);I==null?c.set(b,[d]):I.push(d)},T=(b,S)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",b,d),this.score.graft(b,d),p.add(b),E.delete(b),this.metrics?.onAddToMesh(d,S,1);let I=u.get(b);I==null?u.set(b,[d]):I.push(d)};if(p.forEach(b=>{let S=f(b);S<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",b,S,d),v(b,mt.BadScore),h.set(b,!0))}),p.size<r){let b=e-p.size;Pu(m,b).forEach(I=>{T(I,Ze.NotEnough)})}if(p.size>n){let b=Array.from(p);b.sort((I,C)=>f(C)-f(I)),b=b.slice(0,s).concat(Lt(b.slice(s)));let S=0;if(b.slice(0,e).forEach(I=>{(this.outbound.get(I)??!1)&&S++}),S<i){let I=F=>{let K=b[F];for(let q=F;q>0;q--)b[q]=b[q-1];b[0]=K};if(S>0){let F=S;for(let K=1;K<e&&F>0;K++)(this.outbound.get(b[K])??!1)&&(I(K),F--)}let C=e-S;for(let F=e;F<b.length&&C>0;F++)(this.outbound.get(b[F])??!1)&&(I(F),C--)}b.slice(e).forEach(I=>{v(I,mt.Excess)})}if(p.size>=r){let b=0;if(p.forEach(S=>{(this.outbound.get(S)??!1)&&b++}),b<i){let S=i-b;xs(m,S,C=>this.outbound.get(C)===!0).forEach(C=>{T(C,Ze.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&p.size>1){let b=Array.from(p).sort((C,F)=>f(C)-f(F)),S=Math.floor(p.size/2),I=f(b[S]);if(I<this.opts.scoreThresholds.opportunisticGraftThreshold){let C=this.opts.opportunisticGraftPeers,F=xs(m,C,K=>f(K)>I);for(let K of F)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",K,d),T(K,Ze.Opportunistic)}}});let g=Date.now();this.fanoutLastpub.forEach((p,d)=>{p+o<g&&(this.fanout.delete(d),this.fanoutLastpub.delete(d))}),this.fanout.forEach((p,d)=>{let y=this.topics.get(d);p.forEach(T=>{(!(y?.has(T)??!1)||f(T)<this.opts.scoreThresholds.publishThreshold)&&p.delete(T)});let m=this.topics.get(d),E=[],v=new Set;if(l.set(d,v),m!=null){let T=Lt(Array.from(m));for(let b of T){let S=this.streamsOutbound.get(b);if(S!=null&&this.multicodecs.includes(S.protocol)&&!p.has(b)&&!this.direct.has(b)){let I=f(b);I>=this.opts.scoreThresholds.publishThreshold&&E.push(b),I>=this.opts.scoreThresholds.gossipThreshold&&v.add(b)}}}if(p.size<e){let T=e-p.size;E.slice(0,T).forEach(b=>{p.add(b),v?.delete(b)})}}),this.emitGossip(l),await this.sendGraftPrune(u,c,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new xr("gossipsub:heartbeat"))}getRandomGossipPeers(e,r,n=()=>!0){let s=this.topics.get(e);if(s==null)return new Set;let i=[];return s.forEach(o=>{let a=this.streamsOutbound.get(o);a!=null&&this.multicodecs.includes(a.protocol)&&n(o)&&i.push(o)}),i=Lt(i),r>0&&i.length>r&&(i=i.slice(0,r)),new Set(i)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0,n=Date.now();e.connectedPeersBackoffSec.reset();for(let a of this.backoff.values()){r+=a.size;for(let[f,u]of a.entries())this.peers.has(f)&&e.connectedPeersBackoffSec.observe(Math.max(0,u-n)/1e3)}e.cacheSize.set({cache:"backoff"},r);for(let[a,f]of this.topics)e.topicPeersCount.set({topicStr:a},f.size);for(let[a,f]of this.mesh)e.meshPeerCounts.set({topicStr:a},f.size);let s=[],i=new Map;e.behaviourPenalty.reset();for(let a of this.peers.keys()){let f=this.score.score(a);s.push(f),i.set(a,f),e.behaviourPenalty.observe(this.score.peerStats.get(a)?.behaviourPenalty??0)}e.registerScores(s,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,i);let o=Nu(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(o)}};function j1(t={}){return e=>new mi(e,t)}return zl($1);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PGossipsub}));
